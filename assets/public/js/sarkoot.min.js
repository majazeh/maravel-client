(function(){
	function jresp(context, res)
	{
		context.trigger('jresp', [res]);
		if (res.message && !context.is('.d-notification'))
		{
			if (window.toastr)
			{
				var toast = toastr[res.is_ok ? 'success' : 'error'](res.message_text || res.message, undefined, {
					"closeButton": true,
					"newestOnTop": true,
					"positionClass": "toast-bottom-right",
				});
			}
			else if (window.iziToast)
			{
				iziToast[res.is_ok ? 'success' : 'error']({ message: res.message_text || res.message});
			}
		}
		if(res.redirect)
		{
			if(res.direct)
			{
				location.href = res.redirect;
			}
			else
			{
				new Statio({
					url : res.redirect
				});
			}
		}
	}
	window.JResp = jresp;
})();
(function(){
	function lijax(context, onFire)
	{
        var back_value = $(context).val() || $(context).attr('data-value');
        if($(context).is(':checkbox'))
        {
            back_value = $(context).is(':checked') ? 1 : 0;
        }
        var Timeout = null;
        var fire = null;
        if($(context).is('form') && !$(context).attr('data-lijax'))
        {
            fire = ['submit'];
        }
        else
        {
            fire = $(context).attr('data-lijax').split(' ') || ['change'];
        }
        for (var i = 0; i < fire.length; i++) {
            if(/^\d+$/.test(fire[i]))
            {
                var Time = fire[i];
                $(context).on('keyup', function(){
                    if(Timeout) clearTimeout(Timeout);
                    Timeout = setTimeout(send, Time);
                });
            }
            else
            {
                $(context).on(fire[i], send);
            }
        }

        function send()
        {
            var href = url.parse(location.href);
            var name = $(context).attr('name') || $(context).attr('data-name');
            if(href.get && href.get[name])
            {
                delete href.get[name];
            }
            var get = url.buildget(href.get);
            href = href.url.replace(/\?(.*)$/, get ? '?' + get : '');
            var action = $(context).attr('href') || $(context).attr('action') || $(context).attr('data-action') || href;
            var method = $(context).attr('data-method') || $(context).attr('method') || 'GET';
            var state = $(context).attr('data-state');
            var value = undefined;
            if($(context).is('form'))
            {
                var Data = new FormData(context);
                var data = {};
				if ($(context).attr('enctype') == 'multipart/form-data' || $('input:file', context).length)
                {
                    data = Data;
                }
                else
                {
                    Data.forEach(function (value, name) {
                        data[name] = /\[.*\]$/.test(name) ? Data.getAll(name) : Data.get(name);
                    });
                }
                state = false;
                $(context).addClass('lijax-sending');
                $('input, select, textarea, button', context).not(':disabled').addClass('lijax-disable').attr('disabled', 'disabled');
                $(context).on('statio:done', function () {
                    $('.lijax-disable', this).removeClass('lijax-disable').removeAttr('disabled')
                    $(this).removeClass('lijax-sending');
                });
            }
            else
            {
                value = $(context).val() || $(context).attr('data-value') || null;
                if($(context).is(':checkbox'))
                {
                    value = $(context).is(':checked') ? 1 : 0;
                }
                if(back_value == value && $(context).is('input, textarea, select') && !onFire) return;
                back_value = value;
                var data = {};
                data[name] = value;
            }
            if ($(context).attr('data-query'))
            {
                var action_query = url.parse(action);
                var data_query = url.parse('?' + $(context).attr('data-query'));
                action_query.get = $.extend(null, (action_query.get || {}), data_query.get);
                action = url.build(action_query);
            }
            var headers = {};
            if ($(context).attr('data-xhrBase'))
            {
                headers = {
                    'Data-xhr-base': $(context).attr('data-xhrBase')
                };
            }
            new Statio({
                type : state ? 'both' : 'render',
                context: context,
                ajax : {
					contentType: $(context).is('form') && ($(context).attr('enctype') == 'multipart/form-data' || $('input:file', context).length) ? false : 'application/x-www-form-urlencoded; charset=UTF-8',
					processData: ($(context).is('form') && ($(context).attr('enctype') == 'multipart/form-data' || $('input:file', context).length)) ? false : true,
                    cache       : false,
                    method : method,
                    data : data,
                    headers: headers
                },
                url : action
            });
            return false;
        }
        if (onFire)
        {
            send();
        }
    }
    window.Lijax = lijax;
})();
(function(){
	var _globals = {
		title : function (value){
			$('title').html(value);
		}
	}

	var _ajax = {
		type : 'GET',
		cache : false
	}

	var _options = {
		object : null,
		title : null,
		ajax : _ajax,
	/**
	 * Send request and change url with response rendering
	 * @default both
	 * both: change url and render response
	 * url: Only send request and chage url without change rendering
	 * render: Only send request and render repsonse without change url
	 * @type {String}
	 */
	 type : 'both',
	/**
	 * dont send any request
	 * @type {Boolean}
	 */
	 fake : false,
	/**
	 * ajax response contetnt
	 * if {fake:true} or {response : notnull} response render this property
	 * @type {[type]}
	 */
	 response : null,
	/**
	 * replace state
	 * @type {Boolean}
	 */
	 replace : false,
	/**
	 * event context
	 * @type {DOM} {jQuery} {Selector string}
	 */
	 context : document
	}

	function statio(custom){
		if(typeof custom != 'object')
		{
			custom = {};
		}

		custom.ajax = $.extend({}, _ajax, custom.ajax);
		custom.ajax.url = custom.url;
		custom.globals = $.extend({}, _globals, custom.globals);
		var options = $.extend({}, _options, custom);

		var response = {
			body : options.response,
			data : {},
		};

		if(!(options.context instanceof jQuery))
		{
			options.context = $(options.context);
		}

		$(document).trigger('statio:global:init', [options.context]);
		options.context.trigger('statio:init');


		var ajax_data = null;
		var ajax_send_url = null;
		if(!options.fake)
		{
			if(!options.ajax.complete)
			{
				options.ajax.complete = ajx_complete;
			}
			var beforeSend = options.ajax.beforeSend;
			options.ajax.beforeSend = function(jqXHR, settings)
			{
				ajax_data = this;
				ajax_send_url = this.url;
				var urlx = url.parse(ajax_send_url);
				if(urlx.get && urlx.get._)
				{
					delete urlx.get._;
				}
            	var get = url.buildget(urlx.get);
            	ajax_send_url = urlx.url.replace(/\?(.*)$/, get ? '?' + get : '');
				beforeSend ? beforeSend.call(this, jqXHR, settings) : null;
			}
			$.ajax(options.ajax);
		}
		else if(options.type != 'url' && response.body)
		{
			response_parse();
			render();
			$(document).trigger('statio:global:done', [options.context]);
			options.context.trigger('statio:done');
		}
		else
		{
			try {
				options.replace
					? history.replaceState(JSON.parse(JSON.stringify(options)), options.title, ajax_send_url || options.url)
					: history.pushState(JSON.parse(JSON.stringify(options)), options.title, ajax_send_url || options.url);
			}
			catch (e) {
				console.error(e);
			}
			$(document).trigger('statio:global:done', [options.context]);
			options.context.trigger('statio:done');
		}

		function ajx_complete(jqXHR, textStatus)
		{
			if(jqXHR.responseJSON)
			{
				response.data = jqXHR.responseJSON;
				$(document).trigger('statio:global:jsonResponse', [options.context, jqXHR.responseJSON, jqXHR]);
				options.context.trigger('statio:jsonResponse', [jqXHR.responseJSON, jqXHR]);
				new JResp(options.context, response.data);
			}
			else
			{
				response.body = jqXHR.responseText;
				response_parse();
				if(textStatus == 'success')
				{
					if (options.type != 'render') {
						try {
							options.response = response;
							options.replace
								? history.replaceState(JSON.parse(JSON.stringify(options)), options.title, ajax_send_url || options.url)
								: history.pushState(JSON.parse(JSON.stringify(options)), options.title, ajax_send_url || options.url);
						}
						catch (e) {
							try{
								options.replace
									? history.replaceState(options.data, options.title, ajax_send_url || options.url)
									: history.pushState(options.data, options.title, ajax_send_url || options.url);

							}
							catch (e){
								console.error(e);
							}
						}
					}
					$(document).trigger('statio:global:success', [options.context, response.data, response.body, jqXHR]);
					options.context.trigger('statio:success', [response.data, response.body, jqXHR]);
					if(options.type != 'url')
					{
						render();
					}
				}
				else
				{
					$(document).trigger('statio:global:errorResponse', [options.context, response.data, response.body, jqXHR]);
					options.context.trigger('statio:errorResponse', [response.data, response.body, jqXHR]);
				}
			}
			$(document).trigger('statio:global:done', [options.context, response.data, response.body, jqXHR]);
			options.context.trigger('statio:done', [response.data, response.body, jqXHR]);
		}

		function response_parse(){
			if(typeof response.body == 'string')
			{
				try
				{
					var split     = response.body.split("\n");
					response.data = JSON.parse(split[0]);
					response.body = split.length > 1 ? $($.parseHTML(split.splice(1).join(""))) : null;
				}catch(e){
					response.body  = $($.parseHTML(response.body));
				}
			}
			else if(typeof response.body == 'object' && response.body != null)
			{
				if(response.body instanceof HTMLElement)
				{
					response.body  = $(response.body);
				}
				else if(response.body instanceof jQuery)
				{

				}
				else
				{
					response.data = response.body;
					response.body = null;
				}
			}
		}

		function render(){
			for(D in response.data)
			{
				if(options.globals[D])
				{
					options.globals[D](response.data[D]);
				}
			}
			if(response.body)
			{
				var changed = [];
				response.body.each(function(){
					var base = $(this).attr('data-xhr');
					if(base)
					{
						changed.push($("[data-xhr='"+base+"']"));
						$("[data-xhr='"+base+"']").html($(this).html());
					}
				});
				$(document).trigger('statio:global:renderResponse', [$(changed), options.context, response.data, response.body]);
				options.context.trigger('statio:renderResponse', [$(changed), response.data, response.body]);
			}
		}
		return this;
	}
	window.Statio = statio;
	/**
	 * for new chrome bug
	 */
	 new Statio({
	 	url : location.href,
	 	fake : true,
	 	replace : true
	 });

	/**
	 * popstate event
	 */
	 window.onpopstate = function(event){
	 	new Statio({
	 		url : location.href,
	 		replace : true
	 	});
	 };
})();

// Copyright 2013-2014 Kevin Cox

/*******************************************************************************
*                                                                              *
*  This software is provided 'as-is', without any express or implied           *
*  warranty. In no event will the authors be held liable for any damages       *
*  arising from the use of this software.                                      *
*                                                                              *
*  Permission is granted to anyone to use this software for any purpose,       *
*  including commercial applications, and to alter it and redistribute it      *
*  freely, subject to the following restrictions:                              *
*                                                                              *
*  1. The origin of this software must not be misrepresented; you must not     *
*     claim that you wrote the original software. If you use this software in  *
*     a product, an acknowledgment in the product documentation would be       *
*     appreciated but is not required.                                         *
*                                                                              *
*  2. Altered source versions must be plainly marked as such, and must not be  *
*     misrepresented as being the original software.                           *
*                                                                              *
*  3. This notice may not be removed or altered from any source distribution.  *
*                                                                              *
*******************************************************************************/

+function(){
"use strict";

var array = /\[([^\[]*)\]$/;

/// URL Regex.
/**
 * This regex splits the URL into parts.  The capture groups catch the important
 * bits.
 *
 * Each section is optional, so to work on any part find the correct top level
 * `(...)?` and mess around with it.
 */
var regex = /^(?:([a-z]*):)?(?:\/\/)?(?:([^:@]*)(?::([^@]*))?@)?([0-9a-z-._]+)?(?::([0-9]*))?(\/[^?#]*)?(?:\?([^#]*))?(?:#(.*))?$/i;
//               1 - scheme              2 - user    3 = pass    4 - host           5 - port  6 - path        7 - query    8 - hash

var noslash = ["mailto","bitcoin"];

var self = {
	/** Parse a query string.
	 *
	 * This function parses a query string (sometimes called the search
	 * string).  It takes a query string and returns a map of the results.
	 *
	 * Keys are considered to be everything up to the first '=' and values are
	 * everything afterwords.  Since URL-decoding is done after parsing, keys
	 * and values can have any values, however, '=' have to be encoded in keys
	 * while '?' and '&' have to be encoded anywhere (as they delimit the
	 * kv-pairs).
	 *
	 * Keys and values will always be strings, except if there is a key with no
	 * '=' in which case it will be considered a flag and will be set to true.
	 * Later values will override earlier values.
	 *
	 * Array keys are also supported.  By default keys in the form of `name[i]`
	 * will be returned like that as strings.  However, if you set the `array`
	 * flag in the options object they will be parsed into arrays.  Note that
	 * although the object returned is an `Array` object all keys will be
	 * written to it.  This means that if you have a key such as `k[forEach]`
	 * it will overwrite the `forEach` function on that array.  Also note that
	 * string properties always take precedence over array properties,
	 * irrespective of where they are in the query string.
	 *
	 *   url.get("array[1]=test&array[foo]=bar",{array:true}).array[1]  === "test"
	 *   url.get("array[1]=test&array[foo]=bar",{array:true}).array.foo === "bar"
	 *   url.get("array=notanarray&array[0]=1",{array:true}).array      === "notanarray"
	 *
	 * If array parsing is enabled keys in the form of `name[]` will
	 * automatically be given the next available index.  Note that this can be
	 * overwritten with later values in the query string.  For this reason is
	 * is best not to mix the two formats, although it is safe (and often
	 * useful) to add an automatic index argument to the end of a query string.
	 *
	 *   url.get("a[]=0&a[]=1&a[0]=2", {array:true})  -> {a:["2","1"]};
	 *   url.get("a[0]=0&a[1]=1&a[]=2", {array:true}) -> {a:["0","1","2"]};
	 *
	 * @param{string} q The query string (the part after the '?').
	 * @param{{full:boolean,array:boolean}=} opt Options.
	 *
	 * - full: If set `q` will be treated as a full url and `q` will be built.
	 *   by calling #parse to retrieve the query portion.
	 * - array: If set keys in the form of `key[i]` will be treated
	 *   as arrays/maps.
	 *
	 * @return{!Object.<string, string|Array>} The parsed result.
	 */
	"get": function(q, opt){
		q = q || "";
		if ( typeof opt          == "undefined" ) opt = {};
		if ( typeof opt["full"]  == "undefined" ) opt["full"] = false;
		if ( typeof opt["array"] == "undefined" ) opt["array"] = false;

		if ( opt["full"] === true )
		{
			q = self["parse"](q, {"get":false})["query"] || "";
		}

		var o = {};

		var c = q.split("&");
		for (var i = 0; i < c.length; i++)
		{
			if (!c[i].length) continue;

			var d = c[i].indexOf("=");
			var k = c[i], v = true;
			if ( d >= 0 )
			{
				k = c[i].substr(0, d);
				v = c[i].substr(d+1);

				v = decodeURIComponent(v);
			}

			if (opt["array"])
			{
				var inds = [];
				var ind;
				var curo = o;
				var curk = k;
				while (ind = curk.match(array)) // Array!
				{
					curk = curk.substr(0, ind.index);
					inds.unshift(decodeURIComponent(ind[1]));
				}
				curk = decodeURIComponent(curk);
				if (inds.some(function(i)
				{
					if ( typeof curo[curk] == "undefined" ) curo[curk] = [];
					if (!Array.isArray(curo[curk]))
					{
						//console.log("url.get: Array property "+curk+" already exists as string!");
						return true;
					}

					curo = curo[curk];

					if ( i === "" ) i = curo.length;

					curk = i;
				})) continue;
				curo[curk] = v;
				continue;
			}

			k = decodeURIComponent(k);

			//typeof o[k] == "undefined" || console.log("Property "+k+" already exists!");
			o[k] = v;
		}

		return o;
	},

	/** Build a get query from an object.
	 *
	 * This constructs a query string from the kv pairs in `data`.  Calling
	 * #get on the string returned should return an object identical to the one
	 * passed in except all non-boolean scalar types become strings and all
	 * object types become arrays (non-integer keys are still present, see
	 * #get's documentation for more details).
	 *
	 * This always uses array syntax for describing arrays.  If you want to
	 * serialize them differently (like having the value be a JSON array and
	 * have a plain key) you will need to do that before passing it in.
	 *
	 * All keys and values are supported (binary data anyone?) as they are
	 * properly URL-encoded and #get properly decodes.
	 *
	 * @param{Object} data The kv pairs.
	 * @param{string} prefix The properly encoded array key to put the
	 *   properties.  Mainly intended for internal use.
	 * @return{string} A URL-safe string.
	 */
	"buildget": function(data, prefix){
		var itms = [];
		for ( var k in data )
		{
			var ek = encodeURIComponent(k);
			if ( typeof prefix != "undefined" )
				ek = prefix+"["+ek+"]";

			var v = data[k];

			switch (typeof v)
			{
				case 'boolean':
					if(v) itms.push(ek);
					break;
				case 'number':
					v = v.toString();
				case 'string':
					itms.push(ek+"="+encodeURIComponent(v));
					break;
				case 'object':
					itms.push(self["buildget"](v, ek));
					break;
			}
		}
		return itms.join("&");
	},

	/** Parse a URL
	 *
	 * This breaks up a URL into components.  It attempts to be very liberal
	 * and returns the best result in most cases.  This means that you can
	 * often pass in part of a URL and get correct categories back.  Notably,
	 * this works for emails and Jabber IDs, as well as adding a '?' to the
	 * beginning of a string will parse the whole thing as a query string.  If
	 * an item is not found the property will be undefined.  In some cases an
	 * empty string will be returned if the surrounding syntax but the actual
	 * value is empty (example: "://example.com" will give a empty string for
	 * scheme.)  Notably the host name will always be set to something.
	 *
	 * Returned properties.
	 *
	 * - **scheme:** The url scheme. (ex: "mailto" or "https")
	 * - **user:** The username.
	 * - **pass:** The password.
	 * - **host:** The hostname. (ex: "localhost", "123.456.7.8" or "example.com")
	 * - **port:** The port, as a number. (ex: 1337)
	 * - **path:** The path. (ex: "/" or "/about.html")
	 * - **query:** "The query string. (ex: "foo=bar&v=17&format=json")
	 * - **get:** The query string parsed with get.  If `opt.get` is `false` this
	 *   will be absent
	 * - **hash:** The value after the hash. (ex: "myanchor")
	 *   be undefined even if `query` is set.
	 *
	 * @param{string} url The URL to parse.
	 * @param{{get:Object}=} opt Options:
	 *
	 * - get: An options argument to be passed to #get or false to not call #get.
	 *    **DO NOT** set `full`.
	 *
	 * @return{!Object} An object with the parsed values.
	 */
	"parse": function(url, opt) {

		if ( typeof opt == "undefined" ) opt = {};

		var md = url.match(regex) || [];

		var r = {
			"url":    url,

			"scheme": md[1],
			"user":   md[2],
			"pass":   md[3],
			"host":   md[4],
			"port":   md[5] && +md[5],
			"path":   md[6],
			"query":  md[7],
			"hash":   md[8],
		};

		if ( opt.get !== false )
			r["get"] = r["query"] && self["get"](r["query"], opt.get);

		return r;
	},

	/** Build a URL from components.
	 *
	 * This pieces together a url from the properties of the passed in object.
	 * In general passing the result of `parse()` should return the URL.  There
	 * may differences in the get string as the keys and values might be more
	 * encoded then they were originally were.  However, calling `get()` on the
	 * two values should yield the same result.
	 *
	 * Here is how the parameters are used.
	 *
	 *  - url: Used only if no other values are provided.  If that is the case
	 *     `url` will be returned verbatim.
	 *  - scheme: Used if defined.
	 *  - user: Used if defined.
	 *  - pass: Used if defined.
	 *  - host: Used if defined.
	 *  - path: Used if defined.
	 *  - query: Used only if `get` is not provided and non-empty.
	 *  - get: Used if non-empty.  Passed to #buildget and the result is used
	 *    as the query string.
	 *  - hash: Used if defined.
	 *
	 * These are the options that are valid on the options object.
	 *
	 *  - useemptyget: If truthy, a question mark will be appended for empty get
	 *    strings.  This notably makes `build()` and `parse()` fully symmetric.
	 *
	 * @param{Object} data The pieces of the URL.
	 * @param{Object} opt Options for building the url.
	 * @return{string} The URL.
	 */
	"build": function(data, opt){
		opt = opt || {};

		var r = "";

		if ( typeof data["scheme"] != "undefined" )
		{
			r += data["scheme"];
			r += (noslash.indexOf(data["scheme"])>=0)?":":"://";
		}
		if ( typeof data["user"] != "undefined" )
		{
			r += data["user"];
			if ( typeof data["pass"] == "undefined" )
			{
				r += "@";
			}
		}
		if ( typeof data["pass"] != "undefined" ) r += ":" + data["pass"] + "@";
		if ( typeof data["host"] != "undefined" ) r += data["host"];
		if ( typeof data["port"] != "undefined" ) r += ":" + data["port"];
		if ( typeof data["path"] != "undefined" ) r += data["path"];

		if (opt["useemptyget"])
		{
			if      ( typeof data["get"]   != "undefined" ) r += "?" + self["buildget"](data["get"]);
			else if ( typeof data["query"] != "undefined" ) r += "?" + data["query"];
		}
		else
		{
			// If .get use it.  If .get leads to empty, use .query.
			var q = data["get"] && self["buildget"](data["get"]) || data["query"];
			if (q) r += "?" + q;
		}

		if ( typeof data["hash"] != "undefined" ) r += "#" + data["hash"];

		return r || data["url"] || "";
	},
};

if ( typeof define != "undefined" && define["amd"] ) define(self);
else if ( typeof module != "undefined" ) module['exports'] = self;
else window["url"] = self;

}();
const aside = document.querySelector('#aside');
const asideBtn = document.querySelector('#aside-btn');
function handleAside(event) {
    aside.classList.add('open');
}
if (asideBtn)
{
    asideBtn.addEventListener('click', handleAside);
}

const profile = document.querySelector('.profile');

if (profile)
{
    const dropdown = document.querySelector('.profile-dropdown');

    function handleProfileClick(event) {
        dropdown.classList.add('open');
    }
    profile.addEventListener('click', handleProfileClick);
    window.addEventListener('click', function(event) {
        if (!event.target.closest('.profile-div')) {
            dropdown.classList.remove('open');
        }
        if (!event.target.closest('#aside') && !event.target.closest('#aside-btn')) {
            aside.classList.remove('open');
        }
    });
}

if (window.am4core)
{
    am4core.ready(function () {

        // Themes begin
        am4core.useTheme(am4themes_amcharts);
        // Themes end

        // Create chart instance
        var chart = am4core.create("chartdiv", am4charts.XYChart);

        chart.rtl = true;

        // Add data
        chart.data = [{
            "country": "USA",
            "visits": 2025
        }, {
            "country": "China",
            "visits": 1882
        }, {
            "country": "Japan",
            "visits": 1809
        }, {
            "country": "Germany",
            "visits": 1322
        }, {
            "country": "UK",
            "visits": 1122
        }, {
            "country": "France",
            "visits": 1114
        }, {
            "country": "India",
            "visits": 984
        }, {
            "country": "Spain",
            "visits": 711
        }, {
            "country": "Netherlands",
            "visits": 665
        }, {
            "country": "Russia",
            "visits": 580
        }, {
            "country": "South Korea",
            "visits": 443
        }, {
            "country": "Canada",
            "visits": 441
        }, {
            "country": "Brazil",
            "visits": 395
        }];

        // Create axes

        var categoryAxis = chart.xAxes.push(new am4charts.CategoryAxis());
        categoryAxis.dataFields.category = "country";
        categoryAxis.renderer.grid.template.location = 0;
        categoryAxis.renderer.minGridDistance = 30;

        categoryAxis.renderer.labels.template.adapter.add("dy", function (dy, target) {
            if (target.dataItem && target.dataItem.index & 2 == 2) {
                return dy + 25;
            }
            return dy;
        });

        var valueAxis = chart.yAxes.push(new am4charts.ValueAxis());

        // Create series
        var series = chart.series.push(new am4charts.ColumnSeries());
        series.dataFields.valueY = "visits";
        series.dataFields.categoryX = "country";
        series.name = "Visits";
        series.columns.template.tooltipText = "{categoryX}: [bold]{valueY}[/]";
        series.columns.template.fillOpacity = .8;

        var columnTemplate = series.columns.template;
        columnTemplate.strokeWidth = 2;
        columnTemplate.strokeOpacity = 1;

    });
}

$(document).ready(function() {
    if ($.fn.select2)
    {
        $('.select2').select2();
    }
});

function readURL(input) {
    if (input.files && input.files[0]) {
        var reader = new FileReader();

        reader.onload = function(e) {
            $(input).next('label').children('img').attr('src', e.target.result);
        }

        reader.readAsDataURL(input.files[0]);
    }
  }

$('.input-avatar').change(function() {
    readURL(this);
});

var datepicker = function (elementID, opt) {

    // check arguments
    if (typeof elementID !== "string" || elementID.length === 0) {
        console.error("datepicker error: input ID is not string or is empty");
        return;
    }
    var options = opt || {};

    // variables
    var isCalClicked = false;
    var isSynced = false;

    var dayOfWeek;

    var selectedYear;
    var selectedMonth;
    var selectedDay;

    var currentYear;
    var currentMonth;
    var currentDay;

    var todaysYear;
    var todaysMonth;
    var todaysDay;

    var dayOfWeekJ;

    var numberOfDays;

    var todayG;
    var todaysJ;

    // consts
    var MONTH_NAMES = {
        "1": "فروردین"
        , "2": "اردیبهشت"
        , "3": "خرداد"
        , "4": "تیر"
        , "5": "مرداد"
        , "6": "شهریور"
        , "7": "مهر"
        , "8": "آبان"
        , "9": "آذر"
        , "10": "دی"
        , "11": "بهمن"
        , "12": "اسفند"
    }
    var DAY_NAMES = {
        "شنبه": "ش"
        , "یکشنبه": "ی"
        , "دوشنبه": "د"
        , "سه شنبه": "س"
        , "چهارشنبه": "چ"
        , "پنج شنبه": "پ"
        , "جمعه": "ج"
    };
    var FA_NUMS = ['٠', '١', '٢', '٣', '۴', '۵', '۶', '٧', '٨', '٩', '١٠', '١١', '١٢', '١٣', '١۴', '١۵', '١۶', '١٧', '١٨', '١٩', '٢٠', '٢١', '٢٢', '٢٣', '٢۴', '٢۵', '٢۶', '٢٧', '٢٨', '٢٩', '٣٠', '٣١', '٣٢'];

    // set options
    options.placeholder = options.placeholder !== undefined ? options.placeholder : "";
    options.twodigit = options.twodigit !== undefined ? options.twodigit : true;
    options.closeAfterSelect = options.closeAfterSelect !== undefined ? options.closeAfterSelect : true;
    options.nextButtonIcon = options.nextButtonIcon !== undefined ? options.nextButtonIcon : false;
    options.previousButtonIcon = options.previousButtonIcon !== undefined ? options.previousButtonIcon : false;
    options.buttonsColor = options.buttonsColor !== undefined ? options.buttonsColor : false;
    options.forceFarsiDigits = options.forceFarsiDigits !== undefined ? options.forceFarsiDigits : false;
    options.markToday = options.markToday !== undefined ? options.markToday : false;
    options.markHolidays = options.markHolidays !== undefined ? options.markHolidays : false;
    options.highlightSelectedDay = options.highlightSelectedDay !== undefined ? options.highlightSelectedDay : false;
    options.sync = options.sync !== undefined ? options.sync : false;
    options.gotoToday = options.gotoToday !== undefined ? options.gotoToday : false;

    // create DOM
    var inputElement = $("#" + elementID);

    if (inputElement.attr("placeholder") === undefined) {
        inputElement.attr("placeholder", options.placeholder);
    }

    // create parent div
    inputElement.wrap("<div id='bd-root-" + elementID + "' style='position: relative;'></div>");

    // create main div for calendar, below input element
    inputElement.after("<div id='bd-main-" + elementID + "' class='bd-main bd-hide' style='position: absolute; direction: rtl;'></div>");
    var mainDiv = $("#bd-main-" + elementID);

    // create calendar div inside main div
    mainDiv.append("<div class='bd-calendar'></div>");
    var calendarDiv = mainDiv.find('.bd-calendar');

    // create title div and table inside calendar div
    calendarDiv.append("<div class='bd-title'></div>");
    var titleDiv = calendarDiv.find('.bd-title');
    calendarDiv.append("<table class='bd-table' dir='rtl' cellspacing='0' cellpadding='0'></table>");

    // create month and year drop downs and next/prev month buttons inside title div
    titleDiv.append("<button id='bd-next-" + elementID + "' class='bd-next' type='button' title='ماه بعدی' data-toggle='tooltip'><span>بعدی</span></button>");
    var nextMonth = $("#bd-next-" + elementID);
    if (options.nextButtonIcon) {
        nextMonth.find("span").css("display", "none");
        if (options.nextButtonIcon.indexOf(".") !== -1) {
            // image
            nextMonth.css("background-image", "url(" + options.nextButtonIcon + ")");
        } else {
            // css class
            nextMonth.addClass(options.nextButtonIcon);
        }
    }

    titleDiv.append("<div class='bd-dropdown'></div><div class='bd-dropdown'></div>");

    titleDiv.find('.bd-dropdown:nth-child(2)').append("<select id='bd-month-" + elementID + "' class='bd-month'></select>");
    var monthDropdown = $("#bd-month-" + elementID);
    $.each(MONTH_NAMES, function (key, value) {
        monthDropdown.append($("<option></option>").attr("value", key).text(value));
    });

    titleDiv.find('.bd-dropdown:nth-child(3)').append("<select id='bd-year-" + elementID + "' class='bd-year'></select>");
    var yearDropdown = $("#bd-year-" + elementID);

    titleDiv.append("<button id='bd-prev-" + elementID + "' class='bd-prev' type='button' title='ماه قبلی' data-toggle='tooltip'><span>قبلی</span></button>");
    var prevMonth = $("#bd-prev-" + elementID);
    if (options.nextButtonIcon) {
        prevMonth.find("span").css("display", "none");
        if (options.previousButtonIcon.indexOf(".") !== -1) {
            // image
            prevMonth.css("background-image", "url(" + options.previousButtonIcon + ")");
        } else {
            // css class
            prevMonth.addClass(options.previousButtonIcon);
        }
    }

    if (options.buttonsColor) {
        nextMonth.css("color", options.buttonsColor);
        nextMonth.find("span").css("color", options.buttonsColor);
        prevMonth.css("color", options.buttonsColor);
        prevMonth.find("span").css("color", options.buttonsColor);
    }

    // create table header and body
    calendarDiv.find('.bd-table').append("<thead><tr></tr></thead>");
    $.each(DAY_NAMES, function (key, value) {
        calendarDiv.find('.bd-table thead tr').append($("<th></th>").text(value));
    });

    calendarDiv.find('.bd-table').append("<tbody id='bd-table-days-" + elementID + "' class='bd-table-days'></tbody>");
    var daysTable = $("#bd-table-days-" + elementID);

    // create go to todays button
    if (options.gotoToday) {
        calendarDiv.append("<div class='bd-goto-today'>برو به امروز</div>");
        var gotoToday = calendarDiv.find(".bd-goto-today");
    }

    // opening and closing functionality
    inputElement.on("focus", function () {
        mainDiv.removeClass("bd-hide");
        if (options.sync && isSynced === false) {
            syncCalendar();
            isSynced = true;
        }
        mainDiv;
    }).on('blur', function () {
        if (isCalClicked == false) {
            mainDiv.addClass("bd-hide");
            isSynced = false;
        } else {
            isCalClicked = false;
            inputElement.focus();
            event.preventDefault();
        }
    });

    mainDiv.on('mousedown', function (event) {
        isCalClicked = true;
    });

    // dropdown events
    monthDropdown.on('change', function () {
        selectedMonth = parseInt(this.value);
        numberOfDays = monthDays(selectedYear, selectedMonth);
        dayOfWeekJ = findFirstDayOfMonth(selectedYear, selectedMonth);
        drawDays(numberOfDays, dayOfWeekJ);
    });
    yearDropdown.on('change', function () {
        selectedYear = parseInt(this.value);
        numberOfDays = monthDays(selectedYear, selectedMonth);
        dayOfWeekJ = findFirstDayOfMonth(selectedYear, selectedMonth);
        drawDays(numberOfDays, dayOfWeekJ);
    });

    // Georgian to Jalali converter (minified)
    // source is unknown. contact if you know the code owner.
    function gregorianToJalali(a, r, s) { a = parseInt(a), r = parseInt(r), s = parseInt(s); for (var n = a - 1600, e = r - 1, t = s - 1, p = 365 * n + parseInt((n + 3) / 4) - parseInt((n + 99) / 100) + parseInt((n + 399) / 400), I = 0; e > I; ++I) p += g_days[I]; e > 1 && (n % 4 == 0 && n % 100 != 0 || n % 400 == 0) && ++p, p += t; var v = p - 79, d = parseInt(v / 12053); v %= 12053; var o = 979 + 33 * d + 4 * parseInt(v / 1461); v %= 1461, v >= 366 && (o += parseInt((v - 1) / 365), v = (v - 1) % 365); for (var I = 0; 11 > I && v >= j_days[I]; ++I) v -= j_days[I]; var y = I + 1, _ = v + 1; return [o, y, _] } var g_days = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31], j_days = [31, 31, 31, 31, 31, 31, 30, 30, 30, 30, 30, 29];
    // Jalali to Georgian converter (minified)
    // source is unknown. contact if you know the code owner.
    function toJalaali(d, i, a) { return d2j(g2d(d, i, a)) } function toGregorian(d, i, a) { return d2g(j2d(d, i, a)) } function isValidJalaaliDate(d, i, a) { return d >= -61 && 3177 >= d && i >= 1 && 12 >= i && a >= 1 && a <= jalaaliMonthLength(d, i) } function isLeapJalaaliYear(d) { return 0 === jalCal(d).leap } function jalaaliMonthLength(d, i) { return 6 >= i ? 31 : 11 >= i ? 30 : isLeapJalaaliYear(d) ? 30 : 29 } function jalCal(d) { var i, a, n, r, t, o, v, e = [-61, 9, 38, 199, 426, 686, 756, 818, 1111, 1181, 1210, 1635, 2060, 2097, 2192, 2262, 2324, 2394, 2456, 3178], l = e.length, u = d + 621, m = -14, g = e[0]; if (g > d || d >= e[l - 1]) throw new Error("Invalid Jalaali year " + d); for (v = 1; l > v && (i = e[v], a = i - g, !(i > d)); v += 1) m = m + 8 * div(a, 33) + div(mod(a, 33), 4), g = i; return o = d - g, m = m + 8 * div(o, 33) + div(mod(o, 33) + 3, 4), 4 === mod(a, 33) && a - o === 4 && (m += 1), r = div(u, 4) - div(3 * (div(u, 100) + 1), 4) - 150, t = 20 + m - r, 6 > a - o && (o = o - a + 33 * div(a + 4, 33)), n = mod(mod(o + 1, 33) - 1, 4), -1 === n && (n = 4), { leap: n, gy: u, march: t } } function j2d(d, i, a) { var n = jalCal(d); return g2d(n.gy, 3, n.march) + 31 * (i - 1) - div(i, 7) * (i - 7) + a - 1 } function d2j(d) { var i, a, n, r = d2g(d).gy, t = r - 621, o = jalCal(t), v = g2d(r, 3, o.march); if (n = d - v, n >= 0) { if (185 >= n) return a = 1 + div(n, 31), i = mod(n, 31) + 1, { jy: t, jm: a, jd: i }; n -= 186 } else t -= 1, n += 179, 1 === o.leap && (n += 1); return a = 7 + div(n, 30), i = mod(n, 30) + 1, { jy: t, jm: a, jd: i } } function g2d(d, i, a) { var n = div(1461 * (d + div(i - 8, 6) + 100100), 4) + div(153 * mod(i + 9, 12) + 2, 5) + a - 34840408; return n = n - div(3 * div(d + 100100 + div(i - 8, 6), 100), 4) + 752 } function d2g(d) { var i, a, n, r, t; return i = 4 * d + 139361631, i = i + 4 * div(3 * div(4 * d + 183187720, 146097), 4) - 3908, a = 5 * div(mod(i, 1461), 4) + 308, n = div(mod(a, 153), 5) + 1, r = mod(div(a, 153), 12) + 1, t = div(i, 1461) - 100100 + div(8 - r, 6), { gy: t, gm: r, gd: n } } function div(d, i) { return ~~(d / i) } function mod(d, i) { return d - ~~(d / i) * i }

    var syncCalendar = function () {
        var inputValue = fixDate(inputElement.val());
        if (inputValue === "")
            return;

        inputValue = inputValue.split("/");
        monthDropdown.val(parseInt(inputValue[1]));
        monthDropdown.trigger("change");
        yearDropdown.val(parseInt(inputValue[0]));
        yearDropdown.trigger("change");

        if (options.highlightSelectedDay) {
            mainDiv.find(".bd-selected-day").removeClass("bd-selected-day");
            mainDiv.find(".day-" + parseInt(inputValue[2])).addClass("bd-selected-day");
        }
    }

    var fixDate = function (date) {
        if (date === "")
            return "";

        date = date.split("/");
        // if (date[0].length === 2) {
        //     date[0] = "13" + date[0];
        // }
        if (date[1].length < 2) {
            if (date[1] < 10) {
                date[1] = "0" + date[1];
            }
        }
        if (date[2].length < 2) {
            if (date[2] < 10) {
                date[2] = "0" + date[2];
            }
        }
        date = date.join("/");
        return date;
    }

    var convertToJWeek = function (dayOfWeekG) {
        var dayOfWeekJ;
        if (dayOfWeekG < 6) {
            dayOfWeekJ = dayOfWeekG + 1;
        } else {
            dayOfWeekJ = 0;
        }
        return dayOfWeekJ;
    }

    var makeYearList = function (thisYear) {
        yearDropdown.find('option').remove();
        for (i = 0; i < 101; i++) {
            var tempYear = ((thisYear - 95) + i) + '';
            if (options.forceFarsiDigits) {
                for (var j = 0; j < 10; j++) {
                    var rgx = new RegExp(j, 'g');
                    tempYear = tempYear.replace(rgx, FA_NUMS[j]);
                }
            }
            yearDropdown.append($('<option>', {
                value: (thisYear - 95) + i,
                text: tempYear
            }));
        }
    }

    // isleap calculator, supported year: 1243 - 1473
    var isLeapYear = function (year) {
        var mod;
        if (year < 1343 && year > 1243) {
            mod = year % 33;
            if (mod == 1 || mod == 5 || mod == 9 || mod == 13 || mod == 17 || mod == 22 || mod == 26 || mod == 30) {
                return true;
            } else {
                return false;
            }
        } else if (year < 1473 && year > 1342) {
            mod = year % 17;
            if (mod == 1 || mod == 5 || mod == 9 || mod == 13 || mod == 18 || mod == 22 || mod == 26 || mod == 30) {
                return true;
            } else {
                return false
            }
        } else {
            return "unknown";
        }
    }

    var monthDays = function (year, month) {
        if (month < 7) {
            return 31;
        } else if (month < 12) {
            return 30;
        } else {
            if (isLeapYear(year)) {
                return 30;
            } else {
                return 29;
            }
        }
    }

    // make first page of calendar
    todayG = new Date();

    todaysJ = gregorianToJalali(todayG.getFullYear(), todayG.getMonth() + 1, todayG.getDate());
    var selectedDateJ = [];
    for (i = 0; i < 3; i++) {
        selectedDateJ[i] = todaysJ[i];
    }

    todaysYear = todaysJ[0];
    todaysMonth = todaysJ[1];
    todaysDay = todaysJ[2];

    selectedYear = selectedDateJ[0];
    selectedMonth = selectedDateJ[1];
    selectedDay = selectedDateJ[2];

    monthDropdown.val(selectedMonth);
    makeYearList(selectedYear);
    yearDropdown.val(selectedYear);

    numberOfDays = monthDays(selectedYear, selectedMonth);

    // find first day of month in week
    var findFirstDayOfMonth = function (selectedYear, selectedMonth) {
        var firstDayOfMonthG = toGregorian(selectedYear, selectedMonth, 1);
        firstDayOfMonthG = new Date(firstDayOfMonthG.gy + "/" + firstDayOfMonthG.gm + "/" + firstDayOfMonthG.gd);
        return convertToJWeek(firstDayOfMonthG.getDay());
    }
    dayOfWeekJ = findFirstDayOfMonth(selectedYear, selectedMonth);

    // draw days on calendar
    var drawDays = function (numberOfDays, dayOfWeekJ) {
        daysTable.empty();
        var dayIndex = 1;
        var rowIndex = 1;
        while (dayIndex <= numberOfDays) {
            daysTable.append($('<tr>', {
                class: "tr-" + rowIndex
            }));
            for (i = 0; i < 7; i++) {
                if (dayIndex == 1) {
                    var j = 0;
                    while (j < dayOfWeekJ) {
                        $("#bd-table-days-" + elementID + " .tr-1").append($('<td>', {
                            class: "bd-empty-cell"
                        })
                        );
                        j++;
                        i++;
                    }
                }
                if (i < 7 && dayIndex <= numberOfDays) {
                    var tempTD = '<td>' +
                        '<button class="day day-' + dayIndex + '" type="button">' + (options.forceFarsiDigits ? FA_NUMS[dayIndex] : dayIndex) + '</button>' +
                        '</td>';

                    // mark todays day by adding .bd-today class
                    if (options.markToday) {
                        if (dayIndex == todaysDay && todaysMonth == selectedMonth && todaysYear == selectedYear) {
                            var idx = tempTD.indexOf('day day-');
                            tempTD = tempTD.slice(0, idx) + ' bd-today ' + tempTD.slice(idx);
                        }
                    }

                    // mark holidays by adding .bd-holiday class
                    if (options.markHolidays) {
                        if (i == 6) {
                            var idx = tempTD.indexOf('day day-');
                            tempTD = tempTD.slice(0, idx) + ' bd-holiday ' + tempTD.slice(idx);
                        }
                    }

                    $("#bd-table-days-" + elementID + " .tr-" + rowIndex).append(tempTD);

                    dayIndex++;
                }
            }
            rowIndex++;
        }

        if (options.highlightSelectedDay) {
            var inputValue = inputElement.val();
            inputValue = inputValue.split("/");
            if (inputValue[0] == selectedYear && inputValue[1] == selectedMonth) {
                mainDiv.find(".bd-selected-day").removeClass("bd-selected-day");
                mainDiv.find(".day-" + parseInt(inputValue[2])).addClass("bd-selected-day");
            }
        }

    }

    inputElement.parent().on("click", "button.day", function () {
        var datestr = selectedYear + "/" + selectedMonth + "/" + $(this).attr('class').split(" ")[$(this).attr('class').split(" ").indexOf('day') + 1].split("-")[1];
        if (options.twodigit) {
            datestr = fixDate(datestr);
        }
        inputElement.val(datestr);
        inputElement.trigger("change");
        if (options.closeAfterSelect) {
            isCalClicked = false;
            inputElement.trigger("blur");
        }

        if (options.highlightSelectedDay) {
            mainDiv.find(".bd-selected-day").removeClass("bd-selected-day");
            $(this).addClass("bd-selected-day");
        }
    });

    nextMonth.on("click", function () {
        //console.log("month: " + selectedMonth + ", year: " + selectedYear);
        if (monthDropdown.val() < 12) {
            monthDropdown.val(parseInt(monthDropdown.val()) + 1);
            monthDropdown.trigger("change");
        } else {
            monthDropdown.val(1);
            monthDropdown.trigger("change");
            yearDropdown.val(parseInt(yearDropdown.val()) + 1);
            yearDropdown.trigger("change");
        }
    });

    prevMonth.on("click", function () {
        if (monthDropdown.val() > 1) {
            monthDropdown.val(parseInt(monthDropdown.val()) - 1);
            monthDropdown.trigger("change");
        } else {
            monthDropdown.val(12);
            monthDropdown.trigger("change");
            yearDropdown.val(parseInt(yearDropdown.val()) - 1);
            yearDropdown.trigger("change");
        }
    });

    if (options.gotoToday) {
        gotoToday.on("click", function () {
            monthDropdown.val(todaysMonth);
            monthDropdown.trigger("change");
            yearDropdown.val(todaysYear);
            yearDropdown.trigger("change");
        });
    }

    drawDays(numberOfDays, dayOfWeekJ);

    // enable bootstrap tooltip if bootstrap is loaded
    if (typeof $().modal == 'function') {
        $('[data-toggle="tooltip"]').tooltip();
    }

}

var media_xm = window.matchMedia("(max-width: 575.98px)");
var media_sm = window.matchMedia("(min-width: 576px) and (max-width: 767.98px)");
var media_md = window.matchMedia("(min-width: 768px) and (max-width: 991.98px)");
var media_lg = window.matchMedia("(min-width: 992px) and (max-width: 1199.98px)");
var media_xl = window.matchMedia("(min-width: 1200px)");


function event_media_xm(media){
	if(media.matches) return $(document).trigger('media:xm', [media]);
	else return $(document).trigger('media:xm:exit', [media]);
}
function event_media_sm(media){
	if(media.matches) return $(document).trigger('media:sm', [media]);
	else return $(document).trigger('media:sm:exit', [media]);
}
function event_media_md(media){
	if(media.matches) return $(document).trigger('media:md', [media]);
	else return $(document).trigger('media:md:exit', [media]);
}
function event_media_lg(media){
	if(media.matches) return $(document).trigger('media:lg', [media]);
	else return $(document).trigger('media:lg:exit', [media]);
}
function event_media_xl(media){
	if(media.matches) return $(document).trigger('media:xl', [media]);
	else return $(document).trigger('media:xl:exit', [media]);
}

$(document).ready(function(){
	event_media_xm(media_xm);
	media_xm.addListener(event_media_xm);

	event_media_sm(media_sm);
	media_sm.addListener(event_media_sm);

	event_media_md(media_md);
	media_md.addListener(event_media_md);

	event_media_lg(media_lg);
	media_lg.addListener(event_media_lg);

	event_media_xl(media_xl);
	media_xl.addListener(event_media_xl);
})

$(document).ready(function () {
	$.ajaxSetup(
		{
			headers:
			{
				'X-CSRF-Token': $('meta[name="csrf-token"]').attr('content')
			}
		}
	);
	$(document).trigger('statio:global:renderResponse', [$(document)]);
});
$(document).on('statio:global:renderResponse', function (event, base, context) {
	base.each(function () {
		$('[data-Lijax], .lijax', this).each(function () {
			new Lijax(this);
		});
		$("a", this).not('.direct, [data-direct], [target=_blank], .lijax, [data-lijax]').on('click', function () {
			new Statio({
				url: $(this).attr('href'),
				type: $(this).is('.action') ? 'render' : 'both',
				context: $(this),
			});
			return false;
		});

		$('form[action]', this).not('.direct, [data-direct], [target=_blank], .lijax').each(function () {
			new Lijax(this);
		}).on('jresp', function (e, d) {
			$('.is-invalid', this).removeClass('is-invalid');
			$('.invalid-feedback', this).remove();
			if (d.errors) {
				for (var id in d.errors) {
					$('#' + id + ', [data-alias~=' + id + ']').addClass('is-invalid');
					$('<div class="invalid-feedback">' + d.errors[id][0] + '</div>').insertAfter($('#' + id + ', [data-alias~=' + id + ']'));
				}
			}
		});
		$(".select2-select", this).each(function () {
			var options = {
				width: '100%',
				amdLanguageBase: 'dist/vendors/select2-4.0.13/dist/js/i18n',
				language: 'fa',
				minimumInputLength: 0,
				allowClear: $(this).is('[data-allowClear]') || $(this).is('.has-clear'),
				dir: "rtl",
				tags: $(this).is('.tag-type'),
				dropdownParent: $('#' + $(this).attr('data-dropdownParent')).length ? $('#' + $(this).attr('data-dropdownParent')) : undefined
			};
			$(this).attr('data-mr-value', $('[name=' + $(this).attr('data-multi-round') + ']').val());
			$('[name=' + $(this).attr('data-multi-round') + ']').remove();
			if (options.allowClear) {
				options.placeholder = {};
				options.placeholder.text = $('option', this).first().text();
				options.placeholder.id = $('option', this).first().attr('value');
			}
			if ($(this).is('[data-url]')) {
				var title = $(this).attr('data-title') || 'title';
				var _self = this;
				options.ajax = {
					delay: 250,
					url: $(this).attr('data-url'),
					dataType: 'json',
					quietMillis: 250,
					data: function (params) {
						return {
							q: params.term || ''
						};
					},
					processResults: function (data) {
						data = data.data || data;
						var id_property = $(_self).attr('data-id') || 'id';
						var title_property = $(_self).attr('data-title') || 'title';
						var result = { results: [] };
						if ($(_self).is('[data-allowClear]')) {
							result.results.push({
								id: '',
								text: '-',
								all: null
							});
						}
						for (var i = 0; i < data.length; i++) {
							var sub_title_property = title_property;
							if (sub_title_property.indexOf(' ') >= 0) {
								var sub_title_properties = sub_title_property.split(' ');
								for (var is = 0; is < sub_title_properties.length; is++) {
									if (data[i][sub_title_properties[is]]) {
										sub_title_property = sub_title_properties[is];
										break;
									}

								}
							}
							result.results.push({
								id: data[i][id_property],
								text: data[i][sub_title_property],
								all: data[i]
							});
						}
						return result;
					},
					cache: false
				};
			}
			$(this).select2(options);
		});
	});
});
function responsive_menu() {
    $('#menu').removeClass('d-none').addClass('d-flex');
    // $('#desktop').removeClass('d-none');
    $('body').addClass('responsive-menu');
    $('#btn-menu').find($(".fas")).removeClass('fa-bars').addClass('fa-arrow-right');
    $(this).off('click.responsive-menu');
    $(this).on('click.close-responsive-menu', function() {
        $(this).off('click.close-responsive-menu');
        $(this).on('click.responsive-menu', responsive_menu);
        $('#menu').addClass('d-none').removeClass('d-flex');
        // $('#desktop').addClass('d-none');
        $('body').removeClass('responsive-menu');
        $('#btn-menu').find($(".fas")).removeClass('fa-arrow-right').addClass('fa-bars');
    });
}

$(document).on('media:xm media:sm', function(event, media) {
    $("body:not(.responsive-menu) #btn-menu").on('click.responsive-menu', responsive_menu);

    var menu = $('#menu');
    var desktop = $('#desktop');
    var btn_menu = $('#btn-menu');
    $(document).mouseup(function(e) {
        if (
            (!menu.is(e.target) && menu.has(e.target).length === 0)
            && (!desktop.is(e.target) && desktop.has(e.target).length === 0)
            && (!btn_menu.is(e.target) && btn_menu.has(e.target).length === 0)
            )
        {
            $("body.responsive-menu #btn-menu").trigger('click.close-responsive-menu');
        }
    });

    // $("body").swipe({
    //     swipe: function(event, direction, distance, duration, fingerCount, fingerData) {
    //         if (direction == 'left') {
    //             $("body:not(.responsive-menu) #btn-menu").trigger('click.responsive-menu');
    //         }

    //         if (direction == 'right') {
    //             $("body.responsive-menu #btn-menu").trigger('click.close-responsive-menu');
    //         }

    //         if (direction == 'up' || direction == 'down') {
    //             if (!menu.is(event.target) && menu.has(event.target).length === 0) {
    //                 $("body.responsive-menu #btn-menu").trigger('click.close-responsive-menu');
    //             }
    //         }
    //     }
    // });
});

$(document).on('media:md media:lg media:xl', function(event, media) {
    $("body.responsive-menu #btn-menu").trigger('click.close-responsive-menu');
    $("#btn-menu").off('click.responsive-menu');
    // $("#btn-menu").off('click.close-responsive-menu');
    // $('#menu').addClass('d-none').removeClass('d-flex');
    // $('#desktop').addClass('d-none');
    // $('body').removeClass('responsive-menu');
    // $('#btn-menu').find($(".fas")).removeClass('fa-arrow-right').addClass('fa-bars');
});
(function () {
	function ViwFile()
	{
		$('.custom-file-input', this).on('change', function(){
			if (!window.File && !window.FileReader && !window.FileList && !window.Blob) {
				console.error('FileReader unsupported!');
				return false;
			}
			var file_index = 0;
			var file;
			$(this).next().html('');
			var files = [];
			while (file = this.files.item(file_index++))
			{
				files.push(file.name);
			}
			$(this).next().html(files.join(' : '));
		});
	}
	$(document).on('statio:global:renderResponse', function (event, base, contex) {
		base.each(function () {
			ViwFile.call(this);
		});
	});
	ViwFile.call(document);
})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkpSZXNwLmpzIiwiTGlqYXguanMiLCJTdGF0aW8uanMiLCJVcmwuanMiLCJhcHAuanMiLCJkYXRlcGlja2VyLmpzIiwibWVkaWEtZXZlbnQuanMiLCJyZWdpc3Rlci5qcyIsInNpZGViYXItcmVzcG9uc2l2ZS5qcyIsInZpd2ZpbGUuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2xDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNwSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNuUEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN0VkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDeklBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDeGNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzVDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDMUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDNURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoic2Fya29vdC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtcblx0ZnVuY3Rpb24ganJlc3AoY29udGV4dCwgcmVzKVxuXHR7XG5cdFx0Y29udGV4dC50cmlnZ2VyKCdqcmVzcCcsIFtyZXNdKTtcblx0XHRpZiAocmVzLm1lc3NhZ2UgJiYgIWNvbnRleHQuaXMoJy5kLW5vdGlmaWNhdGlvbicpKVxuXHRcdHtcblx0XHRcdGlmICh3aW5kb3cudG9hc3RyKVxuXHRcdFx0e1xuXHRcdFx0XHR2YXIgdG9hc3QgPSB0b2FzdHJbcmVzLmlzX29rID8gJ3N1Y2Nlc3MnIDogJ2Vycm9yJ10ocmVzLm1lc3NhZ2VfdGV4dCB8fCByZXMubWVzc2FnZSwgdW5kZWZpbmVkLCB7XG5cdFx0XHRcdFx0XCJjbG9zZUJ1dHRvblwiOiB0cnVlLFxuXHRcdFx0XHRcdFwibmV3ZXN0T25Ub3BcIjogdHJ1ZSxcblx0XHRcdFx0XHRcInBvc2l0aW9uQ2xhc3NcIjogXCJ0b2FzdC1ib3R0b20tcmlnaHRcIixcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0XHRlbHNlIGlmICh3aW5kb3cuaXppVG9hc3QpXG5cdFx0XHR7XG5cdFx0XHRcdGl6aVRvYXN0W3Jlcy5pc19vayA/ICdzdWNjZXNzJyA6ICdlcnJvciddKHsgbWVzc2FnZTogcmVzLm1lc3NhZ2VfdGV4dCB8fCByZXMubWVzc2FnZX0pO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRpZihyZXMucmVkaXJlY3QpXG5cdFx0e1xuXHRcdFx0aWYocmVzLmRpcmVjdClcblx0XHRcdHtcblx0XHRcdFx0bG9jYXRpb24uaHJlZiA9IHJlcy5yZWRpcmVjdDtcblx0XHRcdH1cblx0XHRcdGVsc2Vcblx0XHRcdHtcblx0XHRcdFx0bmV3IFN0YXRpbyh7XG5cdFx0XHRcdFx0dXJsIDogcmVzLnJlZGlyZWN0XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHR3aW5kb3cuSlJlc3AgPSBqcmVzcDtcbn0pKCk7IiwiKGZ1bmN0aW9uKCl7XG5cdGZ1bmN0aW9uIGxpamF4KGNvbnRleHQsIG9uRmlyZSlcblx0e1xuICAgICAgICB2YXIgYmFja192YWx1ZSA9ICQoY29udGV4dCkudmFsKCkgfHwgJChjb250ZXh0KS5hdHRyKCdkYXRhLXZhbHVlJyk7XG4gICAgICAgIGlmKCQoY29udGV4dCkuaXMoJzpjaGVja2JveCcpKVxuICAgICAgICB7XG4gICAgICAgICAgICBiYWNrX3ZhbHVlID0gJChjb250ZXh0KS5pcygnOmNoZWNrZWQnKSA/IDEgOiAwO1xuICAgICAgICB9XG4gICAgICAgIHZhciBUaW1lb3V0ID0gbnVsbDtcbiAgICAgICAgdmFyIGZpcmUgPSBudWxsO1xuICAgICAgICBpZigkKGNvbnRleHQpLmlzKCdmb3JtJykgJiYgISQoY29udGV4dCkuYXR0cignZGF0YS1saWpheCcpKVxuICAgICAgICB7XG4gICAgICAgICAgICBmaXJlID0gWydzdWJtaXQnXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIGZpcmUgPSAkKGNvbnRleHQpLmF0dHIoJ2RhdGEtbGlqYXgnKS5zcGxpdCgnICcpIHx8IFsnY2hhbmdlJ107XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmaXJlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZigvXlxcZCskLy50ZXN0KGZpcmVbaV0pKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHZhciBUaW1lID0gZmlyZVtpXTtcbiAgICAgICAgICAgICAgICAkKGNvbnRleHQpLm9uKCdrZXl1cCcsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgIGlmKFRpbWVvdXQpIGNsZWFyVGltZW91dChUaW1lb3V0KTtcbiAgICAgICAgICAgICAgICAgICAgVGltZW91dCA9IHNldFRpbWVvdXQoc2VuZCwgVGltZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgJChjb250ZXh0KS5vbihmaXJlW2ldLCBzZW5kKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNlbmQoKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgaHJlZiA9IHVybC5wYXJzZShsb2NhdGlvbi5ocmVmKTtcbiAgICAgICAgICAgIHZhciBuYW1lID0gJChjb250ZXh0KS5hdHRyKCduYW1lJykgfHwgJChjb250ZXh0KS5hdHRyKCdkYXRhLW5hbWUnKTtcbiAgICAgICAgICAgIGlmKGhyZWYuZ2V0ICYmIGhyZWYuZ2V0W25hbWVdKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBocmVmLmdldFtuYW1lXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXQgPSB1cmwuYnVpbGRnZXQoaHJlZi5nZXQpO1xuICAgICAgICAgICAgaHJlZiA9IGhyZWYudXJsLnJlcGxhY2UoL1xcPyguKikkLywgZ2V0ID8gJz8nICsgZ2V0IDogJycpO1xuICAgICAgICAgICAgdmFyIGFjdGlvbiA9ICQoY29udGV4dCkuYXR0cignaHJlZicpIHx8ICQoY29udGV4dCkuYXR0cignYWN0aW9uJykgfHwgJChjb250ZXh0KS5hdHRyKCdkYXRhLWFjdGlvbicpIHx8IGhyZWY7XG4gICAgICAgICAgICB2YXIgbWV0aG9kID0gJChjb250ZXh0KS5hdHRyKCdkYXRhLW1ldGhvZCcpIHx8ICQoY29udGV4dCkuYXR0cignbWV0aG9kJykgfHwgJ0dFVCc7XG4gICAgICAgICAgICB2YXIgc3RhdGUgPSAkKGNvbnRleHQpLmF0dHIoJ2RhdGEtc3RhdGUnKTtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIGlmKCQoY29udGV4dCkuaXMoJ2Zvcm0nKSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB2YXIgRGF0YSA9IG5ldyBGb3JtRGF0YShjb250ZXh0KTtcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHt9O1xuXHRcdFx0XHRpZiAoJChjb250ZXh0KS5hdHRyKCdlbmN0eXBlJykgPT0gJ211bHRpcGFydC9mb3JtLWRhdGEnIHx8ICQoJ2lucHV0OmZpbGUnLCBjb250ZXh0KS5sZW5ndGgpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBkYXRhID0gRGF0YTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgRGF0YS5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSwgbmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVtuYW1lXSA9IC9cXFsuKlxcXSQvLnRlc3QobmFtZSkgPyBEYXRhLmdldEFsbChuYW1lKSA6IERhdGEuZ2V0KG5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3RhdGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAkKGNvbnRleHQpLmFkZENsYXNzKCdsaWpheC1zZW5kaW5nJyk7XG4gICAgICAgICAgICAgICAgJCgnaW5wdXQsIHNlbGVjdCwgdGV4dGFyZWEsIGJ1dHRvbicsIGNvbnRleHQpLm5vdCgnOmRpc2FibGVkJykuYWRkQ2xhc3MoJ2xpamF4LWRpc2FibGUnKS5hdHRyKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpO1xuICAgICAgICAgICAgICAgICQoY29udGV4dCkub24oJ3N0YXRpbzpkb25lJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAkKCcubGlqYXgtZGlzYWJsZScsIHRoaXMpLnJlbW92ZUNsYXNzKCdsaWpheC1kaXNhYmxlJykucmVtb3ZlQXR0cignZGlzYWJsZWQnKVxuICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCdsaWpheC1zZW5kaW5nJyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSAkKGNvbnRleHQpLnZhbCgpIHx8ICQoY29udGV4dCkuYXR0cignZGF0YS12YWx1ZScpIHx8IG51bGw7XG4gICAgICAgICAgICAgICAgaWYoJChjb250ZXh0KS5pcygnOmNoZWNrYm94JykpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9ICQoY29udGV4dCkuaXMoJzpjaGVja2VkJykgPyAxIDogMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYoYmFja192YWx1ZSA9PSB2YWx1ZSAmJiAkKGNvbnRleHQpLmlzKCdpbnB1dCwgdGV4dGFyZWEsIHNlbGVjdCcpICYmICFvbkZpcmUpIHJldHVybjtcbiAgICAgICAgICAgICAgICBiYWNrX3ZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSB7fTtcbiAgICAgICAgICAgICAgICBkYXRhW25hbWVdID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoJChjb250ZXh0KS5hdHRyKCdkYXRhLXF1ZXJ5JykpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbl9xdWVyeSA9IHVybC5wYXJzZShhY3Rpb24pO1xuICAgICAgICAgICAgICAgIHZhciBkYXRhX3F1ZXJ5ID0gdXJsLnBhcnNlKCc/JyArICQoY29udGV4dCkuYXR0cignZGF0YS1xdWVyeScpKTtcbiAgICAgICAgICAgICAgICBhY3Rpb25fcXVlcnkuZ2V0ID0gJC5leHRlbmQobnVsbCwgKGFjdGlvbl9xdWVyeS5nZXQgfHwge30pLCBkYXRhX3F1ZXJ5LmdldCk7XG4gICAgICAgICAgICAgICAgYWN0aW9uID0gdXJsLmJ1aWxkKGFjdGlvbl9xdWVyeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgaGVhZGVycyA9IHt9O1xuICAgICAgICAgICAgaWYgKCQoY29udGV4dCkuYXR0cignZGF0YS14aHJCYXNlJykpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaGVhZGVycyA9IHtcbiAgICAgICAgICAgICAgICAgICAgJ0RhdGEteGhyLWJhc2UnOiAkKGNvbnRleHQpLmF0dHIoJ2RhdGEteGhyQmFzZScpXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5ldyBTdGF0aW8oe1xuICAgICAgICAgICAgICAgIHR5cGUgOiBzdGF0ZSA/ICdib3RoJyA6ICdyZW5kZXInLFxuICAgICAgICAgICAgICAgIGNvbnRleHQ6IGNvbnRleHQsXG4gICAgICAgICAgICAgICAgYWpheCA6IHtcblx0XHRcdFx0XHRjb250ZW50VHlwZTogJChjb250ZXh0KS5pcygnZm9ybScpICYmICgkKGNvbnRleHQpLmF0dHIoJ2VuY3R5cGUnKSA9PSAnbXVsdGlwYXJ0L2Zvcm0tZGF0YScgfHwgJCgnaW5wdXQ6ZmlsZScsIGNvbnRleHQpLmxlbmd0aCkgPyBmYWxzZSA6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9VVRGLTgnLFxuXHRcdFx0XHRcdHByb2Nlc3NEYXRhOiAoJChjb250ZXh0KS5pcygnZm9ybScpICYmICgkKGNvbnRleHQpLmF0dHIoJ2VuY3R5cGUnKSA9PSAnbXVsdGlwYXJ0L2Zvcm0tZGF0YScgfHwgJCgnaW5wdXQ6ZmlsZScsIGNvbnRleHQpLmxlbmd0aCkpID8gZmFsc2UgOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBjYWNoZSAgICAgICA6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBtZXRob2QgOiBtZXRob2QsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEgOiBkYXRhLFxuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiBoZWFkZXJzXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB1cmwgOiBhY3Rpb25cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvbkZpcmUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHNlbmQoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB3aW5kb3cuTGlqYXggPSBsaWpheDtcbn0pKCk7IiwiKGZ1bmN0aW9uKCl7XG5cdHZhciBfZ2xvYmFscyA9IHtcblx0XHR0aXRsZSA6IGZ1bmN0aW9uICh2YWx1ZSl7XG5cdFx0XHQkKCd0aXRsZScpLmh0bWwodmFsdWUpO1xuXHRcdH1cblx0fVxuXG5cdHZhciBfYWpheCA9IHtcblx0XHR0eXBlIDogJ0dFVCcsXG5cdFx0Y2FjaGUgOiBmYWxzZVxuXHR9XG5cblx0dmFyIF9vcHRpb25zID0ge1xuXHRcdG9iamVjdCA6IG51bGwsXG5cdFx0dGl0bGUgOiBudWxsLFxuXHRcdGFqYXggOiBfYWpheCxcblx0LyoqXG5cdCAqIFNlbmQgcmVxdWVzdCBhbmQgY2hhbmdlIHVybCB3aXRoIHJlc3BvbnNlIHJlbmRlcmluZ1xuXHQgKiBAZGVmYXVsdCBib3RoXG5cdCAqIGJvdGg6IGNoYW5nZSB1cmwgYW5kIHJlbmRlciByZXNwb25zZVxuXHQgKiB1cmw6IE9ubHkgc2VuZCByZXF1ZXN0IGFuZCBjaGFnZSB1cmwgd2l0aG91dCBjaGFuZ2UgcmVuZGVyaW5nXG5cdCAqIHJlbmRlcjogT25seSBzZW5kIHJlcXVlc3QgYW5kIHJlbmRlciByZXBzb25zZSB3aXRob3V0IGNoYW5nZSB1cmxcblx0ICogQHR5cGUge1N0cmluZ31cblx0ICovXG5cdCB0eXBlIDogJ2JvdGgnLFxuXHQvKipcblx0ICogZG9udCBzZW5kIGFueSByZXF1ZXN0XG5cdCAqIEB0eXBlIHtCb29sZWFufVxuXHQgKi9cblx0IGZha2UgOiBmYWxzZSxcblx0LyoqXG5cdCAqIGFqYXggcmVzcG9uc2UgY29udGV0bnRcblx0ICogaWYge2Zha2U6dHJ1ZX0gb3Ige3Jlc3BvbnNlIDogbm90bnVsbH0gcmVzcG9uc2UgcmVuZGVyIHRoaXMgcHJvcGVydHlcblx0ICogQHR5cGUge1t0eXBlXX1cblx0ICovXG5cdCByZXNwb25zZSA6IG51bGwsXG5cdC8qKlxuXHQgKiByZXBsYWNlIHN0YXRlXG5cdCAqIEB0eXBlIHtCb29sZWFufVxuXHQgKi9cblx0IHJlcGxhY2UgOiBmYWxzZSxcblx0LyoqXG5cdCAqIGV2ZW50IGNvbnRleHRcblx0ICogQHR5cGUge0RPTX0ge2pRdWVyeX0ge1NlbGVjdG9yIHN0cmluZ31cblx0ICovXG5cdCBjb250ZXh0IDogZG9jdW1lbnRcblx0fVxuXG5cdGZ1bmN0aW9uIHN0YXRpbyhjdXN0b20pe1xuXHRcdGlmKHR5cGVvZiBjdXN0b20gIT0gJ29iamVjdCcpXG5cdFx0e1xuXHRcdFx0Y3VzdG9tID0ge307XG5cdFx0fVxuXG5cdFx0Y3VzdG9tLmFqYXggPSAkLmV4dGVuZCh7fSwgX2FqYXgsIGN1c3RvbS5hamF4KTtcblx0XHRjdXN0b20uYWpheC51cmwgPSBjdXN0b20udXJsO1xuXHRcdGN1c3RvbS5nbG9iYWxzID0gJC5leHRlbmQoe30sIF9nbG9iYWxzLCBjdXN0b20uZ2xvYmFscyk7XG5cdFx0dmFyIG9wdGlvbnMgPSAkLmV4dGVuZCh7fSwgX29wdGlvbnMsIGN1c3RvbSk7XG5cblx0XHR2YXIgcmVzcG9uc2UgPSB7XG5cdFx0XHRib2R5IDogb3B0aW9ucy5yZXNwb25zZSxcblx0XHRcdGRhdGEgOiB7fSxcblx0XHR9O1xuXG5cdFx0aWYoIShvcHRpb25zLmNvbnRleHQgaW5zdGFuY2VvZiBqUXVlcnkpKVxuXHRcdHtcblx0XHRcdG9wdGlvbnMuY29udGV4dCA9ICQob3B0aW9ucy5jb250ZXh0KTtcblx0XHR9XG5cblx0XHQkKGRvY3VtZW50KS50cmlnZ2VyKCdzdGF0aW86Z2xvYmFsOmluaXQnLCBbb3B0aW9ucy5jb250ZXh0XSk7XG5cdFx0b3B0aW9ucy5jb250ZXh0LnRyaWdnZXIoJ3N0YXRpbzppbml0Jyk7XG5cblxuXHRcdHZhciBhamF4X2RhdGEgPSBudWxsO1xuXHRcdHZhciBhamF4X3NlbmRfdXJsID0gbnVsbDtcblx0XHRpZighb3B0aW9ucy5mYWtlKVxuXHRcdHtcblx0XHRcdGlmKCFvcHRpb25zLmFqYXguY29tcGxldGUpXG5cdFx0XHR7XG5cdFx0XHRcdG9wdGlvbnMuYWpheC5jb21wbGV0ZSA9IGFqeF9jb21wbGV0ZTtcblx0XHRcdH1cblx0XHRcdHZhciBiZWZvcmVTZW5kID0gb3B0aW9ucy5hamF4LmJlZm9yZVNlbmQ7XG5cdFx0XHRvcHRpb25zLmFqYXguYmVmb3JlU2VuZCA9IGZ1bmN0aW9uKGpxWEhSLCBzZXR0aW5ncylcblx0XHRcdHtcblx0XHRcdFx0YWpheF9kYXRhID0gdGhpcztcblx0XHRcdFx0YWpheF9zZW5kX3VybCA9IHRoaXMudXJsO1xuXHRcdFx0XHR2YXIgdXJseCA9IHVybC5wYXJzZShhamF4X3NlbmRfdXJsKTtcblx0XHRcdFx0aWYodXJseC5nZXQgJiYgdXJseC5nZXQuXylcblx0XHRcdFx0e1xuXHRcdFx0XHRcdGRlbGV0ZSB1cmx4LmdldC5fO1xuXHRcdFx0XHR9XG4gICAgICAgICAgICBcdHZhciBnZXQgPSB1cmwuYnVpbGRnZXQodXJseC5nZXQpO1xuICAgICAgICAgICAgXHRhamF4X3NlbmRfdXJsID0gdXJseC51cmwucmVwbGFjZSgvXFw/KC4qKSQvLCBnZXQgPyAnPycgKyBnZXQgOiAnJyk7XG5cdFx0XHRcdGJlZm9yZVNlbmQgPyBiZWZvcmVTZW5kLmNhbGwodGhpcywganFYSFIsIHNldHRpbmdzKSA6IG51bGw7XG5cdFx0XHR9XG5cdFx0XHQkLmFqYXgob3B0aW9ucy5hamF4KTtcblx0XHR9XG5cdFx0ZWxzZSBpZihvcHRpb25zLnR5cGUgIT0gJ3VybCcgJiYgcmVzcG9uc2UuYm9keSlcblx0XHR7XG5cdFx0XHRyZXNwb25zZV9wYXJzZSgpO1xuXHRcdFx0cmVuZGVyKCk7XG5cdFx0XHQkKGRvY3VtZW50KS50cmlnZ2VyKCdzdGF0aW86Z2xvYmFsOmRvbmUnLCBbb3B0aW9ucy5jb250ZXh0XSk7XG5cdFx0XHRvcHRpb25zLmNvbnRleHQudHJpZ2dlcignc3RhdGlvOmRvbmUnKTtcblx0XHR9XG5cdFx0ZWxzZVxuXHRcdHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdG9wdGlvbnMucmVwbGFjZVxuXHRcdFx0XHRcdD8gaGlzdG9yeS5yZXBsYWNlU3RhdGUoSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShvcHRpb25zKSksIG9wdGlvbnMudGl0bGUsIGFqYXhfc2VuZF91cmwgfHwgb3B0aW9ucy51cmwpXG5cdFx0XHRcdFx0OiBoaXN0b3J5LnB1c2hTdGF0ZShKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG9wdGlvbnMpKSwgb3B0aW9ucy50aXRsZSwgYWpheF9zZW5kX3VybCB8fCBvcHRpb25zLnVybCk7XG5cdFx0XHR9XG5cdFx0XHRjYXRjaCAoZSkge1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKGUpO1xuXHRcdFx0fVxuXHRcdFx0JChkb2N1bWVudCkudHJpZ2dlcignc3RhdGlvOmdsb2JhbDpkb25lJywgW29wdGlvbnMuY29udGV4dF0pO1xuXHRcdFx0b3B0aW9ucy5jb250ZXh0LnRyaWdnZXIoJ3N0YXRpbzpkb25lJyk7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gYWp4X2NvbXBsZXRlKGpxWEhSLCB0ZXh0U3RhdHVzKVxuXHRcdHtcblx0XHRcdGlmKGpxWEhSLnJlc3BvbnNlSlNPTilcblx0XHRcdHtcblx0XHRcdFx0cmVzcG9uc2UuZGF0YSA9IGpxWEhSLnJlc3BvbnNlSlNPTjtcblx0XHRcdFx0JChkb2N1bWVudCkudHJpZ2dlcignc3RhdGlvOmdsb2JhbDpqc29uUmVzcG9uc2UnLCBbb3B0aW9ucy5jb250ZXh0LCBqcVhIUi5yZXNwb25zZUpTT04sIGpxWEhSXSk7XG5cdFx0XHRcdG9wdGlvbnMuY29udGV4dC50cmlnZ2VyKCdzdGF0aW86anNvblJlc3BvbnNlJywgW2pxWEhSLnJlc3BvbnNlSlNPTiwganFYSFJdKTtcblx0XHRcdFx0bmV3IEpSZXNwKG9wdGlvbnMuY29udGV4dCwgcmVzcG9uc2UuZGF0YSk7XG5cdFx0XHR9XG5cdFx0XHRlbHNlXG5cdFx0XHR7XG5cdFx0XHRcdHJlc3BvbnNlLmJvZHkgPSBqcVhIUi5yZXNwb25zZVRleHQ7XG5cdFx0XHRcdHJlc3BvbnNlX3BhcnNlKCk7XG5cdFx0XHRcdGlmKHRleHRTdGF0dXMgPT0gJ3N1Y2Nlc3MnKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0aWYgKG9wdGlvbnMudHlwZSAhPSAncmVuZGVyJykge1xuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0b3B0aW9ucy5yZXNwb25zZSA9IHJlc3BvbnNlO1xuXHRcdFx0XHRcdFx0XHRvcHRpb25zLnJlcGxhY2Vcblx0XHRcdFx0XHRcdFx0XHQ/IGhpc3RvcnkucmVwbGFjZVN0YXRlKEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkob3B0aW9ucykpLCBvcHRpb25zLnRpdGxlLCBhamF4X3NlbmRfdXJsIHx8IG9wdGlvbnMudXJsKVxuXHRcdFx0XHRcdFx0XHRcdDogaGlzdG9yeS5wdXNoU3RhdGUoSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShvcHRpb25zKSksIG9wdGlvbnMudGl0bGUsIGFqYXhfc2VuZF91cmwgfHwgb3B0aW9ucy51cmwpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0Y2F0Y2ggKGUpIHtcblx0XHRcdFx0XHRcdFx0dHJ5e1xuXHRcdFx0XHRcdFx0XHRcdG9wdGlvbnMucmVwbGFjZVxuXHRcdFx0XHRcdFx0XHRcdFx0PyBoaXN0b3J5LnJlcGxhY2VTdGF0ZShvcHRpb25zLmRhdGEsIG9wdGlvbnMudGl0bGUsIGFqYXhfc2VuZF91cmwgfHwgb3B0aW9ucy51cmwpXG5cdFx0XHRcdFx0XHRcdFx0XHQ6IGhpc3RvcnkucHVzaFN0YXRlKG9wdGlvbnMuZGF0YSwgb3B0aW9ucy50aXRsZSwgYWpheF9zZW5kX3VybCB8fCBvcHRpb25zLnVybCk7XG5cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRjYXRjaCAoZSl7XG5cdFx0XHRcdFx0XHRcdFx0Y29uc29sZS5lcnJvcihlKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHQkKGRvY3VtZW50KS50cmlnZ2VyKCdzdGF0aW86Z2xvYmFsOnN1Y2Nlc3MnLCBbb3B0aW9ucy5jb250ZXh0LCByZXNwb25zZS5kYXRhLCByZXNwb25zZS5ib2R5LCBqcVhIUl0pO1xuXHRcdFx0XHRcdG9wdGlvbnMuY29udGV4dC50cmlnZ2VyKCdzdGF0aW86c3VjY2VzcycsIFtyZXNwb25zZS5kYXRhLCByZXNwb25zZS5ib2R5LCBqcVhIUl0pO1xuXHRcdFx0XHRcdGlmKG9wdGlvbnMudHlwZSAhPSAndXJsJylcblx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRyZW5kZXIoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxzZVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0JChkb2N1bWVudCkudHJpZ2dlcignc3RhdGlvOmdsb2JhbDplcnJvclJlc3BvbnNlJywgW29wdGlvbnMuY29udGV4dCwgcmVzcG9uc2UuZGF0YSwgcmVzcG9uc2UuYm9keSwganFYSFJdKTtcblx0XHRcdFx0XHRvcHRpb25zLmNvbnRleHQudHJpZ2dlcignc3RhdGlvOmVycm9yUmVzcG9uc2UnLCBbcmVzcG9uc2UuZGF0YSwgcmVzcG9uc2UuYm9keSwganFYSFJdKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0JChkb2N1bWVudCkudHJpZ2dlcignc3RhdGlvOmdsb2JhbDpkb25lJywgW29wdGlvbnMuY29udGV4dCwgcmVzcG9uc2UuZGF0YSwgcmVzcG9uc2UuYm9keSwganFYSFJdKTtcblx0XHRcdG9wdGlvbnMuY29udGV4dC50cmlnZ2VyKCdzdGF0aW86ZG9uZScsIFtyZXNwb25zZS5kYXRhLCByZXNwb25zZS5ib2R5LCBqcVhIUl0pO1xuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIHJlc3BvbnNlX3BhcnNlKCl7XG5cdFx0XHRpZih0eXBlb2YgcmVzcG9uc2UuYm9keSA9PSAnc3RyaW5nJylcblx0XHRcdHtcblx0XHRcdFx0dHJ5XG5cdFx0XHRcdHtcblx0XHRcdFx0XHR2YXIgc3BsaXQgICAgID0gcmVzcG9uc2UuYm9keS5zcGxpdChcIlxcblwiKTtcblx0XHRcdFx0XHRyZXNwb25zZS5kYXRhID0gSlNPTi5wYXJzZShzcGxpdFswXSk7XG5cdFx0XHRcdFx0cmVzcG9uc2UuYm9keSA9IHNwbGl0Lmxlbmd0aCA+IDEgPyAkKCQucGFyc2VIVE1MKHNwbGl0LnNwbGljZSgxKS5qb2luKFwiXCIpKSkgOiBudWxsO1xuXHRcdFx0XHR9Y2F0Y2goZSl7XG5cdFx0XHRcdFx0cmVzcG9uc2UuYm9keSAgPSAkKCQucGFyc2VIVE1MKHJlc3BvbnNlLmJvZHkpKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0ZWxzZSBpZih0eXBlb2YgcmVzcG9uc2UuYm9keSA9PSAnb2JqZWN0JyAmJiByZXNwb25zZS5ib2R5ICE9IG51bGwpXG5cdFx0XHR7XG5cdFx0XHRcdGlmKHJlc3BvbnNlLmJvZHkgaW5zdGFuY2VvZiBIVE1MRWxlbWVudClcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHJlc3BvbnNlLmJvZHkgID0gJChyZXNwb25zZS5ib2R5KTtcblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlIGlmKHJlc3BvbnNlLmJvZHkgaW5zdGFuY2VvZiBqUXVlcnkpXG5cdFx0XHRcdHtcblxuXHRcdFx0XHR9XG5cdFx0XHRcdGVsc2Vcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHJlc3BvbnNlLmRhdGEgPSByZXNwb25zZS5ib2R5O1xuXHRcdFx0XHRcdHJlc3BvbnNlLmJvZHkgPSBudWxsO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gcmVuZGVyKCl7XG5cdFx0XHRmb3IoRCBpbiByZXNwb25zZS5kYXRhKVxuXHRcdFx0e1xuXHRcdFx0XHRpZihvcHRpb25zLmdsb2JhbHNbRF0pXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRvcHRpb25zLmdsb2JhbHNbRF0ocmVzcG9uc2UuZGF0YVtEXSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGlmKHJlc3BvbnNlLmJvZHkpXG5cdFx0XHR7XG5cdFx0XHRcdHZhciBjaGFuZ2VkID0gW107XG5cdFx0XHRcdHJlc3BvbnNlLmJvZHkuZWFjaChmdW5jdGlvbigpe1xuXHRcdFx0XHRcdHZhciBiYXNlID0gJCh0aGlzKS5hdHRyKCdkYXRhLXhocicpO1xuXHRcdFx0XHRcdGlmKGJhc2UpXG5cdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0Y2hhbmdlZC5wdXNoKCQoXCJbZGF0YS14aHI9J1wiK2Jhc2UrXCInXVwiKSk7XG5cdFx0XHRcdFx0XHQkKFwiW2RhdGEteGhyPSdcIitiYXNlK1wiJ11cIikuaHRtbCgkKHRoaXMpLmh0bWwoKSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdFx0JChkb2N1bWVudCkudHJpZ2dlcignc3RhdGlvOmdsb2JhbDpyZW5kZXJSZXNwb25zZScsIFskKGNoYW5nZWQpLCBvcHRpb25zLmNvbnRleHQsIHJlc3BvbnNlLmRhdGEsIHJlc3BvbnNlLmJvZHldKTtcblx0XHRcdFx0b3B0aW9ucy5jb250ZXh0LnRyaWdnZXIoJ3N0YXRpbzpyZW5kZXJSZXNwb25zZScsIFskKGNoYW5nZWQpLCByZXNwb25zZS5kYXRhLCByZXNwb25zZS5ib2R5XSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzO1xuXHR9XG5cdHdpbmRvdy5TdGF0aW8gPSBzdGF0aW87XG5cdC8qKlxuXHQgKiBmb3IgbmV3IGNocm9tZSBidWdcblx0ICovXG5cdCBuZXcgU3RhdGlvKHtcblx0IFx0dXJsIDogbG9jYXRpb24uaHJlZixcblx0IFx0ZmFrZSA6IHRydWUsXG5cdCBcdHJlcGxhY2UgOiB0cnVlXG5cdCB9KTtcblxuXHQvKipcblx0ICogcG9wc3RhdGUgZXZlbnRcblx0ICovXG5cdCB3aW5kb3cub25wb3BzdGF0ZSA9IGZ1bmN0aW9uKGV2ZW50KXtcblx0IFx0bmV3IFN0YXRpbyh7XG5cdCBcdFx0dXJsIDogbG9jYXRpb24uaHJlZixcblx0IFx0XHRyZXBsYWNlIDogdHJ1ZVxuXHQgXHR9KTtcblx0IH07XG59KSgpOyIsIlxuLy8gQ29weXJpZ2h0IDIwMTMtMjAxNCBLZXZpbiBDb3hcblxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXG4qICBUaGlzIHNvZnR3YXJlIGlzIHByb3ZpZGVkICdhcy1pcycsIHdpdGhvdXQgYW55IGV4cHJlc3Mgb3IgaW1wbGllZCAgICAgICAgICAgKlxuKiAgd2FycmFudHkuIEluIG5vIGV2ZW50IHdpbGwgdGhlIGF1dGhvcnMgYmUgaGVsZCBsaWFibGUgZm9yIGFueSBkYW1hZ2VzICAgICAgICpcbiogIGFyaXNpbmcgZnJvbSB0aGUgdXNlIG9mIHRoaXMgc29mdHdhcmUuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXG4qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxuKiAgUGVybWlzc2lvbiBpcyBncmFudGVkIHRvIGFueW9uZSB0byB1c2UgdGhpcyBzb2Z0d2FyZSBmb3IgYW55IHB1cnBvc2UsICAgICAgICpcbiogIGluY2x1ZGluZyBjb21tZXJjaWFsIGFwcGxpY2F0aW9ucywgYW5kIHRvIGFsdGVyIGl0IGFuZCByZWRpc3RyaWJ1dGUgaXQgICAgICAqXG4qICBmcmVlbHksIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyByZXN0cmljdGlvbnM6ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxuKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcbiogIDEuIFRoZSBvcmlnaW4gb2YgdGhpcyBzb2Z0d2FyZSBtdXN0IG5vdCBiZSBtaXNyZXByZXNlbnRlZDsgeW91IG11c3Qgbm90ICAgICAqXG4qICAgICBjbGFpbSB0aGF0IHlvdSB3cm90ZSB0aGUgb3JpZ2luYWwgc29mdHdhcmUuIElmIHlvdSB1c2UgdGhpcyBzb2Z0d2FyZSBpbiAgKlxuKiAgICAgYSBwcm9kdWN0LCBhbiBhY2tub3dsZWRnbWVudCBpbiB0aGUgcHJvZHVjdCBkb2N1bWVudGF0aW9uIHdvdWxkIGJlICAgICAgICpcbiogICAgIGFwcHJlY2lhdGVkIGJ1dCBpcyBub3QgcmVxdWlyZWQuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXG4qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxuKiAgMi4gQWx0ZXJlZCBzb3VyY2UgdmVyc2lvbnMgbXVzdCBiZSBwbGFpbmx5IG1hcmtlZCBhcyBzdWNoLCBhbmQgbXVzdCBub3QgYmUgICpcbiogICAgIG1pc3JlcHJlc2VudGVkIGFzIGJlaW5nIHRoZSBvcmlnaW5hbCBzb2Z0d2FyZS4gICAgICAgICAgICAgICAgICAgICAgICAgICAqXG4qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxuKiAgMy4gVGhpcyBub3RpY2UgbWF5IG5vdCBiZSByZW1vdmVkIG9yIGFsdGVyZWQgZnJvbSBhbnkgc291cmNlIGRpc3RyaWJ1dGlvbi4gICpcbiogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4rZnVuY3Rpb24oKXtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgYXJyYXkgPSAvXFxbKFteXFxbXSopXFxdJC87XG5cbi8vLyBVUkwgUmVnZXguXG4vKipcbiAqIFRoaXMgcmVnZXggc3BsaXRzIHRoZSBVUkwgaW50byBwYXJ0cy4gIFRoZSBjYXB0dXJlIGdyb3VwcyBjYXRjaCB0aGUgaW1wb3J0YW50XG4gKiBiaXRzLlxuICpcbiAqIEVhY2ggc2VjdGlvbiBpcyBvcHRpb25hbCwgc28gdG8gd29yayBvbiBhbnkgcGFydCBmaW5kIHRoZSBjb3JyZWN0IHRvcCBsZXZlbFxuICogYCguLi4pP2AgYW5kIG1lc3MgYXJvdW5kIHdpdGggaXQuXG4gKi9cbnZhciByZWdleCA9IC9eKD86KFthLXpdKik6KT8oPzpcXC9cXC8pPyg/OihbXjpAXSopKD86OihbXkBdKikpP0ApPyhbMC05YS16LS5fXSspPyg/OjooWzAtOV0qKSk/KFxcL1tePyNdKik/KD86XFw/KFteI10qKSk/KD86IyguKikpPyQvaTtcbi8vICAgICAgICAgICAgICAgMSAtIHNjaGVtZSAgICAgICAgICAgICAgMiAtIHVzZXIgICAgMyA9IHBhc3MgICAgNCAtIGhvc3QgICAgICAgICAgIDUgLSBwb3J0ICA2IC0gcGF0aCAgICAgICAgNyAtIHF1ZXJ5ICAgIDggLSBoYXNoXG5cbnZhciBub3NsYXNoID0gW1wibWFpbHRvXCIsXCJiaXRjb2luXCJdO1xuXG52YXIgc2VsZiA9IHtcblx0LyoqIFBhcnNlIGEgcXVlcnkgc3RyaW5nLlxuXHQgKlxuXHQgKiBUaGlzIGZ1bmN0aW9uIHBhcnNlcyBhIHF1ZXJ5IHN0cmluZyAoc29tZXRpbWVzIGNhbGxlZCB0aGUgc2VhcmNoXG5cdCAqIHN0cmluZykuICBJdCB0YWtlcyBhIHF1ZXJ5IHN0cmluZyBhbmQgcmV0dXJucyBhIG1hcCBvZiB0aGUgcmVzdWx0cy5cblx0ICpcblx0ICogS2V5cyBhcmUgY29uc2lkZXJlZCB0byBiZSBldmVyeXRoaW5nIHVwIHRvIHRoZSBmaXJzdCAnPScgYW5kIHZhbHVlcyBhcmVcblx0ICogZXZlcnl0aGluZyBhZnRlcndvcmRzLiAgU2luY2UgVVJMLWRlY29kaW5nIGlzIGRvbmUgYWZ0ZXIgcGFyc2luZywga2V5c1xuXHQgKiBhbmQgdmFsdWVzIGNhbiBoYXZlIGFueSB2YWx1ZXMsIGhvd2V2ZXIsICc9JyBoYXZlIHRvIGJlIGVuY29kZWQgaW4ga2V5c1xuXHQgKiB3aGlsZSAnPycgYW5kICcmJyBoYXZlIHRvIGJlIGVuY29kZWQgYW55d2hlcmUgKGFzIHRoZXkgZGVsaW1pdCB0aGVcblx0ICoga3YtcGFpcnMpLlxuXHQgKlxuXHQgKiBLZXlzIGFuZCB2YWx1ZXMgd2lsbCBhbHdheXMgYmUgc3RyaW5ncywgZXhjZXB0IGlmIHRoZXJlIGlzIGEga2V5IHdpdGggbm9cblx0ICogJz0nIGluIHdoaWNoIGNhc2UgaXQgd2lsbCBiZSBjb25zaWRlcmVkIGEgZmxhZyBhbmQgd2lsbCBiZSBzZXQgdG8gdHJ1ZS5cblx0ICogTGF0ZXIgdmFsdWVzIHdpbGwgb3ZlcnJpZGUgZWFybGllciB2YWx1ZXMuXG5cdCAqXG5cdCAqIEFycmF5IGtleXMgYXJlIGFsc28gc3VwcG9ydGVkLiAgQnkgZGVmYXVsdCBrZXlzIGluIHRoZSBmb3JtIG9mIGBuYW1lW2ldYFxuXHQgKiB3aWxsIGJlIHJldHVybmVkIGxpa2UgdGhhdCBhcyBzdHJpbmdzLiAgSG93ZXZlciwgaWYgeW91IHNldCB0aGUgYGFycmF5YFxuXHQgKiBmbGFnIGluIHRoZSBvcHRpb25zIG9iamVjdCB0aGV5IHdpbGwgYmUgcGFyc2VkIGludG8gYXJyYXlzLiAgTm90ZSB0aGF0XG5cdCAqIGFsdGhvdWdoIHRoZSBvYmplY3QgcmV0dXJuZWQgaXMgYW4gYEFycmF5YCBvYmplY3QgYWxsIGtleXMgd2lsbCBiZVxuXHQgKiB3cml0dGVuIHRvIGl0LiAgVGhpcyBtZWFucyB0aGF0IGlmIHlvdSBoYXZlIGEga2V5IHN1Y2ggYXMgYGtbZm9yRWFjaF1gXG5cdCAqIGl0IHdpbGwgb3ZlcndyaXRlIHRoZSBgZm9yRWFjaGAgZnVuY3Rpb24gb24gdGhhdCBhcnJheS4gIEFsc28gbm90ZSB0aGF0XG5cdCAqIHN0cmluZyBwcm9wZXJ0aWVzIGFsd2F5cyB0YWtlIHByZWNlZGVuY2Ugb3ZlciBhcnJheSBwcm9wZXJ0aWVzLFxuXHQgKiBpcnJlc3BlY3RpdmUgb2Ygd2hlcmUgdGhleSBhcmUgaW4gdGhlIHF1ZXJ5IHN0cmluZy5cblx0ICpcblx0ICogICB1cmwuZ2V0KFwiYXJyYXlbMV09dGVzdCZhcnJheVtmb29dPWJhclwiLHthcnJheTp0cnVlfSkuYXJyYXlbMV0gID09PSBcInRlc3RcIlxuXHQgKiAgIHVybC5nZXQoXCJhcnJheVsxXT10ZXN0JmFycmF5W2Zvb109YmFyXCIse2FycmF5OnRydWV9KS5hcnJheS5mb28gPT09IFwiYmFyXCJcblx0ICogICB1cmwuZ2V0KFwiYXJyYXk9bm90YW5hcnJheSZhcnJheVswXT0xXCIse2FycmF5OnRydWV9KS5hcnJheSAgICAgID09PSBcIm5vdGFuYXJyYXlcIlxuXHQgKlxuXHQgKiBJZiBhcnJheSBwYXJzaW5nIGlzIGVuYWJsZWQga2V5cyBpbiB0aGUgZm9ybSBvZiBgbmFtZVtdYCB3aWxsXG5cdCAqIGF1dG9tYXRpY2FsbHkgYmUgZ2l2ZW4gdGhlIG5leHQgYXZhaWxhYmxlIGluZGV4LiAgTm90ZSB0aGF0IHRoaXMgY2FuIGJlXG5cdCAqIG92ZXJ3cml0dGVuIHdpdGggbGF0ZXIgdmFsdWVzIGluIHRoZSBxdWVyeSBzdHJpbmcuICBGb3IgdGhpcyByZWFzb24gaXNcblx0ICogaXMgYmVzdCBub3QgdG8gbWl4IHRoZSB0d28gZm9ybWF0cywgYWx0aG91Z2ggaXQgaXMgc2FmZSAoYW5kIG9mdGVuXG5cdCAqIHVzZWZ1bCkgdG8gYWRkIGFuIGF1dG9tYXRpYyBpbmRleCBhcmd1bWVudCB0byB0aGUgZW5kIG9mIGEgcXVlcnkgc3RyaW5nLlxuXHQgKlxuXHQgKiAgIHVybC5nZXQoXCJhW109MCZhW109MSZhWzBdPTJcIiwge2FycmF5OnRydWV9KSAgLT4ge2E6W1wiMlwiLFwiMVwiXX07XG5cdCAqICAgdXJsLmdldChcImFbMF09MCZhWzFdPTEmYVtdPTJcIiwge2FycmF5OnRydWV9KSAtPiB7YTpbXCIwXCIsXCIxXCIsXCIyXCJdfTtcblx0ICpcblx0ICogQHBhcmFte3N0cmluZ30gcSBUaGUgcXVlcnkgc3RyaW5nICh0aGUgcGFydCBhZnRlciB0aGUgJz8nKS5cblx0ICogQHBhcmFte3tmdWxsOmJvb2xlYW4sYXJyYXk6Ym9vbGVhbn09fSBvcHQgT3B0aW9ucy5cblx0ICpcblx0ICogLSBmdWxsOiBJZiBzZXQgYHFgIHdpbGwgYmUgdHJlYXRlZCBhcyBhIGZ1bGwgdXJsIGFuZCBgcWAgd2lsbCBiZSBidWlsdC5cblx0ICogICBieSBjYWxsaW5nICNwYXJzZSB0byByZXRyaWV2ZSB0aGUgcXVlcnkgcG9ydGlvbi5cblx0ICogLSBhcnJheTogSWYgc2V0IGtleXMgaW4gdGhlIGZvcm0gb2YgYGtleVtpXWAgd2lsbCBiZSB0cmVhdGVkXG5cdCAqICAgYXMgYXJyYXlzL21hcHMuXG5cdCAqXG5cdCAqIEByZXR1cm57IU9iamVjdC48c3RyaW5nLCBzdHJpbmd8QXJyYXk+fSBUaGUgcGFyc2VkIHJlc3VsdC5cblx0ICovXG5cdFwiZ2V0XCI6IGZ1bmN0aW9uKHEsIG9wdCl7XG5cdFx0cSA9IHEgfHwgXCJcIjtcblx0XHRpZiAoIHR5cGVvZiBvcHQgICAgICAgICAgPT0gXCJ1bmRlZmluZWRcIiApIG9wdCA9IHt9O1xuXHRcdGlmICggdHlwZW9mIG9wdFtcImZ1bGxcIl0gID09IFwidW5kZWZpbmVkXCIgKSBvcHRbXCJmdWxsXCJdID0gZmFsc2U7XG5cdFx0aWYgKCB0eXBlb2Ygb3B0W1wiYXJyYXlcIl0gPT0gXCJ1bmRlZmluZWRcIiApIG9wdFtcImFycmF5XCJdID0gZmFsc2U7XG5cblx0XHRpZiAoIG9wdFtcImZ1bGxcIl0gPT09IHRydWUgKVxuXHRcdHtcblx0XHRcdHEgPSBzZWxmW1wicGFyc2VcIl0ocSwge1wiZ2V0XCI6ZmFsc2V9KVtcInF1ZXJ5XCJdIHx8IFwiXCI7XG5cdFx0fVxuXG5cdFx0dmFyIG8gPSB7fTtcblxuXHRcdHZhciBjID0gcS5zcGxpdChcIiZcIik7XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBjLmxlbmd0aDsgaSsrKVxuXHRcdHtcblx0XHRcdGlmICghY1tpXS5sZW5ndGgpIGNvbnRpbnVlO1xuXG5cdFx0XHR2YXIgZCA9IGNbaV0uaW5kZXhPZihcIj1cIik7XG5cdFx0XHR2YXIgayA9IGNbaV0sIHYgPSB0cnVlO1xuXHRcdFx0aWYgKCBkID49IDAgKVxuXHRcdFx0e1xuXHRcdFx0XHRrID0gY1tpXS5zdWJzdHIoMCwgZCk7XG5cdFx0XHRcdHYgPSBjW2ldLnN1YnN0cihkKzEpO1xuXG5cdFx0XHRcdHYgPSBkZWNvZGVVUklDb21wb25lbnQodik7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChvcHRbXCJhcnJheVwiXSlcblx0XHRcdHtcblx0XHRcdFx0dmFyIGluZHMgPSBbXTtcblx0XHRcdFx0dmFyIGluZDtcblx0XHRcdFx0dmFyIGN1cm8gPSBvO1xuXHRcdFx0XHR2YXIgY3VyayA9IGs7XG5cdFx0XHRcdHdoaWxlIChpbmQgPSBjdXJrLm1hdGNoKGFycmF5KSkgLy8gQXJyYXkhXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRjdXJrID0gY3Vyay5zdWJzdHIoMCwgaW5kLmluZGV4KTtcblx0XHRcdFx0XHRpbmRzLnVuc2hpZnQoZGVjb2RlVVJJQ29tcG9uZW50KGluZFsxXSkpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGN1cmsgPSBkZWNvZGVVUklDb21wb25lbnQoY3Vyayk7XG5cdFx0XHRcdGlmIChpbmRzLnNvbWUoZnVuY3Rpb24oaSlcblx0XHRcdFx0e1xuXHRcdFx0XHRcdGlmICggdHlwZW9mIGN1cm9bY3Vya10gPT0gXCJ1bmRlZmluZWRcIiApIGN1cm9bY3Vya10gPSBbXTtcblx0XHRcdFx0XHRpZiAoIUFycmF5LmlzQXJyYXkoY3Vyb1tjdXJrXSkpXG5cdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0Ly9jb25zb2xlLmxvZyhcInVybC5nZXQ6IEFycmF5IHByb3BlcnR5IFwiK2N1cmsrXCIgYWxyZWFkeSBleGlzdHMgYXMgc3RyaW5nIVwiKTtcblx0XHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGN1cm8gPSBjdXJvW2N1cmtdO1xuXG5cdFx0XHRcdFx0aWYgKCBpID09PSBcIlwiICkgaSA9IGN1cm8ubGVuZ3RoO1xuXG5cdFx0XHRcdFx0Y3VyayA9IGk7XG5cdFx0XHRcdH0pKSBjb250aW51ZTtcblx0XHRcdFx0Y3Vyb1tjdXJrXSA9IHY7XG5cdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0fVxuXG5cdFx0XHRrID0gZGVjb2RlVVJJQ29tcG9uZW50KGspO1xuXG5cdFx0XHQvL3R5cGVvZiBvW2tdID09IFwidW5kZWZpbmVkXCIgfHwgY29uc29sZS5sb2coXCJQcm9wZXJ0eSBcIitrK1wiIGFscmVhZHkgZXhpc3RzIVwiKTtcblx0XHRcdG9ba10gPSB2O1xuXHRcdH1cblxuXHRcdHJldHVybiBvO1xuXHR9LFxuXG5cdC8qKiBCdWlsZCBhIGdldCBxdWVyeSBmcm9tIGFuIG9iamVjdC5cblx0ICpcblx0ICogVGhpcyBjb25zdHJ1Y3RzIGEgcXVlcnkgc3RyaW5nIGZyb20gdGhlIGt2IHBhaXJzIGluIGBkYXRhYC4gIENhbGxpbmdcblx0ICogI2dldCBvbiB0aGUgc3RyaW5nIHJldHVybmVkIHNob3VsZCByZXR1cm4gYW4gb2JqZWN0IGlkZW50aWNhbCB0byB0aGUgb25lXG5cdCAqIHBhc3NlZCBpbiBleGNlcHQgYWxsIG5vbi1ib29sZWFuIHNjYWxhciB0eXBlcyBiZWNvbWUgc3RyaW5ncyBhbmQgYWxsXG5cdCAqIG9iamVjdCB0eXBlcyBiZWNvbWUgYXJyYXlzIChub24taW50ZWdlciBrZXlzIGFyZSBzdGlsbCBwcmVzZW50LCBzZWVcblx0ICogI2dldCdzIGRvY3VtZW50YXRpb24gZm9yIG1vcmUgZGV0YWlscykuXG5cdCAqXG5cdCAqIFRoaXMgYWx3YXlzIHVzZXMgYXJyYXkgc3ludGF4IGZvciBkZXNjcmliaW5nIGFycmF5cy4gIElmIHlvdSB3YW50IHRvXG5cdCAqIHNlcmlhbGl6ZSB0aGVtIGRpZmZlcmVudGx5IChsaWtlIGhhdmluZyB0aGUgdmFsdWUgYmUgYSBKU09OIGFycmF5IGFuZFxuXHQgKiBoYXZlIGEgcGxhaW4ga2V5KSB5b3Ugd2lsbCBuZWVkIHRvIGRvIHRoYXQgYmVmb3JlIHBhc3NpbmcgaXQgaW4uXG5cdCAqXG5cdCAqIEFsbCBrZXlzIGFuZCB2YWx1ZXMgYXJlIHN1cHBvcnRlZCAoYmluYXJ5IGRhdGEgYW55b25lPykgYXMgdGhleSBhcmVcblx0ICogcHJvcGVybHkgVVJMLWVuY29kZWQgYW5kICNnZXQgcHJvcGVybHkgZGVjb2Rlcy5cblx0ICpcblx0ICogQHBhcmFte09iamVjdH0gZGF0YSBUaGUga3YgcGFpcnMuXG5cdCAqIEBwYXJhbXtzdHJpbmd9IHByZWZpeCBUaGUgcHJvcGVybHkgZW5jb2RlZCBhcnJheSBrZXkgdG8gcHV0IHRoZVxuXHQgKiAgIHByb3BlcnRpZXMuICBNYWlubHkgaW50ZW5kZWQgZm9yIGludGVybmFsIHVzZS5cblx0ICogQHJldHVybntzdHJpbmd9IEEgVVJMLXNhZmUgc3RyaW5nLlxuXHQgKi9cblx0XCJidWlsZGdldFwiOiBmdW5jdGlvbihkYXRhLCBwcmVmaXgpe1xuXHRcdHZhciBpdG1zID0gW107XG5cdFx0Zm9yICggdmFyIGsgaW4gZGF0YSApXG5cdFx0e1xuXHRcdFx0dmFyIGVrID0gZW5jb2RlVVJJQ29tcG9uZW50KGspO1xuXHRcdFx0aWYgKCB0eXBlb2YgcHJlZml4ICE9IFwidW5kZWZpbmVkXCIgKVxuXHRcdFx0XHRlayA9IHByZWZpeCtcIltcIitlaytcIl1cIjtcblxuXHRcdFx0dmFyIHYgPSBkYXRhW2tdO1xuXG5cdFx0XHRzd2l0Y2ggKHR5cGVvZiB2KVxuXHRcdFx0e1xuXHRcdFx0XHRjYXNlICdib29sZWFuJzpcblx0XHRcdFx0XHRpZih2KSBpdG1zLnB1c2goZWspO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdudW1iZXInOlxuXHRcdFx0XHRcdHYgPSB2LnRvU3RyaW5nKCk7XG5cdFx0XHRcdGNhc2UgJ3N0cmluZyc6XG5cdFx0XHRcdFx0aXRtcy5wdXNoKGVrK1wiPVwiK2VuY29kZVVSSUNvbXBvbmVudCh2KSk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ29iamVjdCc6XG5cdFx0XHRcdFx0aXRtcy5wdXNoKHNlbGZbXCJidWlsZGdldFwiXSh2LCBlaykpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gaXRtcy5qb2luKFwiJlwiKTtcblx0fSxcblxuXHQvKiogUGFyc2UgYSBVUkxcblx0ICpcblx0ICogVGhpcyBicmVha3MgdXAgYSBVUkwgaW50byBjb21wb25lbnRzLiAgSXQgYXR0ZW1wdHMgdG8gYmUgdmVyeSBsaWJlcmFsXG5cdCAqIGFuZCByZXR1cm5zIHRoZSBiZXN0IHJlc3VsdCBpbiBtb3N0IGNhc2VzLiAgVGhpcyBtZWFucyB0aGF0IHlvdSBjYW5cblx0ICogb2Z0ZW4gcGFzcyBpbiBwYXJ0IG9mIGEgVVJMIGFuZCBnZXQgY29ycmVjdCBjYXRlZ29yaWVzIGJhY2suICBOb3RhYmx5LFxuXHQgKiB0aGlzIHdvcmtzIGZvciBlbWFpbHMgYW5kIEphYmJlciBJRHMsIGFzIHdlbGwgYXMgYWRkaW5nIGEgJz8nIHRvIHRoZVxuXHQgKiBiZWdpbm5pbmcgb2YgYSBzdHJpbmcgd2lsbCBwYXJzZSB0aGUgd2hvbGUgdGhpbmcgYXMgYSBxdWVyeSBzdHJpbmcuICBJZlxuXHQgKiBhbiBpdGVtIGlzIG5vdCBmb3VuZCB0aGUgcHJvcGVydHkgd2lsbCBiZSB1bmRlZmluZWQuICBJbiBzb21lIGNhc2VzIGFuXG5cdCAqIGVtcHR5IHN0cmluZyB3aWxsIGJlIHJldHVybmVkIGlmIHRoZSBzdXJyb3VuZGluZyBzeW50YXggYnV0IHRoZSBhY3R1YWxcblx0ICogdmFsdWUgaXMgZW1wdHkgKGV4YW1wbGU6IFwiOi8vZXhhbXBsZS5jb21cIiB3aWxsIGdpdmUgYSBlbXB0eSBzdHJpbmcgZm9yXG5cdCAqIHNjaGVtZS4pICBOb3RhYmx5IHRoZSBob3N0IG5hbWUgd2lsbCBhbHdheXMgYmUgc2V0IHRvIHNvbWV0aGluZy5cblx0ICpcblx0ICogUmV0dXJuZWQgcHJvcGVydGllcy5cblx0ICpcblx0ICogLSAqKnNjaGVtZToqKiBUaGUgdXJsIHNjaGVtZS4gKGV4OiBcIm1haWx0b1wiIG9yIFwiaHR0cHNcIilcblx0ICogLSAqKnVzZXI6KiogVGhlIHVzZXJuYW1lLlxuXHQgKiAtICoqcGFzczoqKiBUaGUgcGFzc3dvcmQuXG5cdCAqIC0gKipob3N0OioqIFRoZSBob3N0bmFtZS4gKGV4OiBcImxvY2FsaG9zdFwiLCBcIjEyMy40NTYuNy44XCIgb3IgXCJleGFtcGxlLmNvbVwiKVxuXHQgKiAtICoqcG9ydDoqKiBUaGUgcG9ydCwgYXMgYSBudW1iZXIuIChleDogMTMzNylcblx0ICogLSAqKnBhdGg6KiogVGhlIHBhdGguIChleDogXCIvXCIgb3IgXCIvYWJvdXQuaHRtbFwiKVxuXHQgKiAtICoqcXVlcnk6KiogXCJUaGUgcXVlcnkgc3RyaW5nLiAoZXg6IFwiZm9vPWJhciZ2PTE3JmZvcm1hdD1qc29uXCIpXG5cdCAqIC0gKipnZXQ6KiogVGhlIHF1ZXJ5IHN0cmluZyBwYXJzZWQgd2l0aCBnZXQuICBJZiBgb3B0LmdldGAgaXMgYGZhbHNlYCB0aGlzXG5cdCAqICAgd2lsbCBiZSBhYnNlbnRcblx0ICogLSAqKmhhc2g6KiogVGhlIHZhbHVlIGFmdGVyIHRoZSBoYXNoLiAoZXg6IFwibXlhbmNob3JcIilcblx0ICogICBiZSB1bmRlZmluZWQgZXZlbiBpZiBgcXVlcnlgIGlzIHNldC5cblx0ICpcblx0ICogQHBhcmFte3N0cmluZ30gdXJsIFRoZSBVUkwgdG8gcGFyc2UuXG5cdCAqIEBwYXJhbXt7Z2V0Ok9iamVjdH09fSBvcHQgT3B0aW9uczpcblx0ICpcblx0ICogLSBnZXQ6IEFuIG9wdGlvbnMgYXJndW1lbnQgdG8gYmUgcGFzc2VkIHRvICNnZXQgb3IgZmFsc2UgdG8gbm90IGNhbGwgI2dldC5cblx0ICogICAgKipETyBOT1QqKiBzZXQgYGZ1bGxgLlxuXHQgKlxuXHQgKiBAcmV0dXJueyFPYmplY3R9IEFuIG9iamVjdCB3aXRoIHRoZSBwYXJzZWQgdmFsdWVzLlxuXHQgKi9cblx0XCJwYXJzZVwiOiBmdW5jdGlvbih1cmwsIG9wdCkge1xuXG5cdFx0aWYgKCB0eXBlb2Ygb3B0ID09IFwidW5kZWZpbmVkXCIgKSBvcHQgPSB7fTtcblxuXHRcdHZhciBtZCA9IHVybC5tYXRjaChyZWdleCkgfHwgW107XG5cblx0XHR2YXIgciA9IHtcblx0XHRcdFwidXJsXCI6ICAgIHVybCxcblxuXHRcdFx0XCJzY2hlbWVcIjogbWRbMV0sXG5cdFx0XHRcInVzZXJcIjogICBtZFsyXSxcblx0XHRcdFwicGFzc1wiOiAgIG1kWzNdLFxuXHRcdFx0XCJob3N0XCI6ICAgbWRbNF0sXG5cdFx0XHRcInBvcnRcIjogICBtZFs1XSAmJiArbWRbNV0sXG5cdFx0XHRcInBhdGhcIjogICBtZFs2XSxcblx0XHRcdFwicXVlcnlcIjogIG1kWzddLFxuXHRcdFx0XCJoYXNoXCI6ICAgbWRbOF0sXG5cdFx0fTtcblxuXHRcdGlmICggb3B0LmdldCAhPT0gZmFsc2UgKVxuXHRcdFx0cltcImdldFwiXSA9IHJbXCJxdWVyeVwiXSAmJiBzZWxmW1wiZ2V0XCJdKHJbXCJxdWVyeVwiXSwgb3B0LmdldCk7XG5cblx0XHRyZXR1cm4gcjtcblx0fSxcblxuXHQvKiogQnVpbGQgYSBVUkwgZnJvbSBjb21wb25lbnRzLlxuXHQgKlxuXHQgKiBUaGlzIHBpZWNlcyB0b2dldGhlciBhIHVybCBmcm9tIHRoZSBwcm9wZXJ0aWVzIG9mIHRoZSBwYXNzZWQgaW4gb2JqZWN0LlxuXHQgKiBJbiBnZW5lcmFsIHBhc3NpbmcgdGhlIHJlc3VsdCBvZiBgcGFyc2UoKWAgc2hvdWxkIHJldHVybiB0aGUgVVJMLiAgVGhlcmVcblx0ICogbWF5IGRpZmZlcmVuY2VzIGluIHRoZSBnZXQgc3RyaW5nIGFzIHRoZSBrZXlzIGFuZCB2YWx1ZXMgbWlnaHQgYmUgbW9yZVxuXHQgKiBlbmNvZGVkIHRoZW4gdGhleSB3ZXJlIG9yaWdpbmFsbHkgd2VyZS4gIEhvd2V2ZXIsIGNhbGxpbmcgYGdldCgpYCBvbiB0aGVcblx0ICogdHdvIHZhbHVlcyBzaG91bGQgeWllbGQgdGhlIHNhbWUgcmVzdWx0LlxuXHQgKlxuXHQgKiBIZXJlIGlzIGhvdyB0aGUgcGFyYW1ldGVycyBhcmUgdXNlZC5cblx0ICpcblx0ICogIC0gdXJsOiBVc2VkIG9ubHkgaWYgbm8gb3RoZXIgdmFsdWVzIGFyZSBwcm92aWRlZC4gIElmIHRoYXQgaXMgdGhlIGNhc2Vcblx0ICogICAgIGB1cmxgIHdpbGwgYmUgcmV0dXJuZWQgdmVyYmF0aW0uXG5cdCAqICAtIHNjaGVtZTogVXNlZCBpZiBkZWZpbmVkLlxuXHQgKiAgLSB1c2VyOiBVc2VkIGlmIGRlZmluZWQuXG5cdCAqICAtIHBhc3M6IFVzZWQgaWYgZGVmaW5lZC5cblx0ICogIC0gaG9zdDogVXNlZCBpZiBkZWZpbmVkLlxuXHQgKiAgLSBwYXRoOiBVc2VkIGlmIGRlZmluZWQuXG5cdCAqICAtIHF1ZXJ5OiBVc2VkIG9ubHkgaWYgYGdldGAgaXMgbm90IHByb3ZpZGVkIGFuZCBub24tZW1wdHkuXG5cdCAqICAtIGdldDogVXNlZCBpZiBub24tZW1wdHkuICBQYXNzZWQgdG8gI2J1aWxkZ2V0IGFuZCB0aGUgcmVzdWx0IGlzIHVzZWRcblx0ICogICAgYXMgdGhlIHF1ZXJ5IHN0cmluZy5cblx0ICogIC0gaGFzaDogVXNlZCBpZiBkZWZpbmVkLlxuXHQgKlxuXHQgKiBUaGVzZSBhcmUgdGhlIG9wdGlvbnMgdGhhdCBhcmUgdmFsaWQgb24gdGhlIG9wdGlvbnMgb2JqZWN0LlxuXHQgKlxuXHQgKiAgLSB1c2VlbXB0eWdldDogSWYgdHJ1dGh5LCBhIHF1ZXN0aW9uIG1hcmsgd2lsbCBiZSBhcHBlbmRlZCBmb3IgZW1wdHkgZ2V0XG5cdCAqICAgIHN0cmluZ3MuICBUaGlzIG5vdGFibHkgbWFrZXMgYGJ1aWxkKClgIGFuZCBgcGFyc2UoKWAgZnVsbHkgc3ltbWV0cmljLlxuXHQgKlxuXHQgKiBAcGFyYW17T2JqZWN0fSBkYXRhIFRoZSBwaWVjZXMgb2YgdGhlIFVSTC5cblx0ICogQHBhcmFte09iamVjdH0gb3B0IE9wdGlvbnMgZm9yIGJ1aWxkaW5nIHRoZSB1cmwuXG5cdCAqIEByZXR1cm57c3RyaW5nfSBUaGUgVVJMLlxuXHQgKi9cblx0XCJidWlsZFwiOiBmdW5jdGlvbihkYXRhLCBvcHQpe1xuXHRcdG9wdCA9IG9wdCB8fCB7fTtcblxuXHRcdHZhciByID0gXCJcIjtcblxuXHRcdGlmICggdHlwZW9mIGRhdGFbXCJzY2hlbWVcIl0gIT0gXCJ1bmRlZmluZWRcIiApXG5cdFx0e1xuXHRcdFx0ciArPSBkYXRhW1wic2NoZW1lXCJdO1xuXHRcdFx0ciArPSAobm9zbGFzaC5pbmRleE9mKGRhdGFbXCJzY2hlbWVcIl0pPj0wKT9cIjpcIjpcIjovL1wiO1xuXHRcdH1cblx0XHRpZiAoIHR5cGVvZiBkYXRhW1widXNlclwiXSAhPSBcInVuZGVmaW5lZFwiIClcblx0XHR7XG5cdFx0XHRyICs9IGRhdGFbXCJ1c2VyXCJdO1xuXHRcdFx0aWYgKCB0eXBlb2YgZGF0YVtcInBhc3NcIl0gPT0gXCJ1bmRlZmluZWRcIiApXG5cdFx0XHR7XG5cdFx0XHRcdHIgKz0gXCJAXCI7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGlmICggdHlwZW9mIGRhdGFbXCJwYXNzXCJdICE9IFwidW5kZWZpbmVkXCIgKSByICs9IFwiOlwiICsgZGF0YVtcInBhc3NcIl0gKyBcIkBcIjtcblx0XHRpZiAoIHR5cGVvZiBkYXRhW1wiaG9zdFwiXSAhPSBcInVuZGVmaW5lZFwiICkgciArPSBkYXRhW1wiaG9zdFwiXTtcblx0XHRpZiAoIHR5cGVvZiBkYXRhW1wicG9ydFwiXSAhPSBcInVuZGVmaW5lZFwiICkgciArPSBcIjpcIiArIGRhdGFbXCJwb3J0XCJdO1xuXHRcdGlmICggdHlwZW9mIGRhdGFbXCJwYXRoXCJdICE9IFwidW5kZWZpbmVkXCIgKSByICs9IGRhdGFbXCJwYXRoXCJdO1xuXG5cdFx0aWYgKG9wdFtcInVzZWVtcHR5Z2V0XCJdKVxuXHRcdHtcblx0XHRcdGlmICAgICAgKCB0eXBlb2YgZGF0YVtcImdldFwiXSAgICE9IFwidW5kZWZpbmVkXCIgKSByICs9IFwiP1wiICsgc2VsZltcImJ1aWxkZ2V0XCJdKGRhdGFbXCJnZXRcIl0pO1xuXHRcdFx0ZWxzZSBpZiAoIHR5cGVvZiBkYXRhW1wicXVlcnlcIl0gIT0gXCJ1bmRlZmluZWRcIiApIHIgKz0gXCI/XCIgKyBkYXRhW1wicXVlcnlcIl07XG5cdFx0fVxuXHRcdGVsc2Vcblx0XHR7XG5cdFx0XHQvLyBJZiAuZ2V0IHVzZSBpdC4gIElmIC5nZXQgbGVhZHMgdG8gZW1wdHksIHVzZSAucXVlcnkuXG5cdFx0XHR2YXIgcSA9IGRhdGFbXCJnZXRcIl0gJiYgc2VsZltcImJ1aWxkZ2V0XCJdKGRhdGFbXCJnZXRcIl0pIHx8IGRhdGFbXCJxdWVyeVwiXTtcblx0XHRcdGlmIChxKSByICs9IFwiP1wiICsgcTtcblx0XHR9XG5cblx0XHRpZiAoIHR5cGVvZiBkYXRhW1wiaGFzaFwiXSAhPSBcInVuZGVmaW5lZFwiICkgciArPSBcIiNcIiArIGRhdGFbXCJoYXNoXCJdO1xuXG5cdFx0cmV0dXJuIHIgfHwgZGF0YVtcInVybFwiXSB8fCBcIlwiO1xuXHR9LFxufTtcblxuaWYgKCB0eXBlb2YgZGVmaW5lICE9IFwidW5kZWZpbmVkXCIgJiYgZGVmaW5lW1wiYW1kXCJdICkgZGVmaW5lKHNlbGYpO1xuZWxzZSBpZiAoIHR5cGVvZiBtb2R1bGUgIT0gXCJ1bmRlZmluZWRcIiApIG1vZHVsZVsnZXhwb3J0cyddID0gc2VsZjtcbmVsc2Ugd2luZG93W1widXJsXCJdID0gc2VsZjtcblxufSgpOyIsImNvbnN0IGFzaWRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2FzaWRlJyk7XG5jb25zdCBhc2lkZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhc2lkZS1idG4nKTtcbmZ1bmN0aW9uIGhhbmRsZUFzaWRlKGV2ZW50KSB7XG4gICAgYXNpZGUuY2xhc3NMaXN0LmFkZCgnb3BlbicpO1xufVxuaWYgKGFzaWRlQnRuKVxue1xuICAgIGFzaWRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlQXNpZGUpO1xufVxuXG5jb25zdCBwcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGUnKTtcblxuaWYgKHByb2ZpbGUpXG57XG4gICAgY29uc3QgZHJvcGRvd24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZS1kcm9wZG93bicpO1xuXG4gICAgZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUNsaWNrKGV2ZW50KSB7XG4gICAgICAgIGRyb3Bkb3duLmNsYXNzTGlzdC5hZGQoJ29wZW4nKTtcbiAgICB9XG4gICAgcHJvZmlsZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZVByb2ZpbGVDbGljayk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgaWYgKCFldmVudC50YXJnZXQuY2xvc2VzdCgnLnByb2ZpbGUtZGl2JykpIHtcbiAgICAgICAgICAgIGRyb3Bkb3duLmNsYXNzTGlzdC5yZW1vdmUoJ29wZW4nKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWV2ZW50LnRhcmdldC5jbG9zZXN0KCcjYXNpZGUnKSAmJiAhZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJyNhc2lkZS1idG4nKSkge1xuICAgICAgICAgICAgYXNpZGUuY2xhc3NMaXN0LnJlbW92ZSgnb3BlbicpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5cbmlmICh3aW5kb3cuYW00Y29yZSlcbntcbiAgICBhbTRjb3JlLnJlYWR5KGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAvLyBUaGVtZXMgYmVnaW5cbiAgICAgICAgYW00Y29yZS51c2VUaGVtZShhbTR0aGVtZXNfYW1jaGFydHMpO1xuICAgICAgICAvLyBUaGVtZXMgZW5kXG5cbiAgICAgICAgLy8gQ3JlYXRlIGNoYXJ0IGluc3RhbmNlXG4gICAgICAgIHZhciBjaGFydCA9IGFtNGNvcmUuY3JlYXRlKFwiY2hhcnRkaXZcIiwgYW00Y2hhcnRzLlhZQ2hhcnQpO1xuXG4gICAgICAgIGNoYXJ0LnJ0bCA9IHRydWU7XG5cbiAgICAgICAgLy8gQWRkIGRhdGFcbiAgICAgICAgY2hhcnQuZGF0YSA9IFt7XG4gICAgICAgICAgICBcImNvdW50cnlcIjogXCJVU0FcIixcbiAgICAgICAgICAgIFwidmlzaXRzXCI6IDIwMjVcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgXCJjb3VudHJ5XCI6IFwiQ2hpbmFcIixcbiAgICAgICAgICAgIFwidmlzaXRzXCI6IDE4ODJcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgXCJjb3VudHJ5XCI6IFwiSmFwYW5cIixcbiAgICAgICAgICAgIFwidmlzaXRzXCI6IDE4MDlcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgXCJjb3VudHJ5XCI6IFwiR2VybWFueVwiLFxuICAgICAgICAgICAgXCJ2aXNpdHNcIjogMTMyMlxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBcImNvdW50cnlcIjogXCJVS1wiLFxuICAgICAgICAgICAgXCJ2aXNpdHNcIjogMTEyMlxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBcImNvdW50cnlcIjogXCJGcmFuY2VcIixcbiAgICAgICAgICAgIFwidmlzaXRzXCI6IDExMTRcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgXCJjb3VudHJ5XCI6IFwiSW5kaWFcIixcbiAgICAgICAgICAgIFwidmlzaXRzXCI6IDk4NFxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBcImNvdW50cnlcIjogXCJTcGFpblwiLFxuICAgICAgICAgICAgXCJ2aXNpdHNcIjogNzExXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIFwiY291bnRyeVwiOiBcIk5ldGhlcmxhbmRzXCIsXG4gICAgICAgICAgICBcInZpc2l0c1wiOiA2NjVcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgXCJjb3VudHJ5XCI6IFwiUnVzc2lhXCIsXG4gICAgICAgICAgICBcInZpc2l0c1wiOiA1ODBcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgXCJjb3VudHJ5XCI6IFwiU291dGggS29yZWFcIixcbiAgICAgICAgICAgIFwidmlzaXRzXCI6IDQ0M1xuICAgICAgICB9LCB7XG4gICAgICAgICAgICBcImNvdW50cnlcIjogXCJDYW5hZGFcIixcbiAgICAgICAgICAgIFwidmlzaXRzXCI6IDQ0MVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBcImNvdW50cnlcIjogXCJCcmF6aWxcIixcbiAgICAgICAgICAgIFwidmlzaXRzXCI6IDM5NVxuICAgICAgICB9XTtcblxuICAgICAgICAvLyBDcmVhdGUgYXhlc1xuXG4gICAgICAgIHZhciBjYXRlZ29yeUF4aXMgPSBjaGFydC54QXhlcy5wdXNoKG5ldyBhbTRjaGFydHMuQ2F0ZWdvcnlBeGlzKCkpO1xuICAgICAgICBjYXRlZ29yeUF4aXMuZGF0YUZpZWxkcy5jYXRlZ29yeSA9IFwiY291bnRyeVwiO1xuICAgICAgICBjYXRlZ29yeUF4aXMucmVuZGVyZXIuZ3JpZC50ZW1wbGF0ZS5sb2NhdGlvbiA9IDA7XG4gICAgICAgIGNhdGVnb3J5QXhpcy5yZW5kZXJlci5taW5HcmlkRGlzdGFuY2UgPSAzMDtcblxuICAgICAgICBjYXRlZ29yeUF4aXMucmVuZGVyZXIubGFiZWxzLnRlbXBsYXRlLmFkYXB0ZXIuYWRkKFwiZHlcIiwgZnVuY3Rpb24gKGR5LCB0YXJnZXQpIHtcbiAgICAgICAgICAgIGlmICh0YXJnZXQuZGF0YUl0ZW0gJiYgdGFyZ2V0LmRhdGFJdGVtLmluZGV4ICYgMiA9PSAyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGR5ICsgMjU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZHk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHZhciB2YWx1ZUF4aXMgPSBjaGFydC55QXhlcy5wdXNoKG5ldyBhbTRjaGFydHMuVmFsdWVBeGlzKCkpO1xuXG4gICAgICAgIC8vIENyZWF0ZSBzZXJpZXNcbiAgICAgICAgdmFyIHNlcmllcyA9IGNoYXJ0LnNlcmllcy5wdXNoKG5ldyBhbTRjaGFydHMuQ29sdW1uU2VyaWVzKCkpO1xuICAgICAgICBzZXJpZXMuZGF0YUZpZWxkcy52YWx1ZVkgPSBcInZpc2l0c1wiO1xuICAgICAgICBzZXJpZXMuZGF0YUZpZWxkcy5jYXRlZ29yeVggPSBcImNvdW50cnlcIjtcbiAgICAgICAgc2VyaWVzLm5hbWUgPSBcIlZpc2l0c1wiO1xuICAgICAgICBzZXJpZXMuY29sdW1ucy50ZW1wbGF0ZS50b29sdGlwVGV4dCA9IFwie2NhdGVnb3J5WH06IFtib2xkXXt2YWx1ZVl9Wy9dXCI7XG4gICAgICAgIHNlcmllcy5jb2x1bW5zLnRlbXBsYXRlLmZpbGxPcGFjaXR5ID0gLjg7XG5cbiAgICAgICAgdmFyIGNvbHVtblRlbXBsYXRlID0gc2VyaWVzLmNvbHVtbnMudGVtcGxhdGU7XG4gICAgICAgIGNvbHVtblRlbXBsYXRlLnN0cm9rZVdpZHRoID0gMjtcbiAgICAgICAgY29sdW1uVGVtcGxhdGUuc3Ryb2tlT3BhY2l0eSA9IDE7XG5cbiAgICB9KTtcbn1cblxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XG4gICAgaWYgKCQuZm4uc2VsZWN0MilcbiAgICB7XG4gICAgICAgICQoJy5zZWxlY3QyJykuc2VsZWN0MigpO1xuICAgIH1cbn0pO1xuXG5mdW5jdGlvbiByZWFkVVJMKGlucHV0KSB7XG4gICAgaWYgKGlucHV0LmZpbGVzICYmIGlucHV0LmZpbGVzWzBdKSB7XG4gICAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuXG4gICAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAkKGlucHV0KS5uZXh0KCdsYWJlbCcpLmNoaWxkcmVuKCdpbWcnKS5hdHRyKCdzcmMnLCBlLnRhcmdldC5yZXN1bHQpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoaW5wdXQuZmlsZXNbMF0pO1xuICAgIH1cbiAgfVxuXG4kKCcuaW5wdXQtYXZhdGFyJykuY2hhbmdlKGZ1bmN0aW9uKCkge1xuICAgIHJlYWRVUkwodGhpcyk7XG59KTsiLCJcbnZhciBkYXRlcGlja2VyID0gZnVuY3Rpb24gKGVsZW1lbnRJRCwgb3B0KSB7XG5cbiAgICAvLyBjaGVjayBhcmd1bWVudHNcbiAgICBpZiAodHlwZW9mIGVsZW1lbnRJRCAhPT0gXCJzdHJpbmdcIiB8fCBlbGVtZW50SUQubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJkYXRlcGlja2VyIGVycm9yOiBpbnB1dCBJRCBpcyBub3Qgc3RyaW5nIG9yIGlzIGVtcHR5XCIpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBvcHRpb25zID0gb3B0IHx8IHt9O1xuXG4gICAgLy8gdmFyaWFibGVzXG4gICAgdmFyIGlzQ2FsQ2xpY2tlZCA9IGZhbHNlO1xuICAgIHZhciBpc1N5bmNlZCA9IGZhbHNlO1xuXG4gICAgdmFyIGRheU9mV2VlaztcblxuICAgIHZhciBzZWxlY3RlZFllYXI7XG4gICAgdmFyIHNlbGVjdGVkTW9udGg7XG4gICAgdmFyIHNlbGVjdGVkRGF5O1xuXG4gICAgdmFyIGN1cnJlbnRZZWFyO1xuICAgIHZhciBjdXJyZW50TW9udGg7XG4gICAgdmFyIGN1cnJlbnREYXk7XG5cbiAgICB2YXIgdG9kYXlzWWVhcjtcbiAgICB2YXIgdG9kYXlzTW9udGg7XG4gICAgdmFyIHRvZGF5c0RheTtcblxuICAgIHZhciBkYXlPZldlZWtKO1xuXG4gICAgdmFyIG51bWJlck9mRGF5cztcblxuICAgIHZhciB0b2RheUc7XG4gICAgdmFyIHRvZGF5c0o7XG5cbiAgICAvLyBjb25zdHNcbiAgICB2YXIgTU9OVEhfTkFNRVMgPSB7XG4gICAgICAgIFwiMVwiOiBcItmB2LHZiNix2K/bjNmGXCJcbiAgICAgICAgLCBcIjJcIjogXCLYp9ix2K/bjNio2YfYtNiqXCJcbiAgICAgICAgLCBcIjNcIjogXCLYrtix2K/Yp9ivXCJcbiAgICAgICAgLCBcIjRcIjogXCLYqtuM2LFcIlxuICAgICAgICAsIFwiNVwiOiBcItmF2LHYr9in2K9cIlxuICAgICAgICAsIFwiNlwiOiBcIti02YfYsduM2YjYsVwiXG4gICAgICAgICwgXCI3XCI6IFwi2YXZh9ixXCJcbiAgICAgICAgLCBcIjhcIjogXCLYotio2KfZhlwiXG4gICAgICAgICwgXCI5XCI6IFwi2KLYsNixXCJcbiAgICAgICAgLCBcIjEwXCI6IFwi2K/bjFwiXG4gICAgICAgICwgXCIxMVwiOiBcItio2YfZhdmGXCJcbiAgICAgICAgLCBcIjEyXCI6IFwi2KfYs9mB2YbYr1wiXG4gICAgfVxuICAgIHZhciBEQVlfTkFNRVMgPSB7XG4gICAgICAgIFwi2LTZhtio2YdcIjogXCLYtFwiXG4gICAgICAgICwgXCLbjNqp2LTZhtio2YdcIjogXCLbjFwiXG4gICAgICAgICwgXCLYr9mI2LTZhtio2YdcIjogXCLYr1wiXG4gICAgICAgICwgXCLYs9mHINi02YbYqNmHXCI6IFwi2LNcIlxuICAgICAgICAsIFwi2obZh9in2LHYtNmG2KjZh1wiOiBcItqGXCJcbiAgICAgICAgLCBcItm+2YbYrCDYtNmG2KjZh1wiOiBcItm+XCJcbiAgICAgICAgLCBcItis2YXYudmHXCI6IFwi2KxcIlxuICAgIH07XG4gICAgdmFyIEZBX05VTVMgPSBbJ9mgJywgJ9mhJywgJ9miJywgJ9mjJywgJ9u0JywgJ9u1JywgJ9u2JywgJ9mnJywgJ9moJywgJ9mpJywgJ9mh2aAnLCAn2aHZoScsICfZodmiJywgJ9mh2aMnLCAn2aHbtCcsICfZodu1JywgJ9mh27YnLCAn2aHZpycsICfZodmoJywgJ9mh2aknLCAn2aLZoCcsICfZotmhJywgJ9mi2aInLCAn2aLZoycsICfZotu0JywgJ9mi27UnLCAn2aLbticsICfZotmnJywgJ9mi2agnLCAn2aLZqScsICfZo9mgJywgJ9mj2aEnLCAn2aPZoiddO1xuXG4gICAgLy8gc2V0IG9wdGlvbnNcbiAgICBvcHRpb25zLnBsYWNlaG9sZGVyID0gb3B0aW9ucy5wbGFjZWhvbGRlciAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5wbGFjZWhvbGRlciA6IFwiXCI7XG4gICAgb3B0aW9ucy50d29kaWdpdCA9IG9wdGlvbnMudHdvZGlnaXQgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMudHdvZGlnaXQgOiB0cnVlO1xuICAgIG9wdGlvbnMuY2xvc2VBZnRlclNlbGVjdCA9IG9wdGlvbnMuY2xvc2VBZnRlclNlbGVjdCAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5jbG9zZUFmdGVyU2VsZWN0IDogdHJ1ZTtcbiAgICBvcHRpb25zLm5leHRCdXR0b25JY29uID0gb3B0aW9ucy5uZXh0QnV0dG9uSWNvbiAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5uZXh0QnV0dG9uSWNvbiA6IGZhbHNlO1xuICAgIG9wdGlvbnMucHJldmlvdXNCdXR0b25JY29uID0gb3B0aW9ucy5wcmV2aW91c0J1dHRvbkljb24gIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMucHJldmlvdXNCdXR0b25JY29uIDogZmFsc2U7XG4gICAgb3B0aW9ucy5idXR0b25zQ29sb3IgPSBvcHRpb25zLmJ1dHRvbnNDb2xvciAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5idXR0b25zQ29sb3IgOiBmYWxzZTtcbiAgICBvcHRpb25zLmZvcmNlRmFyc2lEaWdpdHMgPSBvcHRpb25zLmZvcmNlRmFyc2lEaWdpdHMgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMuZm9yY2VGYXJzaURpZ2l0cyA6IGZhbHNlO1xuICAgIG9wdGlvbnMubWFya1RvZGF5ID0gb3B0aW9ucy5tYXJrVG9kYXkgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMubWFya1RvZGF5IDogZmFsc2U7XG4gICAgb3B0aW9ucy5tYXJrSG9saWRheXMgPSBvcHRpb25zLm1hcmtIb2xpZGF5cyAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5tYXJrSG9saWRheXMgOiBmYWxzZTtcbiAgICBvcHRpb25zLmhpZ2hsaWdodFNlbGVjdGVkRGF5ID0gb3B0aW9ucy5oaWdobGlnaHRTZWxlY3RlZERheSAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5oaWdobGlnaHRTZWxlY3RlZERheSA6IGZhbHNlO1xuICAgIG9wdGlvbnMuc3luYyA9IG9wdGlvbnMuc3luYyAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5zeW5jIDogZmFsc2U7XG4gICAgb3B0aW9ucy5nb3RvVG9kYXkgPSBvcHRpb25zLmdvdG9Ub2RheSAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5nb3RvVG9kYXkgOiBmYWxzZTtcblxuICAgIC8vIGNyZWF0ZSBET01cbiAgICB2YXIgaW5wdXRFbGVtZW50ID0gJChcIiNcIiArIGVsZW1lbnRJRCk7XG5cbiAgICBpZiAoaW5wdXRFbGVtZW50LmF0dHIoXCJwbGFjZWhvbGRlclwiKSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGlucHV0RWxlbWVudC5hdHRyKFwicGxhY2Vob2xkZXJcIiwgb3B0aW9ucy5wbGFjZWhvbGRlcik7XG4gICAgfVxuXG4gICAgLy8gY3JlYXRlIHBhcmVudCBkaXZcbiAgICBpbnB1dEVsZW1lbnQud3JhcChcIjxkaXYgaWQ9J2JkLXJvb3QtXCIgKyBlbGVtZW50SUQgKyBcIicgc3R5bGU9J3Bvc2l0aW9uOiByZWxhdGl2ZTsnPjwvZGl2PlwiKTtcblxuICAgIC8vIGNyZWF0ZSBtYWluIGRpdiBmb3IgY2FsZW5kYXIsIGJlbG93IGlucHV0IGVsZW1lbnRcbiAgICBpbnB1dEVsZW1lbnQuYWZ0ZXIoXCI8ZGl2IGlkPSdiZC1tYWluLVwiICsgZWxlbWVudElEICsgXCInIGNsYXNzPSdiZC1tYWluIGJkLWhpZGUnIHN0eWxlPSdwb3NpdGlvbjogYWJzb2x1dGU7IGRpcmVjdGlvbjogcnRsOyc+PC9kaXY+XCIpO1xuICAgIHZhciBtYWluRGl2ID0gJChcIiNiZC1tYWluLVwiICsgZWxlbWVudElEKTtcblxuICAgIC8vIGNyZWF0ZSBjYWxlbmRhciBkaXYgaW5zaWRlIG1haW4gZGl2XG4gICAgbWFpbkRpdi5hcHBlbmQoXCI8ZGl2IGNsYXNzPSdiZC1jYWxlbmRhcic+PC9kaXY+XCIpO1xuICAgIHZhciBjYWxlbmRhckRpdiA9IG1haW5EaXYuZmluZCgnLmJkLWNhbGVuZGFyJyk7XG5cbiAgICAvLyBjcmVhdGUgdGl0bGUgZGl2IGFuZCB0YWJsZSBpbnNpZGUgY2FsZW5kYXIgZGl2XG4gICAgY2FsZW5kYXJEaXYuYXBwZW5kKFwiPGRpdiBjbGFzcz0nYmQtdGl0bGUnPjwvZGl2PlwiKTtcbiAgICB2YXIgdGl0bGVEaXYgPSBjYWxlbmRhckRpdi5maW5kKCcuYmQtdGl0bGUnKTtcbiAgICBjYWxlbmRhckRpdi5hcHBlbmQoXCI8dGFibGUgY2xhc3M9J2JkLXRhYmxlJyBkaXI9J3J0bCcgY2VsbHNwYWNpbmc9JzAnIGNlbGxwYWRkaW5nPScwJz48L3RhYmxlPlwiKTtcblxuICAgIC8vIGNyZWF0ZSBtb250aCBhbmQgeWVhciBkcm9wIGRvd25zIGFuZCBuZXh0L3ByZXYgbW9udGggYnV0dG9ucyBpbnNpZGUgdGl0bGUgZGl2XG4gICAgdGl0bGVEaXYuYXBwZW5kKFwiPGJ1dHRvbiBpZD0nYmQtbmV4dC1cIiArIGVsZW1lbnRJRCArIFwiJyBjbGFzcz0nYmQtbmV4dCcgdHlwZT0nYnV0dG9uJyB0aXRsZT0n2YXYp9mHINio2LnYr9uMJyBkYXRhLXRvZ2dsZT0ndG9vbHRpcCc+PHNwYW4+2KjYudiv24w8L3NwYW4+PC9idXR0b24+XCIpO1xuICAgIHZhciBuZXh0TW9udGggPSAkKFwiI2JkLW5leHQtXCIgKyBlbGVtZW50SUQpO1xuICAgIGlmIChvcHRpb25zLm5leHRCdXR0b25JY29uKSB7XG4gICAgICAgIG5leHRNb250aC5maW5kKFwic3BhblwiKS5jc3MoXCJkaXNwbGF5XCIsIFwibm9uZVwiKTtcbiAgICAgICAgaWYgKG9wdGlvbnMubmV4dEJ1dHRvbkljb24uaW5kZXhPZihcIi5cIikgIT09IC0xKSB7XG4gICAgICAgICAgICAvLyBpbWFnZVxuICAgICAgICAgICAgbmV4dE1vbnRoLmNzcyhcImJhY2tncm91bmQtaW1hZ2VcIiwgXCJ1cmwoXCIgKyBvcHRpb25zLm5leHRCdXR0b25JY29uICsgXCIpXCIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gY3NzIGNsYXNzXG4gICAgICAgICAgICBuZXh0TW9udGguYWRkQ2xhc3Mob3B0aW9ucy5uZXh0QnV0dG9uSWNvbik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB0aXRsZURpdi5hcHBlbmQoXCI8ZGl2IGNsYXNzPSdiZC1kcm9wZG93bic+PC9kaXY+PGRpdiBjbGFzcz0nYmQtZHJvcGRvd24nPjwvZGl2PlwiKTtcblxuICAgIHRpdGxlRGl2LmZpbmQoJy5iZC1kcm9wZG93bjpudGgtY2hpbGQoMiknKS5hcHBlbmQoXCI8c2VsZWN0IGlkPSdiZC1tb250aC1cIiArIGVsZW1lbnRJRCArIFwiJyBjbGFzcz0nYmQtbW9udGgnPjwvc2VsZWN0PlwiKTtcbiAgICB2YXIgbW9udGhEcm9wZG93biA9ICQoXCIjYmQtbW9udGgtXCIgKyBlbGVtZW50SUQpO1xuICAgICQuZWFjaChNT05USF9OQU1FUywgZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcbiAgICAgICAgbW9udGhEcm9wZG93bi5hcHBlbmQoJChcIjxvcHRpb24+PC9vcHRpb24+XCIpLmF0dHIoXCJ2YWx1ZVwiLCBrZXkpLnRleHQodmFsdWUpKTtcbiAgICB9KTtcblxuICAgIHRpdGxlRGl2LmZpbmQoJy5iZC1kcm9wZG93bjpudGgtY2hpbGQoMyknKS5hcHBlbmQoXCI8c2VsZWN0IGlkPSdiZC15ZWFyLVwiICsgZWxlbWVudElEICsgXCInIGNsYXNzPSdiZC15ZWFyJz48L3NlbGVjdD5cIik7XG4gICAgdmFyIHllYXJEcm9wZG93biA9ICQoXCIjYmQteWVhci1cIiArIGVsZW1lbnRJRCk7XG5cbiAgICB0aXRsZURpdi5hcHBlbmQoXCI8YnV0dG9uIGlkPSdiZC1wcmV2LVwiICsgZWxlbWVudElEICsgXCInIGNsYXNzPSdiZC1wcmV2JyB0eXBlPSdidXR0b24nIHRpdGxlPSfZhdin2Ycg2YLYqNmE24wnIGRhdGEtdG9nZ2xlPSd0b29sdGlwJz48c3Bhbj7Zgtio2YTbjDwvc3Bhbj48L2J1dHRvbj5cIik7XG4gICAgdmFyIHByZXZNb250aCA9ICQoXCIjYmQtcHJldi1cIiArIGVsZW1lbnRJRCk7XG4gICAgaWYgKG9wdGlvbnMubmV4dEJ1dHRvbkljb24pIHtcbiAgICAgICAgcHJldk1vbnRoLmZpbmQoXCJzcGFuXCIpLmNzcyhcImRpc3BsYXlcIiwgXCJub25lXCIpO1xuICAgICAgICBpZiAob3B0aW9ucy5wcmV2aW91c0J1dHRvbkljb24uaW5kZXhPZihcIi5cIikgIT09IC0xKSB7XG4gICAgICAgICAgICAvLyBpbWFnZVxuICAgICAgICAgICAgcHJldk1vbnRoLmNzcyhcImJhY2tncm91bmQtaW1hZ2VcIiwgXCJ1cmwoXCIgKyBvcHRpb25zLnByZXZpb3VzQnV0dG9uSWNvbiArIFwiKVwiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIGNzcyBjbGFzc1xuICAgICAgICAgICAgcHJldk1vbnRoLmFkZENsYXNzKG9wdGlvbnMucHJldmlvdXNCdXR0b25JY29uKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmIChvcHRpb25zLmJ1dHRvbnNDb2xvcikge1xuICAgICAgICBuZXh0TW9udGguY3NzKFwiY29sb3JcIiwgb3B0aW9ucy5idXR0b25zQ29sb3IpO1xuICAgICAgICBuZXh0TW9udGguZmluZChcInNwYW5cIikuY3NzKFwiY29sb3JcIiwgb3B0aW9ucy5idXR0b25zQ29sb3IpO1xuICAgICAgICBwcmV2TW9udGguY3NzKFwiY29sb3JcIiwgb3B0aW9ucy5idXR0b25zQ29sb3IpO1xuICAgICAgICBwcmV2TW9udGguZmluZChcInNwYW5cIikuY3NzKFwiY29sb3JcIiwgb3B0aW9ucy5idXR0b25zQ29sb3IpO1xuICAgIH1cblxuICAgIC8vIGNyZWF0ZSB0YWJsZSBoZWFkZXIgYW5kIGJvZHlcbiAgICBjYWxlbmRhckRpdi5maW5kKCcuYmQtdGFibGUnKS5hcHBlbmQoXCI8dGhlYWQ+PHRyPjwvdHI+PC90aGVhZD5cIik7XG4gICAgJC5lYWNoKERBWV9OQU1FUywgZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcbiAgICAgICAgY2FsZW5kYXJEaXYuZmluZCgnLmJkLXRhYmxlIHRoZWFkIHRyJykuYXBwZW5kKCQoXCI8dGg+PC90aD5cIikudGV4dCh2YWx1ZSkpO1xuICAgIH0pO1xuXG4gICAgY2FsZW5kYXJEaXYuZmluZCgnLmJkLXRhYmxlJykuYXBwZW5kKFwiPHRib2R5IGlkPSdiZC10YWJsZS1kYXlzLVwiICsgZWxlbWVudElEICsgXCInIGNsYXNzPSdiZC10YWJsZS1kYXlzJz48L3Rib2R5PlwiKTtcbiAgICB2YXIgZGF5c1RhYmxlID0gJChcIiNiZC10YWJsZS1kYXlzLVwiICsgZWxlbWVudElEKTtcblxuICAgIC8vIGNyZWF0ZSBnbyB0byB0b2RheXMgYnV0dG9uXG4gICAgaWYgKG9wdGlvbnMuZ290b1RvZGF5KSB7XG4gICAgICAgIGNhbGVuZGFyRGl2LmFwcGVuZChcIjxkaXYgY2xhc3M9J2JkLWdvdG8tdG9kYXknPtio2LHZiCDYqNmHINin2YXYsdmI2LI8L2Rpdj5cIik7XG4gICAgICAgIHZhciBnb3RvVG9kYXkgPSBjYWxlbmRhckRpdi5maW5kKFwiLmJkLWdvdG8tdG9kYXlcIik7XG4gICAgfVxuXG4gICAgLy8gb3BlbmluZyBhbmQgY2xvc2luZyBmdW5jdGlvbmFsaXR5XG4gICAgaW5wdXRFbGVtZW50Lm9uKFwiZm9jdXNcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICBtYWluRGl2LnJlbW92ZUNsYXNzKFwiYmQtaGlkZVwiKTtcbiAgICAgICAgaWYgKG9wdGlvbnMuc3luYyAmJiBpc1N5bmNlZCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIHN5bmNDYWxlbmRhcigpO1xuICAgICAgICAgICAgaXNTeW5jZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIG1haW5EaXY7XG4gICAgfSkub24oJ2JsdXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChpc0NhbENsaWNrZWQgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgIG1haW5EaXYuYWRkQ2xhc3MoXCJiZC1oaWRlXCIpO1xuICAgICAgICAgICAgaXNTeW5jZWQgPSBmYWxzZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlzQ2FsQ2xpY2tlZCA9IGZhbHNlO1xuICAgICAgICAgICAgaW5wdXRFbGVtZW50LmZvY3VzKCk7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICBtYWluRGl2Lm9uKCdtb3VzZWRvd24nLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgaXNDYWxDbGlja2VkID0gdHJ1ZTtcbiAgICB9KTtcblxuICAgIC8vIGRyb3Bkb3duIGV2ZW50c1xuICAgIG1vbnRoRHJvcGRvd24ub24oJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc2VsZWN0ZWRNb250aCA9IHBhcnNlSW50KHRoaXMudmFsdWUpO1xuICAgICAgICBudW1iZXJPZkRheXMgPSBtb250aERheXMoc2VsZWN0ZWRZZWFyLCBzZWxlY3RlZE1vbnRoKTtcbiAgICAgICAgZGF5T2ZXZWVrSiA9IGZpbmRGaXJzdERheU9mTW9udGgoc2VsZWN0ZWRZZWFyLCBzZWxlY3RlZE1vbnRoKTtcbiAgICAgICAgZHJhd0RheXMobnVtYmVyT2ZEYXlzLCBkYXlPZldlZWtKKTtcbiAgICB9KTtcbiAgICB5ZWFyRHJvcGRvd24ub24oJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc2VsZWN0ZWRZZWFyID0gcGFyc2VJbnQodGhpcy52YWx1ZSk7XG4gICAgICAgIG51bWJlck9mRGF5cyA9IG1vbnRoRGF5cyhzZWxlY3RlZFllYXIsIHNlbGVjdGVkTW9udGgpO1xuICAgICAgICBkYXlPZldlZWtKID0gZmluZEZpcnN0RGF5T2ZNb250aChzZWxlY3RlZFllYXIsIHNlbGVjdGVkTW9udGgpO1xuICAgICAgICBkcmF3RGF5cyhudW1iZXJPZkRheXMsIGRheU9mV2Vla0opO1xuICAgIH0pO1xuXG4gICAgLy8gR2VvcmdpYW4gdG8gSmFsYWxpIGNvbnZlcnRlciAobWluaWZpZWQpXG4gICAgLy8gc291cmNlIGlzIHVua25vd24uIGNvbnRhY3QgaWYgeW91IGtub3cgdGhlIGNvZGUgb3duZXIuXG4gICAgZnVuY3Rpb24gZ3JlZ29yaWFuVG9KYWxhbGkoYSwgciwgcykgeyBhID0gcGFyc2VJbnQoYSksIHIgPSBwYXJzZUludChyKSwgcyA9IHBhcnNlSW50KHMpOyBmb3IgKHZhciBuID0gYSAtIDE2MDAsIGUgPSByIC0gMSwgdCA9IHMgLSAxLCBwID0gMzY1ICogbiArIHBhcnNlSW50KChuICsgMykgLyA0KSAtIHBhcnNlSW50KChuICsgOTkpIC8gMTAwKSArIHBhcnNlSW50KChuICsgMzk5KSAvIDQwMCksIEkgPSAwOyBlID4gSTsgKytJKSBwICs9IGdfZGF5c1tJXTsgZSA+IDEgJiYgKG4gJSA0ID09IDAgJiYgbiAlIDEwMCAhPSAwIHx8IG4gJSA0MDAgPT0gMCkgJiYgKytwLCBwICs9IHQ7IHZhciB2ID0gcCAtIDc5LCBkID0gcGFyc2VJbnQodiAvIDEyMDUzKTsgdiAlPSAxMjA1MzsgdmFyIG8gPSA5NzkgKyAzMyAqIGQgKyA0ICogcGFyc2VJbnQodiAvIDE0NjEpOyB2ICU9IDE0NjEsIHYgPj0gMzY2ICYmIChvICs9IHBhcnNlSW50KCh2IC0gMSkgLyAzNjUpLCB2ID0gKHYgLSAxKSAlIDM2NSk7IGZvciAodmFyIEkgPSAwOyAxMSA+IEkgJiYgdiA+PSBqX2RheXNbSV07ICsrSSkgdiAtPSBqX2RheXNbSV07IHZhciB5ID0gSSArIDEsIF8gPSB2ICsgMTsgcmV0dXJuIFtvLCB5LCBfXSB9IHZhciBnX2RheXMgPSBbMzEsIDI4LCAzMSwgMzAsIDMxLCAzMCwgMzEsIDMxLCAzMCwgMzEsIDMwLCAzMV0sIGpfZGF5cyA9IFszMSwgMzEsIDMxLCAzMSwgMzEsIDMxLCAzMCwgMzAsIDMwLCAzMCwgMzAsIDI5XTtcbiAgICAvLyBKYWxhbGkgdG8gR2VvcmdpYW4gY29udmVydGVyIChtaW5pZmllZClcbiAgICAvLyBzb3VyY2UgaXMgdW5rbm93bi4gY29udGFjdCBpZiB5b3Uga25vdyB0aGUgY29kZSBvd25lci5cbiAgICBmdW5jdGlvbiB0b0phbGFhbGkoZCwgaSwgYSkgeyByZXR1cm4gZDJqKGcyZChkLCBpLCBhKSkgfSBmdW5jdGlvbiB0b0dyZWdvcmlhbihkLCBpLCBhKSB7IHJldHVybiBkMmcoajJkKGQsIGksIGEpKSB9IGZ1bmN0aW9uIGlzVmFsaWRKYWxhYWxpRGF0ZShkLCBpLCBhKSB7IHJldHVybiBkID49IC02MSAmJiAzMTc3ID49IGQgJiYgaSA+PSAxICYmIDEyID49IGkgJiYgYSA+PSAxICYmIGEgPD0gamFsYWFsaU1vbnRoTGVuZ3RoKGQsIGkpIH0gZnVuY3Rpb24gaXNMZWFwSmFsYWFsaVllYXIoZCkgeyByZXR1cm4gMCA9PT0gamFsQ2FsKGQpLmxlYXAgfSBmdW5jdGlvbiBqYWxhYWxpTW9udGhMZW5ndGgoZCwgaSkgeyByZXR1cm4gNiA+PSBpID8gMzEgOiAxMSA+PSBpID8gMzAgOiBpc0xlYXBKYWxhYWxpWWVhcihkKSA/IDMwIDogMjkgfSBmdW5jdGlvbiBqYWxDYWwoZCkgeyB2YXIgaSwgYSwgbiwgciwgdCwgbywgdiwgZSA9IFstNjEsIDksIDM4LCAxOTksIDQyNiwgNjg2LCA3NTYsIDgxOCwgMTExMSwgMTE4MSwgMTIxMCwgMTYzNSwgMjA2MCwgMjA5NywgMjE5MiwgMjI2MiwgMjMyNCwgMjM5NCwgMjQ1NiwgMzE3OF0sIGwgPSBlLmxlbmd0aCwgdSA9IGQgKyA2MjEsIG0gPSAtMTQsIGcgPSBlWzBdOyBpZiAoZyA+IGQgfHwgZCA+PSBlW2wgLSAxXSkgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBKYWxhYWxpIHllYXIgXCIgKyBkKTsgZm9yICh2ID0gMTsgbCA+IHYgJiYgKGkgPSBlW3ZdLCBhID0gaSAtIGcsICEoaSA+IGQpKTsgdiArPSAxKSBtID0gbSArIDggKiBkaXYoYSwgMzMpICsgZGl2KG1vZChhLCAzMyksIDQpLCBnID0gaTsgcmV0dXJuIG8gPSBkIC0gZywgbSA9IG0gKyA4ICogZGl2KG8sIDMzKSArIGRpdihtb2QobywgMzMpICsgMywgNCksIDQgPT09IG1vZChhLCAzMykgJiYgYSAtIG8gPT09IDQgJiYgKG0gKz0gMSksIHIgPSBkaXYodSwgNCkgLSBkaXYoMyAqIChkaXYodSwgMTAwKSArIDEpLCA0KSAtIDE1MCwgdCA9IDIwICsgbSAtIHIsIDYgPiBhIC0gbyAmJiAobyA9IG8gLSBhICsgMzMgKiBkaXYoYSArIDQsIDMzKSksIG4gPSBtb2QobW9kKG8gKyAxLCAzMykgLSAxLCA0KSwgLTEgPT09IG4gJiYgKG4gPSA0KSwgeyBsZWFwOiBuLCBneTogdSwgbWFyY2g6IHQgfSB9IGZ1bmN0aW9uIGoyZChkLCBpLCBhKSB7IHZhciBuID0gamFsQ2FsKGQpOyByZXR1cm4gZzJkKG4uZ3ksIDMsIG4ubWFyY2gpICsgMzEgKiAoaSAtIDEpIC0gZGl2KGksIDcpICogKGkgLSA3KSArIGEgLSAxIH0gZnVuY3Rpb24gZDJqKGQpIHsgdmFyIGksIGEsIG4sIHIgPSBkMmcoZCkuZ3ksIHQgPSByIC0gNjIxLCBvID0gamFsQ2FsKHQpLCB2ID0gZzJkKHIsIDMsIG8ubWFyY2gpOyBpZiAobiA9IGQgLSB2LCBuID49IDApIHsgaWYgKDE4NSA+PSBuKSByZXR1cm4gYSA9IDEgKyBkaXYobiwgMzEpLCBpID0gbW9kKG4sIDMxKSArIDEsIHsgank6IHQsIGptOiBhLCBqZDogaSB9OyBuIC09IDE4NiB9IGVsc2UgdCAtPSAxLCBuICs9IDE3OSwgMSA9PT0gby5sZWFwICYmIChuICs9IDEpOyByZXR1cm4gYSA9IDcgKyBkaXYobiwgMzApLCBpID0gbW9kKG4sIDMwKSArIDEsIHsgank6IHQsIGptOiBhLCBqZDogaSB9IH0gZnVuY3Rpb24gZzJkKGQsIGksIGEpIHsgdmFyIG4gPSBkaXYoMTQ2MSAqIChkICsgZGl2KGkgLSA4LCA2KSArIDEwMDEwMCksIDQpICsgZGl2KDE1MyAqIG1vZChpICsgOSwgMTIpICsgMiwgNSkgKyBhIC0gMzQ4NDA0MDg7IHJldHVybiBuID0gbiAtIGRpdigzICogZGl2KGQgKyAxMDAxMDAgKyBkaXYoaSAtIDgsIDYpLCAxMDApLCA0KSArIDc1MiB9IGZ1bmN0aW9uIGQyZyhkKSB7IHZhciBpLCBhLCBuLCByLCB0OyByZXR1cm4gaSA9IDQgKiBkICsgMTM5MzYxNjMxLCBpID0gaSArIDQgKiBkaXYoMyAqIGRpdig0ICogZCArIDE4MzE4NzcyMCwgMTQ2MDk3KSwgNCkgLSAzOTA4LCBhID0gNSAqIGRpdihtb2QoaSwgMTQ2MSksIDQpICsgMzA4LCBuID0gZGl2KG1vZChhLCAxNTMpLCA1KSArIDEsIHIgPSBtb2QoZGl2KGEsIDE1MyksIDEyKSArIDEsIHQgPSBkaXYoaSwgMTQ2MSkgLSAxMDAxMDAgKyBkaXYoOCAtIHIsIDYpLCB7IGd5OiB0LCBnbTogciwgZ2Q6IG4gfSB9IGZ1bmN0aW9uIGRpdihkLCBpKSB7IHJldHVybiB+fihkIC8gaSkgfSBmdW5jdGlvbiBtb2QoZCwgaSkgeyByZXR1cm4gZCAtIH5+KGQgLyBpKSAqIGkgfVxuXG4gICAgdmFyIHN5bmNDYWxlbmRhciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGlucHV0VmFsdWUgPSBmaXhEYXRlKGlucHV0RWxlbWVudC52YWwoKSk7XG4gICAgICAgIGlmIChpbnB1dFZhbHVlID09PSBcIlwiKVxuICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgIGlucHV0VmFsdWUgPSBpbnB1dFZhbHVlLnNwbGl0KFwiL1wiKTtcbiAgICAgICAgbW9udGhEcm9wZG93bi52YWwocGFyc2VJbnQoaW5wdXRWYWx1ZVsxXSkpO1xuICAgICAgICBtb250aERyb3Bkb3duLnRyaWdnZXIoXCJjaGFuZ2VcIik7XG4gICAgICAgIHllYXJEcm9wZG93bi52YWwocGFyc2VJbnQoaW5wdXRWYWx1ZVswXSkpO1xuICAgICAgICB5ZWFyRHJvcGRvd24udHJpZ2dlcihcImNoYW5nZVwiKTtcblxuICAgICAgICBpZiAob3B0aW9ucy5oaWdobGlnaHRTZWxlY3RlZERheSkge1xuICAgICAgICAgICAgbWFpbkRpdi5maW5kKFwiLmJkLXNlbGVjdGVkLWRheVwiKS5yZW1vdmVDbGFzcyhcImJkLXNlbGVjdGVkLWRheVwiKTtcbiAgICAgICAgICAgIG1haW5EaXYuZmluZChcIi5kYXktXCIgKyBwYXJzZUludChpbnB1dFZhbHVlWzJdKSkuYWRkQ2xhc3MoXCJiZC1zZWxlY3RlZC1kYXlcIik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgZml4RGF0ZSA9IGZ1bmN0aW9uIChkYXRlKSB7XG4gICAgICAgIGlmIChkYXRlID09PSBcIlwiKVxuICAgICAgICAgICAgcmV0dXJuIFwiXCI7XG5cbiAgICAgICAgZGF0ZSA9IGRhdGUuc3BsaXQoXCIvXCIpO1xuICAgICAgICAvLyBpZiAoZGF0ZVswXS5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgLy8gICAgIGRhdGVbMF0gPSBcIjEzXCIgKyBkYXRlWzBdO1xuICAgICAgICAvLyB9XG4gICAgICAgIGlmIChkYXRlWzFdLmxlbmd0aCA8IDIpIHtcbiAgICAgICAgICAgIGlmIChkYXRlWzFdIDwgMTApIHtcbiAgICAgICAgICAgICAgICBkYXRlWzFdID0gXCIwXCIgKyBkYXRlWzFdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChkYXRlWzJdLmxlbmd0aCA8IDIpIHtcbiAgICAgICAgICAgIGlmIChkYXRlWzJdIDwgMTApIHtcbiAgICAgICAgICAgICAgICBkYXRlWzJdID0gXCIwXCIgKyBkYXRlWzJdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGRhdGUgPSBkYXRlLmpvaW4oXCIvXCIpO1xuICAgICAgICByZXR1cm4gZGF0ZTtcbiAgICB9XG5cbiAgICB2YXIgY29udmVydFRvSldlZWsgPSBmdW5jdGlvbiAoZGF5T2ZXZWVrRykge1xuICAgICAgICB2YXIgZGF5T2ZXZWVrSjtcbiAgICAgICAgaWYgKGRheU9mV2Vla0cgPCA2KSB7XG4gICAgICAgICAgICBkYXlPZldlZWtKID0gZGF5T2ZXZWVrRyArIDE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkYXlPZldlZWtKID0gMDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGF5T2ZXZWVrSjtcbiAgICB9XG5cbiAgICB2YXIgbWFrZVllYXJMaXN0ID0gZnVuY3Rpb24gKHRoaXNZZWFyKSB7XG4gICAgICAgIHllYXJEcm9wZG93bi5maW5kKCdvcHRpb24nKS5yZW1vdmUoKTtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IDEwMTsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgdGVtcFllYXIgPSAoKHRoaXNZZWFyIC0gOTUpICsgaSkgKyAnJztcbiAgICAgICAgICAgIGlmIChvcHRpb25zLmZvcmNlRmFyc2lEaWdpdHMpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IDEwOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJneCA9IG5ldyBSZWdFeHAoaiwgJ2cnKTtcbiAgICAgICAgICAgICAgICAgICAgdGVtcFllYXIgPSB0ZW1wWWVhci5yZXBsYWNlKHJneCwgRkFfTlVNU1tqXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgeWVhckRyb3Bkb3duLmFwcGVuZCgkKCc8b3B0aW9uPicsIHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogKHRoaXNZZWFyIC0gOTUpICsgaSxcbiAgICAgICAgICAgICAgICB0ZXh0OiB0ZW1wWWVhclxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gaXNsZWFwIGNhbGN1bGF0b3IsIHN1cHBvcnRlZCB5ZWFyOiAxMjQzIC0gMTQ3M1xuICAgIHZhciBpc0xlYXBZZWFyID0gZnVuY3Rpb24gKHllYXIpIHtcbiAgICAgICAgdmFyIG1vZDtcbiAgICAgICAgaWYgKHllYXIgPCAxMzQzICYmIHllYXIgPiAxMjQzKSB7XG4gICAgICAgICAgICBtb2QgPSB5ZWFyICUgMzM7XG4gICAgICAgICAgICBpZiAobW9kID09IDEgfHwgbW9kID09IDUgfHwgbW9kID09IDkgfHwgbW9kID09IDEzIHx8IG1vZCA9PSAxNyB8fCBtb2QgPT0gMjIgfHwgbW9kID09IDI2IHx8IG1vZCA9PSAzMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoeWVhciA8IDE0NzMgJiYgeWVhciA+IDEzNDIpIHtcbiAgICAgICAgICAgIG1vZCA9IHllYXIgJSAxNztcbiAgICAgICAgICAgIGlmIChtb2QgPT0gMSB8fCBtb2QgPT0gNSB8fCBtb2QgPT0gOSB8fCBtb2QgPT0gMTMgfHwgbW9kID09IDE4IHx8IG1vZCA9PSAyMiB8fCBtb2QgPT0gMjYgfHwgbW9kID09IDMwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFwidW5rbm93blwiO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdmFyIG1vbnRoRGF5cyA9IGZ1bmN0aW9uICh5ZWFyLCBtb250aCkge1xuICAgICAgICBpZiAobW9udGggPCA3KSB7XG4gICAgICAgICAgICByZXR1cm4gMzE7XG4gICAgICAgIH0gZWxzZSBpZiAobW9udGggPCAxMikge1xuICAgICAgICAgICAgcmV0dXJuIDMwO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKGlzTGVhcFllYXIoeWVhcikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMzA7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiAyOTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIG1ha2UgZmlyc3QgcGFnZSBvZiBjYWxlbmRhclxuICAgIHRvZGF5RyA9IG5ldyBEYXRlKCk7XG5cbiAgICB0b2RheXNKID0gZ3JlZ29yaWFuVG9KYWxhbGkodG9kYXlHLmdldEZ1bGxZZWFyKCksIHRvZGF5Ry5nZXRNb250aCgpICsgMSwgdG9kYXlHLmdldERhdGUoKSk7XG4gICAgdmFyIHNlbGVjdGVkRGF0ZUogPSBbXTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgMzsgaSsrKSB7XG4gICAgICAgIHNlbGVjdGVkRGF0ZUpbaV0gPSB0b2RheXNKW2ldO1xuICAgIH1cblxuICAgIHRvZGF5c1llYXIgPSB0b2RheXNKWzBdO1xuICAgIHRvZGF5c01vbnRoID0gdG9kYXlzSlsxXTtcbiAgICB0b2RheXNEYXkgPSB0b2RheXNKWzJdO1xuXG4gICAgc2VsZWN0ZWRZZWFyID0gc2VsZWN0ZWREYXRlSlswXTtcbiAgICBzZWxlY3RlZE1vbnRoID0gc2VsZWN0ZWREYXRlSlsxXTtcbiAgICBzZWxlY3RlZERheSA9IHNlbGVjdGVkRGF0ZUpbMl07XG5cbiAgICBtb250aERyb3Bkb3duLnZhbChzZWxlY3RlZE1vbnRoKTtcbiAgICBtYWtlWWVhckxpc3Qoc2VsZWN0ZWRZZWFyKTtcbiAgICB5ZWFyRHJvcGRvd24udmFsKHNlbGVjdGVkWWVhcik7XG5cbiAgICBudW1iZXJPZkRheXMgPSBtb250aERheXMoc2VsZWN0ZWRZZWFyLCBzZWxlY3RlZE1vbnRoKTtcblxuICAgIC8vIGZpbmQgZmlyc3QgZGF5IG9mIG1vbnRoIGluIHdlZWtcbiAgICB2YXIgZmluZEZpcnN0RGF5T2ZNb250aCA9IGZ1bmN0aW9uIChzZWxlY3RlZFllYXIsIHNlbGVjdGVkTW9udGgpIHtcbiAgICAgICAgdmFyIGZpcnN0RGF5T2ZNb250aEcgPSB0b0dyZWdvcmlhbihzZWxlY3RlZFllYXIsIHNlbGVjdGVkTW9udGgsIDEpO1xuICAgICAgICBmaXJzdERheU9mTW9udGhHID0gbmV3IERhdGUoZmlyc3REYXlPZk1vbnRoRy5neSArIFwiL1wiICsgZmlyc3REYXlPZk1vbnRoRy5nbSArIFwiL1wiICsgZmlyc3REYXlPZk1vbnRoRy5nZCk7XG4gICAgICAgIHJldHVybiBjb252ZXJ0VG9KV2VlayhmaXJzdERheU9mTW9udGhHLmdldERheSgpKTtcbiAgICB9XG4gICAgZGF5T2ZXZWVrSiA9IGZpbmRGaXJzdERheU9mTW9udGgoc2VsZWN0ZWRZZWFyLCBzZWxlY3RlZE1vbnRoKTtcblxuICAgIC8vIGRyYXcgZGF5cyBvbiBjYWxlbmRhclxuICAgIHZhciBkcmF3RGF5cyA9IGZ1bmN0aW9uIChudW1iZXJPZkRheXMsIGRheU9mV2Vla0opIHtcbiAgICAgICAgZGF5c1RhYmxlLmVtcHR5KCk7XG4gICAgICAgIHZhciBkYXlJbmRleCA9IDE7XG4gICAgICAgIHZhciByb3dJbmRleCA9IDE7XG4gICAgICAgIHdoaWxlIChkYXlJbmRleCA8PSBudW1iZXJPZkRheXMpIHtcbiAgICAgICAgICAgIGRheXNUYWJsZS5hcHBlbmQoJCgnPHRyPicsIHtcbiAgICAgICAgICAgICAgICBjbGFzczogXCJ0ci1cIiArIHJvd0luZGV4XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgNzsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGRheUluZGV4ID09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGogPSAwO1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoaiA8IGRheU9mV2Vla0opIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoXCIjYmQtdGFibGUtZGF5cy1cIiArIGVsZW1lbnRJRCArIFwiIC50ci0xXCIpLmFwcGVuZCgkKCc8dGQ+Jywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzOiBcImJkLWVtcHR5LWNlbGxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBqKys7XG4gICAgICAgICAgICAgICAgICAgICAgICBpKys7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGkgPCA3ICYmIGRheUluZGV4IDw9IG51bWJlck9mRGF5cykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcFREID0gJzx0ZD4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICc8YnV0dG9uIGNsYXNzPVwiZGF5IGRheS0nICsgZGF5SW5kZXggKyAnXCIgdHlwZT1cImJ1dHRvblwiPicgKyAob3B0aW9ucy5mb3JjZUZhcnNpRGlnaXRzID8gRkFfTlVNU1tkYXlJbmRleF0gOiBkYXlJbmRleCkgKyAnPC9idXR0b24+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnPC90ZD4nO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIG1hcmsgdG9kYXlzIGRheSBieSBhZGRpbmcgLmJkLXRvZGF5IGNsYXNzXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLm1hcmtUb2RheSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRheUluZGV4ID09IHRvZGF5c0RheSAmJiB0b2RheXNNb250aCA9PSBzZWxlY3RlZE1vbnRoICYmIHRvZGF5c1llYXIgPT0gc2VsZWN0ZWRZZWFyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkeCA9IHRlbXBURC5pbmRleE9mKCdkYXkgZGF5LScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBURCA9IHRlbXBURC5zbGljZSgwLCBpZHgpICsgJyBiZC10b2RheSAnICsgdGVtcFRELnNsaWNlKGlkeCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBtYXJrIGhvbGlkYXlzIGJ5IGFkZGluZyAuYmQtaG9saWRheSBjbGFzc1xuICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5tYXJrSG9saWRheXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpID09IDYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWR4ID0gdGVtcFRELmluZGV4T2YoJ2RheSBkYXktJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcFREID0gdGVtcFRELnNsaWNlKDAsIGlkeCkgKyAnIGJkLWhvbGlkYXkgJyArIHRlbXBURC5zbGljZShpZHgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgJChcIiNiZC10YWJsZS1kYXlzLVwiICsgZWxlbWVudElEICsgXCIgLnRyLVwiICsgcm93SW5kZXgpLmFwcGVuZCh0ZW1wVEQpO1xuXG4gICAgICAgICAgICAgICAgICAgIGRheUluZGV4Kys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcm93SW5kZXgrKztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChvcHRpb25zLmhpZ2hsaWdodFNlbGVjdGVkRGF5KSB7XG4gICAgICAgICAgICB2YXIgaW5wdXRWYWx1ZSA9IGlucHV0RWxlbWVudC52YWwoKTtcbiAgICAgICAgICAgIGlucHV0VmFsdWUgPSBpbnB1dFZhbHVlLnNwbGl0KFwiL1wiKTtcbiAgICAgICAgICAgIGlmIChpbnB1dFZhbHVlWzBdID09IHNlbGVjdGVkWWVhciAmJiBpbnB1dFZhbHVlWzFdID09IHNlbGVjdGVkTW9udGgpIHtcbiAgICAgICAgICAgICAgICBtYWluRGl2LmZpbmQoXCIuYmQtc2VsZWN0ZWQtZGF5XCIpLnJlbW92ZUNsYXNzKFwiYmQtc2VsZWN0ZWQtZGF5XCIpO1xuICAgICAgICAgICAgICAgIG1haW5EaXYuZmluZChcIi5kYXktXCIgKyBwYXJzZUludChpbnB1dFZhbHVlWzJdKSkuYWRkQ2xhc3MoXCJiZC1zZWxlY3RlZC1kYXlcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgIH1cblxuICAgIGlucHV0RWxlbWVudC5wYXJlbnQoKS5vbihcImNsaWNrXCIsIFwiYnV0dG9uLmRheVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBkYXRlc3RyID0gc2VsZWN0ZWRZZWFyICsgXCIvXCIgKyBzZWxlY3RlZE1vbnRoICsgXCIvXCIgKyAkKHRoaXMpLmF0dHIoJ2NsYXNzJykuc3BsaXQoXCIgXCIpWyQodGhpcykuYXR0cignY2xhc3MnKS5zcGxpdChcIiBcIikuaW5kZXhPZignZGF5JykgKyAxXS5zcGxpdChcIi1cIilbMV07XG4gICAgICAgIGlmIChvcHRpb25zLnR3b2RpZ2l0KSB7XG4gICAgICAgICAgICBkYXRlc3RyID0gZml4RGF0ZShkYXRlc3RyKTtcbiAgICAgICAgfVxuICAgICAgICBpbnB1dEVsZW1lbnQudmFsKGRhdGVzdHIpO1xuICAgICAgICBpbnB1dEVsZW1lbnQudHJpZ2dlcihcImNoYW5nZVwiKTtcbiAgICAgICAgaWYgKG9wdGlvbnMuY2xvc2VBZnRlclNlbGVjdCkge1xuICAgICAgICAgICAgaXNDYWxDbGlja2VkID0gZmFsc2U7XG4gICAgICAgICAgICBpbnB1dEVsZW1lbnQudHJpZ2dlcihcImJsdXJcIik7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAob3B0aW9ucy5oaWdobGlnaHRTZWxlY3RlZERheSkge1xuICAgICAgICAgICAgbWFpbkRpdi5maW5kKFwiLmJkLXNlbGVjdGVkLWRheVwiKS5yZW1vdmVDbGFzcyhcImJkLXNlbGVjdGVkLWRheVwiKTtcbiAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoXCJiZC1zZWxlY3RlZC1kYXlcIik7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIG5leHRNb250aC5vbihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcIm1vbnRoOiBcIiArIHNlbGVjdGVkTW9udGggKyBcIiwgeWVhcjogXCIgKyBzZWxlY3RlZFllYXIpO1xuICAgICAgICBpZiAobW9udGhEcm9wZG93bi52YWwoKSA8IDEyKSB7XG4gICAgICAgICAgICBtb250aERyb3Bkb3duLnZhbChwYXJzZUludChtb250aERyb3Bkb3duLnZhbCgpKSArIDEpO1xuICAgICAgICAgICAgbW9udGhEcm9wZG93bi50cmlnZ2VyKFwiY2hhbmdlXCIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbW9udGhEcm9wZG93bi52YWwoMSk7XG4gICAgICAgICAgICBtb250aERyb3Bkb3duLnRyaWdnZXIoXCJjaGFuZ2VcIik7XG4gICAgICAgICAgICB5ZWFyRHJvcGRvd24udmFsKHBhcnNlSW50KHllYXJEcm9wZG93bi52YWwoKSkgKyAxKTtcbiAgICAgICAgICAgIHllYXJEcm9wZG93bi50cmlnZ2VyKFwiY2hhbmdlXCIpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICBwcmV2TW9udGgub24oXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChtb250aERyb3Bkb3duLnZhbCgpID4gMSkge1xuICAgICAgICAgICAgbW9udGhEcm9wZG93bi52YWwocGFyc2VJbnQobW9udGhEcm9wZG93bi52YWwoKSkgLSAxKTtcbiAgICAgICAgICAgIG1vbnRoRHJvcGRvd24udHJpZ2dlcihcImNoYW5nZVwiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1vbnRoRHJvcGRvd24udmFsKDEyKTtcbiAgICAgICAgICAgIG1vbnRoRHJvcGRvd24udHJpZ2dlcihcImNoYW5nZVwiKTtcbiAgICAgICAgICAgIHllYXJEcm9wZG93bi52YWwocGFyc2VJbnQoeWVhckRyb3Bkb3duLnZhbCgpKSAtIDEpO1xuICAgICAgICAgICAgeWVhckRyb3Bkb3duLnRyaWdnZXIoXCJjaGFuZ2VcIik7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIGlmIChvcHRpb25zLmdvdG9Ub2RheSkge1xuICAgICAgICBnb3RvVG9kYXkub24oXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBtb250aERyb3Bkb3duLnZhbCh0b2RheXNNb250aCk7XG4gICAgICAgICAgICBtb250aERyb3Bkb3duLnRyaWdnZXIoXCJjaGFuZ2VcIik7XG4gICAgICAgICAgICB5ZWFyRHJvcGRvd24udmFsKHRvZGF5c1llYXIpO1xuICAgICAgICAgICAgeWVhckRyb3Bkb3duLnRyaWdnZXIoXCJjaGFuZ2VcIik7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGRyYXdEYXlzKG51bWJlck9mRGF5cywgZGF5T2ZXZWVrSik7XG5cbiAgICAvLyBlbmFibGUgYm9vdHN0cmFwIHRvb2x0aXAgaWYgYm9vdHN0cmFwIGlzIGxvYWRlZFxuICAgIGlmICh0eXBlb2YgJCgpLm1vZGFsID09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgJCgnW2RhdGEtdG9nZ2xlPVwidG9vbHRpcFwiXScpLnRvb2x0aXAoKTtcbiAgICB9XG5cbn1cbiIsInZhciBtZWRpYV94bSA9IHdpbmRvdy5tYXRjaE1lZGlhKFwiKG1heC13aWR0aDogNTc1Ljk4cHgpXCIpO1xudmFyIG1lZGlhX3NtID0gd2luZG93Lm1hdGNoTWVkaWEoXCIobWluLXdpZHRoOiA1NzZweCkgYW5kIChtYXgtd2lkdGg6IDc2Ny45OHB4KVwiKTtcbnZhciBtZWRpYV9tZCA9IHdpbmRvdy5tYXRjaE1lZGlhKFwiKG1pbi13aWR0aDogNzY4cHgpIGFuZCAobWF4LXdpZHRoOiA5OTEuOThweClcIik7XG52YXIgbWVkaWFfbGcgPSB3aW5kb3cubWF0Y2hNZWRpYShcIihtaW4td2lkdGg6IDk5MnB4KSBhbmQgKG1heC13aWR0aDogMTE5OS45OHB4KVwiKTtcbnZhciBtZWRpYV94bCA9IHdpbmRvdy5tYXRjaE1lZGlhKFwiKG1pbi13aWR0aDogMTIwMHB4KVwiKTtcblxuXG5mdW5jdGlvbiBldmVudF9tZWRpYV94bShtZWRpYSl7XG5cdGlmKG1lZGlhLm1hdGNoZXMpIHJldHVybiAkKGRvY3VtZW50KS50cmlnZ2VyKCdtZWRpYTp4bScsIFttZWRpYV0pO1xuXHRlbHNlIHJldHVybiAkKGRvY3VtZW50KS50cmlnZ2VyKCdtZWRpYTp4bTpleGl0JywgW21lZGlhXSk7XG59XG5mdW5jdGlvbiBldmVudF9tZWRpYV9zbShtZWRpYSl7XG5cdGlmKG1lZGlhLm1hdGNoZXMpIHJldHVybiAkKGRvY3VtZW50KS50cmlnZ2VyKCdtZWRpYTpzbScsIFttZWRpYV0pO1xuXHRlbHNlIHJldHVybiAkKGRvY3VtZW50KS50cmlnZ2VyKCdtZWRpYTpzbTpleGl0JywgW21lZGlhXSk7XG59XG5mdW5jdGlvbiBldmVudF9tZWRpYV9tZChtZWRpYSl7XG5cdGlmKG1lZGlhLm1hdGNoZXMpIHJldHVybiAkKGRvY3VtZW50KS50cmlnZ2VyKCdtZWRpYTptZCcsIFttZWRpYV0pO1xuXHRlbHNlIHJldHVybiAkKGRvY3VtZW50KS50cmlnZ2VyKCdtZWRpYTptZDpleGl0JywgW21lZGlhXSk7XG59XG5mdW5jdGlvbiBldmVudF9tZWRpYV9sZyhtZWRpYSl7XG5cdGlmKG1lZGlhLm1hdGNoZXMpIHJldHVybiAkKGRvY3VtZW50KS50cmlnZ2VyKCdtZWRpYTpsZycsIFttZWRpYV0pO1xuXHRlbHNlIHJldHVybiAkKGRvY3VtZW50KS50cmlnZ2VyKCdtZWRpYTpsZzpleGl0JywgW21lZGlhXSk7XG59XG5mdW5jdGlvbiBldmVudF9tZWRpYV94bChtZWRpYSl7XG5cdGlmKG1lZGlhLm1hdGNoZXMpIHJldHVybiAkKGRvY3VtZW50KS50cmlnZ2VyKCdtZWRpYTp4bCcsIFttZWRpYV0pO1xuXHRlbHNlIHJldHVybiAkKGRvY3VtZW50KS50cmlnZ2VyKCdtZWRpYTp4bDpleGl0JywgW21lZGlhXSk7XG59XG5cbiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCl7XG5cdGV2ZW50X21lZGlhX3htKG1lZGlhX3htKTtcblx0bWVkaWFfeG0uYWRkTGlzdGVuZXIoZXZlbnRfbWVkaWFfeG0pO1xuXG5cdGV2ZW50X21lZGlhX3NtKG1lZGlhX3NtKTtcblx0bWVkaWFfc20uYWRkTGlzdGVuZXIoZXZlbnRfbWVkaWFfc20pO1xuXG5cdGV2ZW50X21lZGlhX21kKG1lZGlhX21kKTtcblx0bWVkaWFfbWQuYWRkTGlzdGVuZXIoZXZlbnRfbWVkaWFfbWQpO1xuXG5cdGV2ZW50X21lZGlhX2xnKG1lZGlhX2xnKTtcblx0bWVkaWFfbGcuYWRkTGlzdGVuZXIoZXZlbnRfbWVkaWFfbGcpO1xuXG5cdGV2ZW50X21lZGlhX3hsKG1lZGlhX3hsKTtcblx0bWVkaWFfeGwuYWRkTGlzdGVuZXIoZXZlbnRfbWVkaWFfeGwpO1xufSlcbiIsIiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcblx0JC5hamF4U2V0dXAoXG5cdFx0e1xuXHRcdFx0aGVhZGVyczpcblx0XHRcdHtcblx0XHRcdFx0J1gtQ1NSRi1Ub2tlbic6ICQoJ21ldGFbbmFtZT1cImNzcmYtdG9rZW5cIl0nKS5hdHRyKCdjb250ZW50Jylcblx0XHRcdH1cblx0XHR9XG5cdCk7XG5cdCQoZG9jdW1lbnQpLnRyaWdnZXIoJ3N0YXRpbzpnbG9iYWw6cmVuZGVyUmVzcG9uc2UnLCBbJChkb2N1bWVudCldKTtcbn0pO1xuJChkb2N1bWVudCkub24oJ3N0YXRpbzpnbG9iYWw6cmVuZGVyUmVzcG9uc2UnLCBmdW5jdGlvbiAoZXZlbnQsIGJhc2UsIGNvbnRleHQpIHtcblx0YmFzZS5lYWNoKGZ1bmN0aW9uICgpIHtcblx0XHQkKCdbZGF0YS1MaWpheF0sIC5saWpheCcsIHRoaXMpLmVhY2goZnVuY3Rpb24gKCkge1xuXHRcdFx0bmV3IExpamF4KHRoaXMpO1xuXHRcdH0pO1xuXHRcdCQoXCJhXCIsIHRoaXMpLm5vdCgnLmRpcmVjdCwgW2RhdGEtZGlyZWN0XSwgW3RhcmdldD1fYmxhbmtdLCAubGlqYXgsIFtkYXRhLWxpamF4XScpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcblx0XHRcdG5ldyBTdGF0aW8oe1xuXHRcdFx0XHR1cmw6ICQodGhpcykuYXR0cignaHJlZicpLFxuXHRcdFx0XHR0eXBlOiAkKHRoaXMpLmlzKCcuYWN0aW9uJykgPyAncmVuZGVyJyA6ICdib3RoJyxcblx0XHRcdFx0Y29udGV4dDogJCh0aGlzKSxcblx0XHRcdH0pO1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH0pO1xuXG5cdFx0JCgnZm9ybVthY3Rpb25dJywgdGhpcykubm90KCcuZGlyZWN0LCBbZGF0YS1kaXJlY3RdLCBbdGFyZ2V0PV9ibGFua10sIC5saWpheCcpLmVhY2goZnVuY3Rpb24gKCkge1xuXHRcdFx0bmV3IExpamF4KHRoaXMpO1xuXHRcdH0pLm9uKCdqcmVzcCcsIGZ1bmN0aW9uIChlLCBkKSB7XG5cdFx0XHQkKCcuaXMtaW52YWxpZCcsIHRoaXMpLnJlbW92ZUNsYXNzKCdpcy1pbnZhbGlkJyk7XG5cdFx0XHQkKCcuaW52YWxpZC1mZWVkYmFjaycsIHRoaXMpLnJlbW92ZSgpO1xuXHRcdFx0aWYgKGQuZXJyb3JzKSB7XG5cdFx0XHRcdGZvciAodmFyIGlkIGluIGQuZXJyb3JzKSB7XG5cdFx0XHRcdFx0JCgnIycgKyBpZCArICcsIFtkYXRhLWFsaWFzfj0nICsgaWQgKyAnXScpLmFkZENsYXNzKCdpcy1pbnZhbGlkJyk7XG5cdFx0XHRcdFx0JCgnPGRpdiBjbGFzcz1cImludmFsaWQtZmVlZGJhY2tcIj4nICsgZC5lcnJvcnNbaWRdWzBdICsgJzwvZGl2PicpLmluc2VydEFmdGVyKCQoJyMnICsgaWQgKyAnLCBbZGF0YS1hbGlhc349JyArIGlkICsgJ10nKSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblx0XHQkKFwiLnNlbGVjdDItc2VsZWN0XCIsIHRoaXMpLmVhY2goZnVuY3Rpb24gKCkge1xuXHRcdFx0dmFyIG9wdGlvbnMgPSB7XG5cdFx0XHRcdHdpZHRoOiAnMTAwJScsXG5cdFx0XHRcdGFtZExhbmd1YWdlQmFzZTogJ2Rpc3QvdmVuZG9ycy9zZWxlY3QyLTQuMC4xMy9kaXN0L2pzL2kxOG4nLFxuXHRcdFx0XHRsYW5ndWFnZTogJ2ZhJyxcblx0XHRcdFx0bWluaW11bUlucHV0TGVuZ3RoOiAwLFxuXHRcdFx0XHRhbGxvd0NsZWFyOiAkKHRoaXMpLmlzKCdbZGF0YS1hbGxvd0NsZWFyXScpIHx8ICQodGhpcykuaXMoJy5oYXMtY2xlYXInKSxcblx0XHRcdFx0ZGlyOiBcInJ0bFwiLFxuXHRcdFx0XHR0YWdzOiAkKHRoaXMpLmlzKCcudGFnLXR5cGUnKSxcblx0XHRcdFx0ZHJvcGRvd25QYXJlbnQ6ICQoJyMnICsgJCh0aGlzKS5hdHRyKCdkYXRhLWRyb3Bkb3duUGFyZW50JykpLmxlbmd0aCA/ICQoJyMnICsgJCh0aGlzKS5hdHRyKCdkYXRhLWRyb3Bkb3duUGFyZW50JykpIDogdW5kZWZpbmVkXG5cdFx0XHR9O1xuXHRcdFx0JCh0aGlzKS5hdHRyKCdkYXRhLW1yLXZhbHVlJywgJCgnW25hbWU9JyArICQodGhpcykuYXR0cignZGF0YS1tdWx0aS1yb3VuZCcpICsgJ10nKS52YWwoKSk7XG5cdFx0XHQkKCdbbmFtZT0nICsgJCh0aGlzKS5hdHRyKCdkYXRhLW11bHRpLXJvdW5kJykgKyAnXScpLnJlbW92ZSgpO1xuXHRcdFx0aWYgKG9wdGlvbnMuYWxsb3dDbGVhcikge1xuXHRcdFx0XHRvcHRpb25zLnBsYWNlaG9sZGVyID0ge307XG5cdFx0XHRcdG9wdGlvbnMucGxhY2Vob2xkZXIudGV4dCA9ICQoJ29wdGlvbicsIHRoaXMpLmZpcnN0KCkudGV4dCgpO1xuXHRcdFx0XHRvcHRpb25zLnBsYWNlaG9sZGVyLmlkID0gJCgnb3B0aW9uJywgdGhpcykuZmlyc3QoKS5hdHRyKCd2YWx1ZScpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKCQodGhpcykuaXMoJ1tkYXRhLXVybF0nKSkge1xuXHRcdFx0XHR2YXIgdGl0bGUgPSAkKHRoaXMpLmF0dHIoJ2RhdGEtdGl0bGUnKSB8fCAndGl0bGUnO1xuXHRcdFx0XHR2YXIgX3NlbGYgPSB0aGlzO1xuXHRcdFx0XHRvcHRpb25zLmFqYXggPSB7XG5cdFx0XHRcdFx0ZGVsYXk6IDI1MCxcblx0XHRcdFx0XHR1cmw6ICQodGhpcykuYXR0cignZGF0YS11cmwnKSxcblx0XHRcdFx0XHRkYXRhVHlwZTogJ2pzb24nLFxuXHRcdFx0XHRcdHF1aWV0TWlsbGlzOiAyNTAsXG5cdFx0XHRcdFx0ZGF0YTogZnVuY3Rpb24gKHBhcmFtcykge1xuXHRcdFx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRcdFx0cTogcGFyYW1zLnRlcm0gfHwgJydcblx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRwcm9jZXNzUmVzdWx0czogZnVuY3Rpb24gKGRhdGEpIHtcblx0XHRcdFx0XHRcdGRhdGEgPSBkYXRhLmRhdGEgfHwgZGF0YTtcblx0XHRcdFx0XHRcdHZhciBpZF9wcm9wZXJ0eSA9ICQoX3NlbGYpLmF0dHIoJ2RhdGEtaWQnKSB8fCAnaWQnO1xuXHRcdFx0XHRcdFx0dmFyIHRpdGxlX3Byb3BlcnR5ID0gJChfc2VsZikuYXR0cignZGF0YS10aXRsZScpIHx8ICd0aXRsZSc7XG5cdFx0XHRcdFx0XHR2YXIgcmVzdWx0ID0geyByZXN1bHRzOiBbXSB9O1xuXHRcdFx0XHRcdFx0aWYgKCQoX3NlbGYpLmlzKCdbZGF0YS1hbGxvd0NsZWFyXScpKSB7XG5cdFx0XHRcdFx0XHRcdHJlc3VsdC5yZXN1bHRzLnB1c2goe1xuXHRcdFx0XHRcdFx0XHRcdGlkOiAnJyxcblx0XHRcdFx0XHRcdFx0XHR0ZXh0OiAnLScsXG5cdFx0XHRcdFx0XHRcdFx0YWxsOiBudWxsXG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdHZhciBzdWJfdGl0bGVfcHJvcGVydHkgPSB0aXRsZV9wcm9wZXJ0eTtcblx0XHRcdFx0XHRcdFx0aWYgKHN1Yl90aXRsZV9wcm9wZXJ0eS5pbmRleE9mKCcgJykgPj0gMCkge1xuXHRcdFx0XHRcdFx0XHRcdHZhciBzdWJfdGl0bGVfcHJvcGVydGllcyA9IHN1Yl90aXRsZV9wcm9wZXJ0eS5zcGxpdCgnICcpO1xuXHRcdFx0XHRcdFx0XHRcdGZvciAodmFyIGlzID0gMDsgaXMgPCBzdWJfdGl0bGVfcHJvcGVydGllcy5sZW5ndGg7IGlzKyspIHtcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChkYXRhW2ldW3N1Yl90aXRsZV9wcm9wZXJ0aWVzW2lzXV0pIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0c3ViX3RpdGxlX3Byb3BlcnR5ID0gc3ViX3RpdGxlX3Byb3BlcnRpZXNbaXNdO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRyZXN1bHQucmVzdWx0cy5wdXNoKHtcblx0XHRcdFx0XHRcdFx0XHRpZDogZGF0YVtpXVtpZF9wcm9wZXJ0eV0sXG5cdFx0XHRcdFx0XHRcdFx0dGV4dDogZGF0YVtpXVtzdWJfdGl0bGVfcHJvcGVydHldLFxuXHRcdFx0XHRcdFx0XHRcdGFsbDogZGF0YVtpXVxuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdHJldHVybiByZXN1bHQ7XG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRjYWNoZTogZmFsc2Vcblx0XHRcdFx0fTtcblx0XHRcdH1cblx0XHRcdCQodGhpcykuc2VsZWN0MihvcHRpb25zKTtcblx0XHR9KTtcblx0fSk7XG59KTsiLCJmdW5jdGlvbiByZXNwb25zaXZlX21lbnUoKSB7XG4gICAgJCgnI21lbnUnKS5yZW1vdmVDbGFzcygnZC1ub25lJykuYWRkQ2xhc3MoJ2QtZmxleCcpO1xuICAgIC8vICQoJyNkZXNrdG9wJykucmVtb3ZlQ2xhc3MoJ2Qtbm9uZScpO1xuICAgICQoJ2JvZHknKS5hZGRDbGFzcygncmVzcG9uc2l2ZS1tZW51Jyk7XG4gICAgJCgnI2J0bi1tZW51JykuZmluZCgkKFwiLmZhc1wiKSkucmVtb3ZlQ2xhc3MoJ2ZhLWJhcnMnKS5hZGRDbGFzcygnZmEtYXJyb3ctcmlnaHQnKTtcbiAgICAkKHRoaXMpLm9mZignY2xpY2sucmVzcG9uc2l2ZS1tZW51Jyk7XG4gICAgJCh0aGlzKS5vbignY2xpY2suY2xvc2UtcmVzcG9uc2l2ZS1tZW51JywgZnVuY3Rpb24oKSB7XG4gICAgICAgICQodGhpcykub2ZmKCdjbGljay5jbG9zZS1yZXNwb25zaXZlLW1lbnUnKTtcbiAgICAgICAgJCh0aGlzKS5vbignY2xpY2sucmVzcG9uc2l2ZS1tZW51JywgcmVzcG9uc2l2ZV9tZW51KTtcbiAgICAgICAgJCgnI21lbnUnKS5hZGRDbGFzcygnZC1ub25lJykucmVtb3ZlQ2xhc3MoJ2QtZmxleCcpO1xuICAgICAgICAvLyAkKCcjZGVza3RvcCcpLmFkZENsYXNzKCdkLW5vbmUnKTtcbiAgICAgICAgJCgnYm9keScpLnJlbW92ZUNsYXNzKCdyZXNwb25zaXZlLW1lbnUnKTtcbiAgICAgICAgJCgnI2J0bi1tZW51JykuZmluZCgkKFwiLmZhc1wiKSkucmVtb3ZlQ2xhc3MoJ2ZhLWFycm93LXJpZ2h0JykuYWRkQ2xhc3MoJ2ZhLWJhcnMnKTtcbiAgICB9KTtcbn1cblxuJChkb2N1bWVudCkub24oJ21lZGlhOnhtIG1lZGlhOnNtJywgZnVuY3Rpb24oZXZlbnQsIG1lZGlhKSB7XG4gICAgJChcImJvZHk6bm90KC5yZXNwb25zaXZlLW1lbnUpICNidG4tbWVudVwiKS5vbignY2xpY2sucmVzcG9uc2l2ZS1tZW51JywgcmVzcG9uc2l2ZV9tZW51KTtcblxuICAgIHZhciBtZW51ID0gJCgnI21lbnUnKTtcbiAgICB2YXIgZGVza3RvcCA9ICQoJyNkZXNrdG9wJyk7XG4gICAgdmFyIGJ0bl9tZW51ID0gJCgnI2J0bi1tZW51Jyk7XG4gICAgJChkb2N1bWVudCkubW91c2V1cChmdW5jdGlvbihlKSB7XG4gICAgICAgIGlmIChcbiAgICAgICAgICAgICghbWVudS5pcyhlLnRhcmdldCkgJiYgbWVudS5oYXMoZS50YXJnZXQpLmxlbmd0aCA9PT0gMClcbiAgICAgICAgICAgICYmICghZGVza3RvcC5pcyhlLnRhcmdldCkgJiYgZGVza3RvcC5oYXMoZS50YXJnZXQpLmxlbmd0aCA9PT0gMClcbiAgICAgICAgICAgICYmICghYnRuX21lbnUuaXMoZS50YXJnZXQpICYmIGJ0bl9tZW51LmhhcyhlLnRhcmdldCkubGVuZ3RoID09PSAwKVxuICAgICAgICAgICAgKVxuICAgICAgICB7XG4gICAgICAgICAgICAkKFwiYm9keS5yZXNwb25zaXZlLW1lbnUgI2J0bi1tZW51XCIpLnRyaWdnZXIoJ2NsaWNrLmNsb3NlLXJlc3BvbnNpdmUtbWVudScpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyAkKFwiYm9keVwiKS5zd2lwZSh7XG4gICAgLy8gICAgIHN3aXBlOiBmdW5jdGlvbihldmVudCwgZGlyZWN0aW9uLCBkaXN0YW5jZSwgZHVyYXRpb24sIGZpbmdlckNvdW50LCBmaW5nZXJEYXRhKSB7XG4gICAgLy8gICAgICAgICBpZiAoZGlyZWN0aW9uID09ICdsZWZ0Jykge1xuICAgIC8vICAgICAgICAgICAgICQoXCJib2R5Om5vdCgucmVzcG9uc2l2ZS1tZW51KSAjYnRuLW1lbnVcIikudHJpZ2dlcignY2xpY2sucmVzcG9uc2l2ZS1tZW51Jyk7XG4gICAgLy8gICAgICAgICB9XG5cbiAgICAvLyAgICAgICAgIGlmIChkaXJlY3Rpb24gPT0gJ3JpZ2h0Jykge1xuICAgIC8vICAgICAgICAgICAgICQoXCJib2R5LnJlc3BvbnNpdmUtbWVudSAjYnRuLW1lbnVcIikudHJpZ2dlcignY2xpY2suY2xvc2UtcmVzcG9uc2l2ZS1tZW51Jyk7XG4gICAgLy8gICAgICAgICB9XG5cbiAgICAvLyAgICAgICAgIGlmIChkaXJlY3Rpb24gPT0gJ3VwJyB8fCBkaXJlY3Rpb24gPT0gJ2Rvd24nKSB7XG4gICAgLy8gICAgICAgICAgICAgaWYgKCFtZW51LmlzKGV2ZW50LnRhcmdldCkgJiYgbWVudS5oYXMoZXZlbnQudGFyZ2V0KS5sZW5ndGggPT09IDApIHtcbiAgICAvLyAgICAgICAgICAgICAgICAgJChcImJvZHkucmVzcG9uc2l2ZS1tZW51ICNidG4tbWVudVwiKS50cmlnZ2VyKCdjbGljay5jbG9zZS1yZXNwb25zaXZlLW1lbnUnKTtcbiAgICAvLyAgICAgICAgICAgICB9XG4gICAgLy8gICAgICAgICB9XG4gICAgLy8gICAgIH1cbiAgICAvLyB9KTtcbn0pO1xuXG4kKGRvY3VtZW50KS5vbignbWVkaWE6bWQgbWVkaWE6bGcgbWVkaWE6eGwnLCBmdW5jdGlvbihldmVudCwgbWVkaWEpIHtcbiAgICAkKFwiYm9keS5yZXNwb25zaXZlLW1lbnUgI2J0bi1tZW51XCIpLnRyaWdnZXIoJ2NsaWNrLmNsb3NlLXJlc3BvbnNpdmUtbWVudScpO1xuICAgICQoXCIjYnRuLW1lbnVcIikub2ZmKCdjbGljay5yZXNwb25zaXZlLW1lbnUnKTtcbiAgICAvLyAkKFwiI2J0bi1tZW51XCIpLm9mZignY2xpY2suY2xvc2UtcmVzcG9uc2l2ZS1tZW51Jyk7XG4gICAgLy8gJCgnI21lbnUnKS5hZGRDbGFzcygnZC1ub25lJykucmVtb3ZlQ2xhc3MoJ2QtZmxleCcpO1xuICAgIC8vICQoJyNkZXNrdG9wJykuYWRkQ2xhc3MoJ2Qtbm9uZScpO1xuICAgIC8vICQoJ2JvZHknKS5yZW1vdmVDbGFzcygncmVzcG9uc2l2ZS1tZW51Jyk7XG4gICAgLy8gJCgnI2J0bi1tZW51JykuZmluZCgkKFwiLmZhc1wiKSkucmVtb3ZlQ2xhc3MoJ2ZhLWFycm93LXJpZ2h0JykuYWRkQ2xhc3MoJ2ZhLWJhcnMnKTtcbn0pOyIsIihmdW5jdGlvbiAoKSB7XG5cdGZ1bmN0aW9uIFZpd0ZpbGUoKVxuXHR7XG5cdFx0JCgnLmN1c3RvbS1maWxlLWlucHV0JywgdGhpcykub24oJ2NoYW5nZScsIGZ1bmN0aW9uKCl7XG5cdFx0XHRpZiAoIXdpbmRvdy5GaWxlICYmICF3aW5kb3cuRmlsZVJlYWRlciAmJiAhd2luZG93LkZpbGVMaXN0ICYmICF3aW5kb3cuQmxvYikge1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKCdGaWxlUmVhZGVyIHVuc3VwcG9ydGVkIScpO1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0XHR2YXIgZmlsZV9pbmRleCA9IDA7XG5cdFx0XHR2YXIgZmlsZTtcblx0XHRcdCQodGhpcykubmV4dCgpLmh0bWwoJycpO1xuXHRcdFx0dmFyIGZpbGVzID0gW107XG5cdFx0XHR3aGlsZSAoZmlsZSA9IHRoaXMuZmlsZXMuaXRlbShmaWxlX2luZGV4KyspKVxuXHRcdFx0e1xuXHRcdFx0XHRmaWxlcy5wdXNoKGZpbGUubmFtZSk7XG5cdFx0XHR9XG5cdFx0XHQkKHRoaXMpLm5leHQoKS5odG1sKGZpbGVzLmpvaW4oJyA6ICcpKTtcblx0XHR9KTtcblx0fVxuXHQkKGRvY3VtZW50KS5vbignc3RhdGlvOmdsb2JhbDpyZW5kZXJSZXNwb25zZScsIGZ1bmN0aW9uIChldmVudCwgYmFzZSwgY29udGV4KSB7XG5cdFx0YmFzZS5lYWNoKGZ1bmN0aW9uICgpIHtcblx0XHRcdFZpd0ZpbGUuY2FsbCh0aGlzKTtcblx0XHR9KTtcblx0fSk7XG5cdFZpd0ZpbGUuY2FsbChkb2N1bWVudCk7XG59KSgpOyJdfQ==