(function(){
	function jresp(context, res)
	{
		context.trigger('jresp', [res]);
		if (res.message && !context.is('.d-notification'))
		{
			if (window.toastr)
			{
				var toast = toastr[res.is_ok ? 'success' : 'error'](res.message_text || res.message, undefined, {
					"closeButton": true,
					"newestOnTop": true,
					"positionClass": "toast-bottom-right",
				});
			}
			else if (window.iziToast)
			{
				iziToast[res.is_ok ? 'success' : 'error']({ message: res.message_text || res.message});
			}
		}
		if(res.redirect)
		{
			if(res.direct)
			{
				location.href = res.redirect;
			}
			else
			{
				new Statio({
					url : res.redirect
				});
			}
		}
	}
	window.JResp = jresp;
})();
(function(){
	function lijax(context, onFire)
	{
        var back_value = $(context).val() || $(context).attr('data-value');
        if($(context).is(':checkbox'))
        {
            back_value = $(context).is(':checked') ? 1 : 0;
        }
        var Timeout = null;
        var fire = null;
        if($(context).is('form') && !$(context).attr('data-lijax'))
        {
            fire = ['submit'];
        }
        else
        {
            fire = $(context).attr('data-lijax').split(' ') || ['change'];
        }
        for (var i = 0; i < fire.length; i++) {
            if(/^\d+$/.test(fire[i]))
            {
                var Time = fire[i];
                $(context).on('keyup', function(){
                    if(Timeout) clearTimeout(Timeout);
                    Timeout = setTimeout(send, Time);
                });
            }
            else
            {
                $(context).on(fire[i], send);
            }
        }

        function send()
        {
            var href = url.parse(location.href);
            var name = $(context).attr('name') || $(context).attr('data-name');
            if(href.get && href.get[name])
            {
                delete href.get[name];
            }
            var get = url.buildget(href.get);
            href = href.url.replace(/\?(.*)$/, get ? '?' + get : '');
            var action = $(context).attr('href') || $(context).attr('action') || $(context).attr('data-action') || href;
            var method = $(context).attr('data-method') || $(context).attr('method') || 'GET';
            var state = $(context).attr('data-state');
            var value = undefined;
            if($(context).is('form'))
            {
                var Data = new FormData(context);
                var data = {};
				if ($(context).attr('enctype') == 'multipart/form-data' || $('input:file', context).length)
                {
                    data = Data;
                }
                else
                {
                    Data.forEach(function (value, name) {
                        data[name] = /\[.*\]$/.test(name) ? Data.getAll(name) : Data.get(name);
                    });
                }
                state = false;
                $(context).addClass('lijax-sending');
                $('input, select, textarea, button', context).not(':disabled').addClass('lijax-disable').attr('disabled', 'disabled');
                $(context).on('statio:done', function () {
                    $('.lijax-disable', this).removeClass('lijax-disable').removeAttr('disabled')
                    $(this).removeClass('lijax-sending');
                });
            }
            else
            {
                value = $(context).val() || $(context).attr('data-value') || null;
                if($(context).is(':checkbox'))
                {
                    value = $(context).is(':checked') ? 1 : 0;
                }
                if(back_value == value && $(context).is('input, textarea, select') && !onFire) return;
                back_value = value;
                var data = {};
                data[name] = value;
            }
            if ($(context).attr('data-query'))
            {
                var action_query = url.parse(action);
                var data_query = url.parse('?' + $(context).attr('data-query'));
                action_query.get = $.extend(null, (action_query.get || {}), data_query.get);
                action = url.build(action_query);
            }
            var headers = {};
            if ($(context).attr('data-xhrBase'))
            {
                headers = {
                    'Data-xhr-base': $(context).attr('data-xhrBase')
                };
            }
            new Statio({
                type : state ? 'both' : 'render',
                context: context,
                ajax : {
					contentType: $(context).is('form') && ($(context).attr('enctype') == 'multipart/form-data' || $('input:file', context).length) ? false : 'application/x-www-form-urlencoded; charset=UTF-8',
					processData: ($(context).is('form') && ($(context).attr('enctype') == 'multipart/form-data' || $('input:file', context).length)) ? false : true,
                    cache       : false,
                    method : method,
                    data : data,
                    headers: headers
                },
                url : action
            });
            return false;
        }
        if (onFire)
        {
            send();
        }
    }
    window.Lijax = lijax;
})();
(function(){
	var _globals = {
		title : function (value){
			$('title').html(value);
		}
	}

	var _ajax = {
		type : 'GET',
		cache : false
	}

	var _options = {
		object : null,
		title : null,
		ajax : _ajax,
	/**
	 * Send request and change url with response rendering
	 * @default both
	 * both: change url and render response
	 * url: Only send request and chage url without change rendering
	 * render: Only send request and render repsonse without change url
	 * @type {String}
	 */
	 type : 'both',
	/**
	 * dont send any request
	 * @type {Boolean}
	 */
	 fake : false,
	/**
	 * ajax response contetnt
	 * if {fake:true} or {response : notnull} response render this property
	 * @type {[type]}
	 */
	 response : null,
	/**
	 * replace state
	 * @type {Boolean}
	 */
	 replace : false,
	/**
	 * event context
	 * @type {DOM} {jQuery} {Selector string}
	 */
	 context : document
	}

	function statio(custom){
		if(typeof custom != 'object')
		{
			custom = {};
		}

		custom.ajax = $.extend({}, _ajax, custom.ajax);
		custom.ajax.url = custom.url;
		custom.globals = $.extend({}, _globals, custom.globals);
		var options = $.extend({}, _options, custom);

		var response = {
			body : options.response,
			data : {},
		};

		if(!(options.context instanceof jQuery))
		{
			options.context = $(options.context);
		}

		$(document).trigger('statio:global:init', [options.context]);
		options.context.trigger('statio:init');


		var ajax_data = null;
		var ajax_send_url = null;
		if(!options.fake)
		{
			if(!options.ajax.complete)
			{
				options.ajax.complete = ajx_complete;
			}
			var beforeSend = options.ajax.beforeSend;
			options.ajax.beforeSend = function(jqXHR, settings)
			{
				ajax_data = this;
				ajax_send_url = this.url;
				var urlx = url.parse(ajax_send_url);
				if(urlx.get && urlx.get._)
				{
					delete urlx.get._;
				}
            	var get = url.buildget(urlx.get);
            	ajax_send_url = urlx.url.replace(/\?(.*)$/, get ? '?' + get : '');
				beforeSend ? beforeSend.call(this, jqXHR, settings) : null;
			}
			$.ajax(options.ajax);
		}
		else if(options.type != 'url' && response.body)
		{
			response_parse();
			render();
			$(document).trigger('statio:global:done', [options.context]);
			options.context.trigger('statio:done');
		}
		else
		{
			try {
				options.replace
					? history.replaceState(JSON.parse(JSON.stringify(options)), options.title, ajax_send_url || options.url)
					: history.pushState(JSON.parse(JSON.stringify(options)), options.title, ajax_send_url || options.url);
			}
			catch (e) {
				console.error(e);
			}
			$(document).trigger('statio:global:done', [options.context]);
			options.context.trigger('statio:done');
		}

		function ajx_complete(jqXHR, textStatus)
		{
			if(jqXHR.responseJSON)
			{
				response.data = jqXHR.responseJSON;
				$(document).trigger('statio:global:jsonResponse', [options.context, jqXHR.responseJSON, jqXHR]);
				options.context.trigger('statio:jsonResponse', [jqXHR.responseJSON, jqXHR]);
				new JResp(options.context, response.data);
			}
			else
			{
				response.body = jqXHR.responseText;
				response_parse();
				if(textStatus == 'success')
				{
					if (options.type != 'render') {
						try {
							options.response = response;
							options.replace
								? history.replaceState(JSON.parse(JSON.stringify(options)), options.title, ajax_send_url || options.url)
								: history.pushState(JSON.parse(JSON.stringify(options)), options.title, ajax_send_url || options.url);
						}
						catch (e) {
							try{
								options.replace
									? history.replaceState(options.data, options.title, ajax_send_url || options.url)
									: history.pushState(options.data, options.title, ajax_send_url || options.url);

							}
							catch (e){
								console.error(e);
							}
						}
					}
					$(document).trigger('statio:global:success', [options.context, response.data, response.body, jqXHR]);
					options.context.trigger('statio:success', [response.data, response.body, jqXHR]);
					if(options.type != 'url')
					{
						render();
					}
				}
				else
				{
					$(document).trigger('statio:global:errorResponse', [options.context, response.data, response.body, jqXHR]);
					options.context.trigger('statio:errorResponse', [response.data, response.body, jqXHR]);
				}
			}
			$(document).trigger('statio:global:done', [options.context, response.data, response.body, jqXHR]);
			options.context.trigger('statio:done', [response.data, response.body, jqXHR]);
		}

		function response_parse(){
			if(typeof response.body == 'string')
			{
				try
				{
					var split     = response.body.split("\n");
					response.data = JSON.parse(split[0]);
					response.body = split.length > 1 ? $($.parseHTML(split.splice(1).join(""))) : null;
				}catch(e){
					response.body  = $($.parseHTML(response.body));
				}
			}
			else if(typeof response.body == 'object' && response.body != null)
			{
				if(response.body instanceof HTMLElement)
				{
					response.body  = $(response.body);
				}
				else if(response.body instanceof jQuery)
				{

				}
				else
				{
					response.data = response.body;
					response.body = null;
				}
			}
		}

		function render(){
			for(D in response.data)
			{
				if(options.globals[D])
				{
					options.globals[D](response.data[D]);
				}
			}
			if(response.body)
			{
				var changed = [];
				response.body.each(function(){
					var base = $(this).attr('data-xhr');
					if(base)
					{
						changed.push($("[data-xhr='"+base+"']"));
						$("[data-xhr='"+base+"']").html($(this).html());
					}
				});
				$(document).trigger('statio:global:renderResponse', [$(changed), options.context, response.data, response.body]);
				options.context.trigger('statio:renderResponse', [$(changed), response.data, response.body]);
			}
		}
		return this;
	}
	window.Statio = statio;
	/**
	 * for new chrome bug
	 */
	 new Statio({
	 	url : location.href,
	 	fake : true,
	 	replace : true
	 });

	/**
	 * popstate event
	 */
	 window.onpopstate = function(event){
	 	new Statio({
	 		url : location.href,
	 		replace : true
	 	});
	 };
})();

// Copyright 2013-2014 Kevin Cox

/*******************************************************************************
*                                                                              *
*  This software is provided 'as-is', without any express or implied           *
*  warranty. In no event will the authors be held liable for any damages       *
*  arising from the use of this software.                                      *
*                                                                              *
*  Permission is granted to anyone to use this software for any purpose,       *
*  including commercial applications, and to alter it and redistribute it      *
*  freely, subject to the following restrictions:                              *
*                                                                              *
*  1. The origin of this software must not be misrepresented; you must not     *
*     claim that you wrote the original software. If you use this software in  *
*     a product, an acknowledgment in the product documentation would be       *
*     appreciated but is not required.                                         *
*                                                                              *
*  2. Altered source versions must be plainly marked as such, and must not be  *
*     misrepresented as being the original software.                           *
*                                                                              *
*  3. This notice may not be removed or altered from any source distribution.  *
*                                                                              *
*******************************************************************************/

+function(){
"use strict";

var array = /\[([^\[]*)\]$/;

/// URL Regex.
/**
 * This regex splits the URL into parts.  The capture groups catch the important
 * bits.
 *
 * Each section is optional, so to work on any part find the correct top level
 * `(...)?` and mess around with it.
 */
var regex = /^(?:([a-z]*):)?(?:\/\/)?(?:([^:@]*)(?::([^@]*))?@)?([0-9a-z-._]+)?(?::([0-9]*))?(\/[^?#]*)?(?:\?([^#]*))?(?:#(.*))?$/i;
//               1 - scheme              2 - user    3 = pass    4 - host           5 - port  6 - path        7 - query    8 - hash

var noslash = ["mailto","bitcoin"];

var self = {
	/** Parse a query string.
	 *
	 * This function parses a query string (sometimes called the search
	 * string).  It takes a query string and returns a map of the results.
	 *
	 * Keys are considered to be everything up to the first '=' and values are
	 * everything afterwords.  Since URL-decoding is done after parsing, keys
	 * and values can have any values, however, '=' have to be encoded in keys
	 * while '?' and '&' have to be encoded anywhere (as they delimit the
	 * kv-pairs).
	 *
	 * Keys and values will always be strings, except if there is a key with no
	 * '=' in which case it will be considered a flag and will be set to true.
	 * Later values will override earlier values.
	 *
	 * Array keys are also supported.  By default keys in the form of `name[i]`
	 * will be returned like that as strings.  However, if you set the `array`
	 * flag in the options object they will be parsed into arrays.  Note that
	 * although the object returned is an `Array` object all keys will be
	 * written to it.  This means that if you have a key such as `k[forEach]`
	 * it will overwrite the `forEach` function on that array.  Also note that
	 * string properties always take precedence over array properties,
	 * irrespective of where they are in the query string.
	 *
	 *   url.get("array[1]=test&array[foo]=bar",{array:true}).array[1]  === "test"
	 *   url.get("array[1]=test&array[foo]=bar",{array:true}).array.foo === "bar"
	 *   url.get("array=notanarray&array[0]=1",{array:true}).array      === "notanarray"
	 *
	 * If array parsing is enabled keys in the form of `name[]` will
	 * automatically be given the next available index.  Note that this can be
	 * overwritten with later values in the query string.  For this reason is
	 * is best not to mix the two formats, although it is safe (and often
	 * useful) to add an automatic index argument to the end of a query string.
	 *
	 *   url.get("a[]=0&a[]=1&a[0]=2", {array:true})  -> {a:["2","1"]};
	 *   url.get("a[0]=0&a[1]=1&a[]=2", {array:true}) -> {a:["0","1","2"]};
	 *
	 * @param{string} q The query string (the part after the '?').
	 * @param{{full:boolean,array:boolean}=} opt Options.
	 *
	 * - full: If set `q` will be treated as a full url and `q` will be built.
	 *   by calling #parse to retrieve the query portion.
	 * - array: If set keys in the form of `key[i]` will be treated
	 *   as arrays/maps.
	 *
	 * @return{!Object.<string, string|Array>} The parsed result.
	 */
	"get": function(q, opt){
		q = q || "";
		if ( typeof opt          == "undefined" ) opt = {};
		if ( typeof opt["full"]  == "undefined" ) opt["full"] = false;
		if ( typeof opt["array"] == "undefined" ) opt["array"] = false;

		if ( opt["full"] === true )
		{
			q = self["parse"](q, {"get":false})["query"] || "";
		}

		var o = {};

		var c = q.split("&");
		for (var i = 0; i < c.length; i++)
		{
			if (!c[i].length) continue;

			var d = c[i].indexOf("=");
			var k = c[i], v = true;
			if ( d >= 0 )
			{
				k = c[i].substr(0, d);
				v = c[i].substr(d+1);

				v = decodeURIComponent(v);
			}

			if (opt["array"])
			{
				var inds = [];
				var ind;
				var curo = o;
				var curk = k;
				while (ind = curk.match(array)) // Array!
				{
					curk = curk.substr(0, ind.index);
					inds.unshift(decodeURIComponent(ind[1]));
				}
				curk = decodeURIComponent(curk);
				if (inds.some(function(i)
				{
					if ( typeof curo[curk] == "undefined" ) curo[curk] = [];
					if (!Array.isArray(curo[curk]))
					{
						//console.log("url.get: Array property "+curk+" already exists as string!");
						return true;
					}

					curo = curo[curk];

					if ( i === "" ) i = curo.length;

					curk = i;
				})) continue;
				curo[curk] = v;
				continue;
			}

			k = decodeURIComponent(k);

			//typeof o[k] == "undefined" || console.log("Property "+k+" already exists!");
			o[k] = v;
		}

		return o;
	},

	/** Build a get query from an object.
	 *
	 * This constructs a query string from the kv pairs in `data`.  Calling
	 * #get on the string returned should return an object identical to the one
	 * passed in except all non-boolean scalar types become strings and all
	 * object types become arrays (non-integer keys are still present, see
	 * #get's documentation for more details).
	 *
	 * This always uses array syntax for describing arrays.  If you want to
	 * serialize them differently (like having the value be a JSON array and
	 * have a plain key) you will need to do that before passing it in.
	 *
	 * All keys and values are supported (binary data anyone?) as they are
	 * properly URL-encoded and #get properly decodes.
	 *
	 * @param{Object} data The kv pairs.
	 * @param{string} prefix The properly encoded array key to put the
	 *   properties.  Mainly intended for internal use.
	 * @return{string} A URL-safe string.
	 */
	"buildget": function(data, prefix){
		var itms = [];
		for ( var k in data )
		{
			var ek = encodeURIComponent(k);
			if ( typeof prefix != "undefined" )
				ek = prefix+"["+ek+"]";

			var v = data[k];

			switch (typeof v)
			{
				case 'boolean':
					if(v) itms.push(ek);
					break;
				case 'number':
					v = v.toString();
				case 'string':
					itms.push(ek+"="+encodeURIComponent(v));
					break;
				case 'object':
					itms.push(self["buildget"](v, ek));
					break;
			}
		}
		return itms.join("&");
	},

	/** Parse a URL
	 *
	 * This breaks up a URL into components.  It attempts to be very liberal
	 * and returns the best result in most cases.  This means that you can
	 * often pass in part of a URL and get correct categories back.  Notably,
	 * this works for emails and Jabber IDs, as well as adding a '?' to the
	 * beginning of a string will parse the whole thing as a query string.  If
	 * an item is not found the property will be undefined.  In some cases an
	 * empty string will be returned if the surrounding syntax but the actual
	 * value is empty (example: "://example.com" will give a empty string for
	 * scheme.)  Notably the host name will always be set to something.
	 *
	 * Returned properties.
	 *
	 * - **scheme:** The url scheme. (ex: "mailto" or "https")
	 * - **user:** The username.
	 * - **pass:** The password.
	 * - **host:** The hostname. (ex: "localhost", "123.456.7.8" or "example.com")
	 * - **port:** The port, as a number. (ex: 1337)
	 * - **path:** The path. (ex: "/" or "/about.html")
	 * - **query:** "The query string. (ex: "foo=bar&v=17&format=json")
	 * - **get:** The query string parsed with get.  If `opt.get` is `false` this
	 *   will be absent
	 * - **hash:** The value after the hash. (ex: "myanchor")
	 *   be undefined even if `query` is set.
	 *
	 * @param{string} url The URL to parse.
	 * @param{{get:Object}=} opt Options:
	 *
	 * - get: An options argument to be passed to #get or false to not call #get.
	 *    **DO NOT** set `full`.
	 *
	 * @return{!Object} An object with the parsed values.
	 */
	"parse": function(url, opt) {

		if ( typeof opt == "undefined" ) opt = {};

		var md = url.match(regex) || [];

		var r = {
			"url":    url,

			"scheme": md[1],
			"user":   md[2],
			"pass":   md[3],
			"host":   md[4],
			"port":   md[5] && +md[5],
			"path":   md[6],
			"query":  md[7],
			"hash":   md[8],
		};

		if ( opt.get !== false )
			r["get"] = r["query"] && self["get"](r["query"], opt.get);

		return r;
	},

	/** Build a URL from components.
	 *
	 * This pieces together a url from the properties of the passed in object.
	 * In general passing the result of `parse()` should return the URL.  There
	 * may differences in the get string as the keys and values might be more
	 * encoded then they were originally were.  However, calling `get()` on the
	 * two values should yield the same result.
	 *
	 * Here is how the parameters are used.
	 *
	 *  - url: Used only if no other values are provided.  If that is the case
	 *     `url` will be returned verbatim.
	 *  - scheme: Used if defined.
	 *  - user: Used if defined.
	 *  - pass: Used if defined.
	 *  - host: Used if defined.
	 *  - path: Used if defined.
	 *  - query: Used only if `get` is not provided and non-empty.
	 *  - get: Used if non-empty.  Passed to #buildget and the result is used
	 *    as the query string.
	 *  - hash: Used if defined.
	 *
	 * These are the options that are valid on the options object.
	 *
	 *  - useemptyget: If truthy, a question mark will be appended for empty get
	 *    strings.  This notably makes `build()` and `parse()` fully symmetric.
	 *
	 * @param{Object} data The pieces of the URL.
	 * @param{Object} opt Options for building the url.
	 * @return{string} The URL.
	 */
	"build": function(data, opt){
		opt = opt || {};

		var r = "";

		if ( typeof data["scheme"] != "undefined" )
		{
			r += data["scheme"];
			r += (noslash.indexOf(data["scheme"])>=0)?":":"://";
		}
		if ( typeof data["user"] != "undefined" )
		{
			r += data["user"];
			if ( typeof data["pass"] == "undefined" )
			{
				r += "@";
			}
		}
		if ( typeof data["pass"] != "undefined" ) r += ":" + data["pass"] + "@";
		if ( typeof data["host"] != "undefined" ) r += data["host"];
		if ( typeof data["port"] != "undefined" ) r += ":" + data["port"];
		if ( typeof data["path"] != "undefined" ) r += data["path"];

		if (opt["useemptyget"])
		{
			if      ( typeof data["get"]   != "undefined" ) r += "?" + self["buildget"](data["get"]);
			else if ( typeof data["query"] != "undefined" ) r += "?" + data["query"];
		}
		else
		{
			// If .get use it.  If .get leads to empty, use .query.
			var q = data["get"] && self["buildget"](data["get"]) || data["query"];
			if (q) r += "?" + q;
		}

		if ( typeof data["hash"] != "undefined" ) r += "#" + data["hash"];

		return r || data["url"] || "";
	},
};

if ( typeof define != "undefined" && define["amd"] ) define(self);
else if ( typeof module != "undefined" ) module['exports'] = self;
else window["url"] = self;

}();
const aside = document.querySelector('#aside');
const asideBtn = document.querySelector('#aside-btn');
function handleAside(event) {
    aside.classList.add('open');
}
if (asideBtn)
{
    asideBtn.addEventListener('click', handleAside);
}

const profile = document.querySelector('.profile');

if (profile)
{
    const dropdown = document.querySelector('.profile-dropdown');

    function handleProfileClick(event) {
        dropdown.classList.add('open');
    }
    profile.addEventListener('click', handleProfileClick);
    window.addEventListener('click', function(event) {
        if (!event.target.closest('.profile-div')) {
            dropdown.classList.remove('open');
        }
        if (!event.target.closest('#aside') && !event.target.closest('#aside-btn')) {
            aside.classList.remove('open');
        }
    });
}


am4core.ready(function () {

    // Themes begin
    am4core.useTheme(am4themes_amcharts);
    // Themes end

    // Create chart instance
    var chart = am4core.create("chartdiv", am4charts.XYChart);

    chart.rtl = true;

    // Add data
    chart.data = [{
        "country": "USA",
        "visits": 2025
    }, {
        "country": "China",
        "visits": 1882
    }, {
        "country": "Japan",
        "visits": 1809
    }, {
        "country": "Germany",
        "visits": 1322
    }, {
        "country": "UK",
        "visits": 1122
    }, {
        "country": "France",
        "visits": 1114
    }, {
        "country": "India",
        "visits": 984
    }, {
        "country": "Spain",
        "visits": 711
    }, {
        "country": "Netherlands",
        "visits": 665
    }, {
        "country": "Russia",
        "visits": 580
    }, {
        "country": "South Korea",
        "visits": 443
    }, {
        "country": "Canada",
        "visits": 441
    }, {
        "country": "Brazil",
        "visits": 395
    }];

    // Create axes

    var categoryAxis = chart.xAxes.push(new am4charts.CategoryAxis());
    categoryAxis.dataFields.category = "country";
    categoryAxis.renderer.grid.template.location = 0;
    categoryAxis.renderer.minGridDistance = 30;

    categoryAxis.renderer.labels.template.adapter.add("dy", function (dy, target) {
        if (target.dataItem && target.dataItem.index & 2 == 2) {
            return dy + 25;
        }
        return dy;
    });

    var valueAxis = chart.yAxes.push(new am4charts.ValueAxis());

    // Create series
    var series = chart.series.push(new am4charts.ColumnSeries());
    series.dataFields.valueY = "visits";
    series.dataFields.categoryX = "country";
    series.name = "Visits";
    series.columns.template.tooltipText = "{categoryX}: [bold]{valueY}[/]";
    series.columns.template.fillOpacity = .8;

    var columnTemplate = series.columns.template;
    columnTemplate.strokeWidth = 2;
    columnTemplate.strokeOpacity = 1;

}); // end am4core.ready()

$(document).ready(function() {
    $('.select2').select2();
});

function readURL(input) {
    if (input.files && input.files[0]) {
        var reader = new FileReader();

        reader.onload = function(e) {
            $(input).next('label').children('img').attr('src', e.target.result);
        }

        reader.readAsDataURL(input.files[0]);
    }
  }

$('.input-avatar').change(function() {
    readURL(this);
});

var datepicker = function (elementID, opt) {

    // check arguments
    if (typeof elementID !== "string" || elementID.length === 0) {
        console.error("datepicker error: input ID is not string or is empty");
        return;
    }
    var options = opt || {};

    // variables
    var isCalClicked = false;
    var isSynced = false;

    var dayOfWeek;

    var selectedYear;
    var selectedMonth;
    var selectedDay;

    var currentYear;
    var currentMonth;
    var currentDay;

    var todaysYear;
    var todaysMonth;
    var todaysDay;

    var dayOfWeekJ;

    var numberOfDays;

    var todayG;
    var todaysJ;

    // consts
    var MONTH_NAMES = {
        "1": "فروردین"
        , "2": "اردیبهشت"
        , "3": "خرداد"
        , "4": "تیر"
        , "5": "مرداد"
        , "6": "شهریور"
        , "7": "مهر"
        , "8": "آبان"
        , "9": "آذر"
        , "10": "دی"
        , "11": "بهمن"
        , "12": "اسفند"
    }
    var DAY_NAMES = {
        "شنبه": "ش"
        , "یکشنبه": "ی"
        , "دوشنبه": "د"
        , "سه شنبه": "س"
        , "چهارشنبه": "چ"
        , "پنج شنبه": "پ"
        , "جمعه": "ج"
    };
    var FA_NUMS = ['٠', '١', '٢', '٣', '۴', '۵', '۶', '٧', '٨', '٩', '١٠', '١١', '١٢', '١٣', '١۴', '١۵', '١۶', '١٧', '١٨', '١٩', '٢٠', '٢١', '٢٢', '٢٣', '٢۴', '٢۵', '٢۶', '٢٧', '٢٨', '٢٩', '٣٠', '٣١', '٣٢'];

    // set options
    options.placeholder = options.placeholder !== undefined ? options.placeholder : "";
    options.twodigit = options.twodigit !== undefined ? options.twodigit : true;
    options.closeAfterSelect = options.closeAfterSelect !== undefined ? options.closeAfterSelect : true;
    options.nextButtonIcon = options.nextButtonIcon !== undefined ? options.nextButtonIcon : false;
    options.previousButtonIcon = options.previousButtonIcon !== undefined ? options.previousButtonIcon : false;
    options.buttonsColor = options.buttonsColor !== undefined ? options.buttonsColor : false;
    options.forceFarsiDigits = options.forceFarsiDigits !== undefined ? options.forceFarsiDigits : false;
    options.markToday = options.markToday !== undefined ? options.markToday : false;
    options.markHolidays = options.markHolidays !== undefined ? options.markHolidays : false;
    options.highlightSelectedDay = options.highlightSelectedDay !== undefined ? options.highlightSelectedDay : false;
    options.sync = options.sync !== undefined ? options.sync : false;
    options.gotoToday = options.gotoToday !== undefined ? options.gotoToday : false;

    // create DOM
    var inputElement = $("#" + elementID);

    if (inputElement.attr("placeholder") === undefined) {
        inputElement.attr("placeholder", options.placeholder);
    }

    // create parent div
    inputElement.wrap("<div id='bd-root-" + elementID + "' style='position: relative;'></div>");

    // create main div for calendar, below input element
    inputElement.after("<div id='bd-main-" + elementID + "' class='bd-main bd-hide' style='position: absolute; direction: rtl;'></div>");
    var mainDiv = $("#bd-main-" + elementID);

    // create calendar div inside main div
    mainDiv.append("<div class='bd-calendar'></div>");
    var calendarDiv = mainDiv.find('.bd-calendar');

    // create title div and table inside calendar div
    calendarDiv.append("<div class='bd-title'></div>");
    var titleDiv = calendarDiv.find('.bd-title');
    calendarDiv.append("<table class='bd-table' dir='rtl' cellspacing='0' cellpadding='0'></table>");

    // create month and year drop downs and next/prev month buttons inside title div
    titleDiv.append("<button id='bd-next-" + elementID + "' class='bd-next' type='button' title='ماه بعدی' data-toggle='tooltip'><span>بعدی</span></button>");
    var nextMonth = $("#bd-next-" + elementID);
    if (options.nextButtonIcon) {
        nextMonth.find("span").css("display", "none");
        if (options.nextButtonIcon.indexOf(".") !== -1) {
            // image
            nextMonth.css("background-image", "url(" + options.nextButtonIcon + ")");
        } else {
            // css class
            nextMonth.addClass(options.nextButtonIcon);
        }
    }

    titleDiv.append("<div class='bd-dropdown'></div><div class='bd-dropdown'></div>");

    titleDiv.find('.bd-dropdown:nth-child(2)').append("<select id='bd-month-" + elementID + "' class='bd-month'></select>");
    var monthDropdown = $("#bd-month-" + elementID);
    $.each(MONTH_NAMES, function (key, value) {
        monthDropdown.append($("<option></option>").attr("value", key).text(value));
    });

    titleDiv.find('.bd-dropdown:nth-child(3)').append("<select id='bd-year-" + elementID + "' class='bd-year'></select>");
    var yearDropdown = $("#bd-year-" + elementID);

    titleDiv.append("<button id='bd-prev-" + elementID + "' class='bd-prev' type='button' title='ماه قبلی' data-toggle='tooltip'><span>قبلی</span></button>");
    var prevMonth = $("#bd-prev-" + elementID);
    if (options.nextButtonIcon) {
        prevMonth.find("span").css("display", "none");
        if (options.previousButtonIcon.indexOf(".") !== -1) {
            // image
            prevMonth.css("background-image", "url(" + options.previousButtonIcon + ")");
        } else {
            // css class
            prevMonth.addClass(options.previousButtonIcon);
        }
    }

    if (options.buttonsColor) {
        nextMonth.css("color", options.buttonsColor);
        nextMonth.find("span").css("color", options.buttonsColor);
        prevMonth.css("color", options.buttonsColor);
        prevMonth.find("span").css("color", options.buttonsColor);
    }

    // create table header and body
    calendarDiv.find('.bd-table').append("<thead><tr></tr></thead>");
    $.each(DAY_NAMES, function (key, value) {
        calendarDiv.find('.bd-table thead tr').append($("<th></th>").text(value));
    });

    calendarDiv.find('.bd-table').append("<tbody id='bd-table-days-" + elementID + "' class='bd-table-days'></tbody>");
    var daysTable = $("#bd-table-days-" + elementID);

    // create go to todays button
    if (options.gotoToday) {
        calendarDiv.append("<div class='bd-goto-today'>برو به امروز</div>");
        var gotoToday = calendarDiv.find(".bd-goto-today");
    }

    // opening and closing functionality
    inputElement.on("focus", function () {
        mainDiv.removeClass("bd-hide");
        if (options.sync && isSynced === false) {
            syncCalendar();
            isSynced = true;
        }
        mainDiv;
    }).on('blur', function () {
        if (isCalClicked == false) {
            mainDiv.addClass("bd-hide");
            isSynced = false;
        } else {
            isCalClicked = false;
            inputElement.focus();
            event.preventDefault();
        }
    });

    mainDiv.on('mousedown', function (event) {
        isCalClicked = true;
    });

    // dropdown events
    monthDropdown.on('change', function () {
        selectedMonth = parseInt(this.value);
        numberOfDays = monthDays(selectedYear, selectedMonth);
        dayOfWeekJ = findFirstDayOfMonth(selectedYear, selectedMonth);
        drawDays(numberOfDays, dayOfWeekJ);
    });
    yearDropdown.on('change', function () {
        selectedYear = parseInt(this.value);
        numberOfDays = monthDays(selectedYear, selectedMonth);
        dayOfWeekJ = findFirstDayOfMonth(selectedYear, selectedMonth);
        drawDays(numberOfDays, dayOfWeekJ);
    });

    // Georgian to Jalali converter (minified)
    // source is unknown. contact if you know the code owner.
    function gregorianToJalali(a, r, s) { a = parseInt(a), r = parseInt(r), s = parseInt(s); for (var n = a - 1600, e = r - 1, t = s - 1, p = 365 * n + parseInt((n + 3) / 4) - parseInt((n + 99) / 100) + parseInt((n + 399) / 400), I = 0; e > I; ++I) p += g_days[I]; e > 1 && (n % 4 == 0 && n % 100 != 0 || n % 400 == 0) && ++p, p += t; var v = p - 79, d = parseInt(v / 12053); v %= 12053; var o = 979 + 33 * d + 4 * parseInt(v / 1461); v %= 1461, v >= 366 && (o += parseInt((v - 1) / 365), v = (v - 1) % 365); for (var I = 0; 11 > I && v >= j_days[I]; ++I) v -= j_days[I]; var y = I + 1, _ = v + 1; return [o, y, _] } var g_days = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31], j_days = [31, 31, 31, 31, 31, 31, 30, 30, 30, 30, 30, 29];
    // Jalali to Georgian converter (minified)
    // source is unknown. contact if you know the code owner.
    function toJalaali(d, i, a) { return d2j(g2d(d, i, a)) } function toGregorian(d, i, a) { return d2g(j2d(d, i, a)) } function isValidJalaaliDate(d, i, a) { return d >= -61 && 3177 >= d && i >= 1 && 12 >= i && a >= 1 && a <= jalaaliMonthLength(d, i) } function isLeapJalaaliYear(d) { return 0 === jalCal(d).leap } function jalaaliMonthLength(d, i) { return 6 >= i ? 31 : 11 >= i ? 30 : isLeapJalaaliYear(d) ? 30 : 29 } function jalCal(d) { var i, a, n, r, t, o, v, e = [-61, 9, 38, 199, 426, 686, 756, 818, 1111, 1181, 1210, 1635, 2060, 2097, 2192, 2262, 2324, 2394, 2456, 3178], l = e.length, u = d + 621, m = -14, g = e[0]; if (g > d || d >= e[l - 1]) throw new Error("Invalid Jalaali year " + d); for (v = 1; l > v && (i = e[v], a = i - g, !(i > d)); v += 1) m = m + 8 * div(a, 33) + div(mod(a, 33), 4), g = i; return o = d - g, m = m + 8 * div(o, 33) + div(mod(o, 33) + 3, 4), 4 === mod(a, 33) && a - o === 4 && (m += 1), r = div(u, 4) - div(3 * (div(u, 100) + 1), 4) - 150, t = 20 + m - r, 6 > a - o && (o = o - a + 33 * div(a + 4, 33)), n = mod(mod(o + 1, 33) - 1, 4), -1 === n && (n = 4), { leap: n, gy: u, march: t } } function j2d(d, i, a) { var n = jalCal(d); return g2d(n.gy, 3, n.march) + 31 * (i - 1) - div(i, 7) * (i - 7) + a - 1 } function d2j(d) { var i, a, n, r = d2g(d).gy, t = r - 621, o = jalCal(t), v = g2d(r, 3, o.march); if (n = d - v, n >= 0) { if (185 >= n) return a = 1 + div(n, 31), i = mod(n, 31) + 1, { jy: t, jm: a, jd: i }; n -= 186 } else t -= 1, n += 179, 1 === o.leap && (n += 1); return a = 7 + div(n, 30), i = mod(n, 30) + 1, { jy: t, jm: a, jd: i } } function g2d(d, i, a) { var n = div(1461 * (d + div(i - 8, 6) + 100100), 4) + div(153 * mod(i + 9, 12) + 2, 5) + a - 34840408; return n = n - div(3 * div(d + 100100 + div(i - 8, 6), 100), 4) + 752 } function d2g(d) { var i, a, n, r, t; return i = 4 * d + 139361631, i = i + 4 * div(3 * div(4 * d + 183187720, 146097), 4) - 3908, a = 5 * div(mod(i, 1461), 4) + 308, n = div(mod(a, 153), 5) + 1, r = mod(div(a, 153), 12) + 1, t = div(i, 1461) - 100100 + div(8 - r, 6), { gy: t, gm: r, gd: n } } function div(d, i) { return ~~(d / i) } function mod(d, i) { return d - ~~(d / i) * i }

    var syncCalendar = function () {
        var inputValue = fixDate(inputElement.val());
        if (inputValue === "")
            return;

        inputValue = inputValue.split("/");
        monthDropdown.val(parseInt(inputValue[1]));
        monthDropdown.trigger("change");
        yearDropdown.val(parseInt(inputValue[0]));
        yearDropdown.trigger("change");

        if (options.highlightSelectedDay) {
            mainDiv.find(".bd-selected-day").removeClass("bd-selected-day");
            mainDiv.find(".day-" + parseInt(inputValue[2])).addClass("bd-selected-day");
        }
    }

    var fixDate = function (date) {
        if (date === "")
            return "";

        date = date.split("/");
        // if (date[0].length === 2) {
        //     date[0] = "13" + date[0];
        // }
        if (date[1].length < 2) {
            if (date[1] < 10) {
                date[1] = "0" + date[1];
            }
        }
        if (date[2].length < 2) {
            if (date[2] < 10) {
                date[2] = "0" + date[2];
            }
        }
        date = date.join("/");
        return date;
    }

    var convertToJWeek = function (dayOfWeekG) {
        var dayOfWeekJ;
        if (dayOfWeekG < 6) {
            dayOfWeekJ = dayOfWeekG + 1;
        } else {
            dayOfWeekJ = 0;
        }
        return dayOfWeekJ;
    }

    var makeYearList = function (thisYear) {
        yearDropdown.find('option').remove();
        for (i = 0; i < 101; i++) {
            var tempYear = ((thisYear - 95) + i) + '';
            if (options.forceFarsiDigits) {
                for (var j = 0; j < 10; j++) {
                    var rgx = new RegExp(j, 'g');
                    tempYear = tempYear.replace(rgx, FA_NUMS[j]);
                }
            }
            yearDropdown.append($('<option>', {
                value: (thisYear - 95) + i,
                text: tempYear
            }));
        }
    }

    // isleap calculator, supported year: 1243 - 1473
    var isLeapYear = function (year) {
        var mod;
        if (year < 1343 && year > 1243) {
            mod = year % 33;
            if (mod == 1 || mod == 5 || mod == 9 || mod == 13 || mod == 17 || mod == 22 || mod == 26 || mod == 30) {
                return true;
            } else {
                return false;
            }
        } else if (year < 1473 && year > 1342) {
            mod = year % 17;
            if (mod == 1 || mod == 5 || mod == 9 || mod == 13 || mod == 18 || mod == 22 || mod == 26 || mod == 30) {
                return true;
            } else {
                return false
            }
        } else {
            return "unknown";
        }
    }

    var monthDays = function (year, month) {
        if (month < 7) {
            return 31;
        } else if (month < 12) {
            return 30;
        } else {
            if (isLeapYear(year)) {
                return 30;
            } else {
                return 29;
            }
        }
    }

    // make first page of calendar
    todayG = new Date();

    todaysJ = gregorianToJalali(todayG.getFullYear(), todayG.getMonth() + 1, todayG.getDate());
    var selectedDateJ = [];
    for (i = 0; i < 3; i++) {
        selectedDateJ[i] = todaysJ[i];
    }

    todaysYear = todaysJ[0];
    todaysMonth = todaysJ[1];
    todaysDay = todaysJ[2];

    selectedYear = selectedDateJ[0];
    selectedMonth = selectedDateJ[1];
    selectedDay = selectedDateJ[2];

    monthDropdown.val(selectedMonth);
    makeYearList(selectedYear);
    yearDropdown.val(selectedYear);

    numberOfDays = monthDays(selectedYear, selectedMonth);

    // find first day of month in week
    var findFirstDayOfMonth = function (selectedYear, selectedMonth) {
        var firstDayOfMonthG = toGregorian(selectedYear, selectedMonth, 1);
        firstDayOfMonthG = new Date(firstDayOfMonthG.gy + "/" + firstDayOfMonthG.gm + "/" + firstDayOfMonthG.gd);
        return convertToJWeek(firstDayOfMonthG.getDay());
    }
    dayOfWeekJ = findFirstDayOfMonth(selectedYear, selectedMonth);

    // draw days on calendar
    var drawDays = function (numberOfDays, dayOfWeekJ) {
        daysTable.empty();
        var dayIndex = 1;
        var rowIndex = 1;
        while (dayIndex <= numberOfDays) {
            daysTable.append($('<tr>', {
                class: "tr-" + rowIndex
            }));
            for (i = 0; i < 7; i++) {
                if (dayIndex == 1) {
                    var j = 0;
                    while (j < dayOfWeekJ) {
                        $("#bd-table-days-" + elementID + " .tr-1").append($('<td>', {
                            class: "bd-empty-cell"
                        })
                        );
                        j++;
                        i++;
                    }
                }
                if (i < 7 && dayIndex <= numberOfDays) {
                    var tempTD = '<td>' +
                        '<button class="day day-' + dayIndex + '" type="button">' + (options.forceFarsiDigits ? FA_NUMS[dayIndex] : dayIndex) + '</button>' +
                        '</td>';

                    // mark todays day by adding .bd-today class
                    if (options.markToday) {
                        if (dayIndex == todaysDay && todaysMonth == selectedMonth && todaysYear == selectedYear) {
                            var idx = tempTD.indexOf('day day-');
                            tempTD = tempTD.slice(0, idx) + ' bd-today ' + tempTD.slice(idx);
                        }
                    }

                    // mark holidays by adding .bd-holiday class
                    if (options.markHolidays) {
                        if (i == 6) {
                            var idx = tempTD.indexOf('day day-');
                            tempTD = tempTD.slice(0, idx) + ' bd-holiday ' + tempTD.slice(idx);
                        }
                    }

                    $("#bd-table-days-" + elementID + " .tr-" + rowIndex).append(tempTD);

                    dayIndex++;
                }
            }
            rowIndex++;
        }

        if (options.highlightSelectedDay) {
            var inputValue = inputElement.val();
            inputValue = inputValue.split("/");
            if (inputValue[0] == selectedYear && inputValue[1] == selectedMonth) {
                mainDiv.find(".bd-selected-day").removeClass("bd-selected-day");
                mainDiv.find(".day-" + parseInt(inputValue[2])).addClass("bd-selected-day");
            }
        }

    }

    inputElement.parent().on("click", "button.day", function () {
        var datestr = selectedYear + "/" + selectedMonth + "/" + $(this).attr('class').split(" ")[$(this).attr('class').split(" ").indexOf('day') + 1].split("-")[1];
        if (options.twodigit) {
            datestr = fixDate(datestr);
        }
        inputElement.val(datestr);
        inputElement.trigger("change");
        if (options.closeAfterSelect) {
            isCalClicked = false;
            inputElement.trigger("blur");
        }

        if (options.highlightSelectedDay) {
            mainDiv.find(".bd-selected-day").removeClass("bd-selected-day");
            $(this).addClass("bd-selected-day");
        }
    });

    nextMonth.on("click", function () {
        //console.log("month: " + selectedMonth + ", year: " + selectedYear);
        if (monthDropdown.val() < 12) {
            monthDropdown.val(parseInt(monthDropdown.val()) + 1);
            monthDropdown.trigger("change");
        } else {
            monthDropdown.val(1);
            monthDropdown.trigger("change");
            yearDropdown.val(parseInt(yearDropdown.val()) + 1);
            yearDropdown.trigger("change");
        }
    });

    prevMonth.on("click", function () {
        if (monthDropdown.val() > 1) {
            monthDropdown.val(parseInt(monthDropdown.val()) - 1);
            monthDropdown.trigger("change");
        } else {
            monthDropdown.val(12);
            monthDropdown.trigger("change");
            yearDropdown.val(parseInt(yearDropdown.val()) - 1);
            yearDropdown.trigger("change");
        }
    });

    if (options.gotoToday) {
        gotoToday.on("click", function () {
            monthDropdown.val(todaysMonth);
            monthDropdown.trigger("change");
            yearDropdown.val(todaysYear);
            yearDropdown.trigger("change");
        });
    }

    drawDays(numberOfDays, dayOfWeekJ);

    // enable bootstrap tooltip if bootstrap is loaded
    if (typeof $().modal == 'function') {
        $('[data-toggle="tooltip"]').tooltip();
    }

}

var media_xm = window.matchMedia("(max-width: 575.98px)");
var media_sm = window.matchMedia("(min-width: 576px) and (max-width: 767.98px)");
var media_md = window.matchMedia("(min-width: 768px) and (max-width: 991.98px)");
var media_lg = window.matchMedia("(min-width: 992px) and (max-width: 1199.98px)");
var media_xl = window.matchMedia("(min-width: 1200px)");


function event_media_xm(media){
	if(media.matches) return $(document).trigger('media:xm', [media]);
	else return $(document).trigger('media:xm:exit', [media]);
}
function event_media_sm(media){
	if(media.matches) return $(document).trigger('media:sm', [media]);
	else return $(document).trigger('media:sm:exit', [media]);
}
function event_media_md(media){
	if(media.matches) return $(document).trigger('media:md', [media]);
	else return $(document).trigger('media:md:exit', [media]);
}
function event_media_lg(media){
	if(media.matches) return $(document).trigger('media:lg', [media]);
	else return $(document).trigger('media:lg:exit', [media]);
}
function event_media_xl(media){
	if(media.matches) return $(document).trigger('media:xl', [media]);
	else return $(document).trigger('media:xl:exit', [media]);
}

$(document).ready(function(){
	event_media_xm(media_xm);
	media_xm.addListener(event_media_xm);

	event_media_sm(media_sm);
	media_sm.addListener(event_media_sm);

	event_media_md(media_md);
	media_md.addListener(event_media_md);

	event_media_lg(media_lg);
	media_lg.addListener(event_media_lg);

	event_media_xl(media_xl);
	media_xl.addListener(event_media_xl);
})

$(document).ready(function () {
	$.ajaxSetup(
		{
			headers:
			{
				'X-CSRF-Token': $('meta[name="csrf-token"]').attr('content')
			}
		}
	);
	$(document).trigger('statio:global:renderResponse', [$(document)]);
});
$(document).on('statio:global:renderResponse', function (event, base, context) {
	base.each(function () {
		$('[data-Lijax], .lijax', this).each(function () {
			new Lijax(this);
		});
		$("a", this).not('.direct, [data-direct], [target=_blank], .lijax, [data-lijax]').on('click', function () {
			new Statio({
				url: $(this).attr('href'),
				type: $(this).is('.action') ? 'render' : 'both',
				context: $(this),
			});
			return false;
		});

		$('form[action]', this).not('.direct, [data-direct], [target=_blank], .lijax').each(function () {
			new Lijax(this);
		}).on('jresp', function (e, d) {
			$('.is-invalid', this).removeClass('is-invalid');
			$('.invalid-feedback', this).remove();
			if (d.errors) {
				for (var id in d.errors) {
					$('#' + id + ', [data-alias~=' + id + ']').addClass('is-invalid');
					$('<div class="invalid-feedback">' + d.errors[id][0] + '</div>').insertAfter($('#' + id + ', [data-alias~=' + id + ']'));
				}
			}
		});
		$(".select2-select", this).each(function () {
			var options = {
				width: '100%',
				amdLanguageBase: 'dist/vendors/select2-4.0.13/dist/js/i18n',
				language: 'fa',
				minimumInputLength: 0,
				allowClear: $(this).is('[data-allowClear]') || $(this).is('.has-clear'),
				dir: "rtl",
				tags: $(this).is('.tag-type'),
				dropdownParent: $('#' + $(this).attr('data-dropdownParent')).length ? $('#' + $(this).attr('data-dropdownParent')) : undefined
			};
			$(this).attr('data-mr-value', $('[name=' + $(this).attr('data-multi-round') + ']').val());
			$('[name=' + $(this).attr('data-multi-round') + ']').remove();
			if (options.allowClear) {
				options.placeholder = {};
				options.placeholder.text = $('option', this).first().text();
				options.placeholder.id = $('option', this).first().attr('value');
			}
			if ($(this).is('[data-url]')) {
				var title = $(this).attr('data-title') || 'title';
				var _self = this;
				options.ajax = {
					delay: 250,
					url: $(this).attr('data-url'),
					dataType: 'json',
					quietMillis: 250,
					data: function (params) {
						return {
							q: params.term || ''
						};
					},
					processResults: function (data) {
						data = data.data || data;
						var id_property = $(_self).attr('data-id') || 'id';
						var title_property = $(_self).attr('data-title') || 'title';
						var result = { results: [] };
						if ($(_self).is('[data-allowClear]')) {
							result.results.push({
								id: '',
								text: '-',
								all: null
							});
						}
						for (var i = 0; i < data.length; i++) {
							var sub_title_property = title_property;
							if (sub_title_property.indexOf(' ') >= 0) {
								var sub_title_properties = sub_title_property.split(' ');
								for (var is = 0; is < sub_title_properties.length; is++) {
									if (data[i][sub_title_properties[is]]) {
										sub_title_property = sub_title_properties[is];
										break;
									}

								}
							}
							result.results.push({
								id: data[i][id_property],
								text: data[i][sub_title_property],
								all: data[i]
							});
						}
						return result;
					},
					cache: false
				};
			}
			$(this).select2(options);
		});
	});
});
function responsive_menu() {
    $('#menu').removeClass('d-none').addClass('d-flex');
    // $('#desktop').removeClass('d-none');
    $('body').addClass('responsive-menu');
    $('#btn-menu').find($(".fas")).removeClass('fa-bars').addClass('fa-arrow-right');
    $(this).off('click.responsive-menu');
    $(this).on('click.close-responsive-menu', function() {
        $(this).off('click.close-responsive-menu');
        $(this).on('click.responsive-menu', responsive_menu);
        $('#menu').addClass('d-none').removeClass('d-flex');
        // $('#desktop').addClass('d-none');
        $('body').removeClass('responsive-menu');
        $('#btn-menu').find($(".fas")).removeClass('fa-arrow-right').addClass('fa-bars');
    });
}

$(document).on('media:xm media:sm', function(event, media) {
    $("body:not(.responsive-menu) #btn-menu").on('click.responsive-menu', responsive_menu);

    var menu = $('#menu');
    var desktop = $('#desktop');
    var btn_menu = $('#btn-menu');
    $(document).mouseup(function(e) {
        if (
            (!menu.is(e.target) && menu.has(e.target).length === 0)
            && (!desktop.is(e.target) && desktop.has(e.target).length === 0)
            && (!btn_menu.is(e.target) && btn_menu.has(e.target).length === 0)
            )
        {
            $("body.responsive-menu #btn-menu").trigger('click.close-responsive-menu');
        }
    });

    // $("body").swipe({
    //     swipe: function(event, direction, distance, duration, fingerCount, fingerData) {
    //         if (direction == 'left') {
    //             $("body:not(.responsive-menu) #btn-menu").trigger('click.responsive-menu');
    //         }

    //         if (direction == 'right') {
    //             $("body.responsive-menu #btn-menu").trigger('click.close-responsive-menu');
    //         }

    //         if (direction == 'up' || direction == 'down') {
    //             if (!menu.is(event.target) && menu.has(event.target).length === 0) {
    //                 $("body.responsive-menu #btn-menu").trigger('click.close-responsive-menu');
    //             }
    //         }
    //     }
    // });
});

$(document).on('media:md media:lg media:xl', function(event, media) {
    $("body.responsive-menu #btn-menu").trigger('click.close-responsive-menu');
    $("#btn-menu").off('click.responsive-menu');
    // $("#btn-menu").off('click.close-responsive-menu');
    // $('#menu').addClass('d-none').removeClass('d-flex');
    // $('#desktop').addClass('d-none');
    // $('body').removeClass('responsive-menu');
    // $('#btn-menu').find($(".fas")).removeClass('fa-arrow-right').addClass('fa-bars');
});
(function () {
	function ViwFile()
	{
		$('.custom-file-input', this).on('change', function(){
			if (!window.File && !window.FileReader && !window.FileList && !window.Blob) {
				console.error('FileReader unsupported!');
				return false;
			}
			var file_index = 0;
			var file;
			$(this).next().html('');
			var files = [];
			while (file = this.files.item(file_index++))
			{
				files.push(file.name);
			}
			$(this).next().html(files.join(' : '));
		});
	}
	$(document).on('statio:global:renderResponse', function (event, base, contex) {
		base.each(function () {
			ViwFile.call(this);
		});
	});
	ViwFile.call(document);
})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkpSZXNwLmpzIiwiTGlqYXguanMiLCJTdGF0aW8uanMiLCJVcmwuanMiLCJhcHAuanMiLCJkYXRlcGlja2VyLmpzIiwibWVkaWEtZXZlbnQuanMiLCJyZWdpc3Rlci5qcyIsInNpZGViYXItcmVzcG9uc2l2ZS5qcyIsInZpd2ZpbGUuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2xDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNwSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNuUEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN0VkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNwSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN4Y0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDNUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMxR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM1REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJzYXJrb290Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe1xuXHRmdW5jdGlvbiBqcmVzcChjb250ZXh0LCByZXMpXG5cdHtcblx0XHRjb250ZXh0LnRyaWdnZXIoJ2pyZXNwJywgW3Jlc10pO1xuXHRcdGlmIChyZXMubWVzc2FnZSAmJiAhY29udGV4dC5pcygnLmQtbm90aWZpY2F0aW9uJykpXG5cdFx0e1xuXHRcdFx0aWYgKHdpbmRvdy50b2FzdHIpXG5cdFx0XHR7XG5cdFx0XHRcdHZhciB0b2FzdCA9IHRvYXN0cltyZXMuaXNfb2sgPyAnc3VjY2VzcycgOiAnZXJyb3InXShyZXMubWVzc2FnZV90ZXh0IHx8IHJlcy5tZXNzYWdlLCB1bmRlZmluZWQsIHtcblx0XHRcdFx0XHRcImNsb3NlQnV0dG9uXCI6IHRydWUsXG5cdFx0XHRcdFx0XCJuZXdlc3RPblRvcFwiOiB0cnVlLFxuXHRcdFx0XHRcdFwicG9zaXRpb25DbGFzc1wiOiBcInRvYXN0LWJvdHRvbS1yaWdodFwiLFxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHRcdGVsc2UgaWYgKHdpbmRvdy5pemlUb2FzdClcblx0XHRcdHtcblx0XHRcdFx0aXppVG9hc3RbcmVzLmlzX29rID8gJ3N1Y2Nlc3MnIDogJ2Vycm9yJ10oeyBtZXNzYWdlOiByZXMubWVzc2FnZV90ZXh0IHx8IHJlcy5tZXNzYWdlfSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGlmKHJlcy5yZWRpcmVjdClcblx0XHR7XG5cdFx0XHRpZihyZXMuZGlyZWN0KVxuXHRcdFx0e1xuXHRcdFx0XHRsb2NhdGlvbi5ocmVmID0gcmVzLnJlZGlyZWN0O1xuXHRcdFx0fVxuXHRcdFx0ZWxzZVxuXHRcdFx0e1xuXHRcdFx0XHRuZXcgU3RhdGlvKHtcblx0XHRcdFx0XHR1cmwgOiByZXMucmVkaXJlY3Rcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdHdpbmRvdy5KUmVzcCA9IGpyZXNwO1xufSkoKTsiLCIoZnVuY3Rpb24oKXtcblx0ZnVuY3Rpb24gbGlqYXgoY29udGV4dCwgb25GaXJlKVxuXHR7XG4gICAgICAgIHZhciBiYWNrX3ZhbHVlID0gJChjb250ZXh0KS52YWwoKSB8fCAkKGNvbnRleHQpLmF0dHIoJ2RhdGEtdmFsdWUnKTtcbiAgICAgICAgaWYoJChjb250ZXh0KS5pcygnOmNoZWNrYm94JykpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGJhY2tfdmFsdWUgPSAkKGNvbnRleHQpLmlzKCc6Y2hlY2tlZCcpID8gMSA6IDA7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIFRpbWVvdXQgPSBudWxsO1xuICAgICAgICB2YXIgZmlyZSA9IG51bGw7XG4gICAgICAgIGlmKCQoY29udGV4dCkuaXMoJ2Zvcm0nKSAmJiAhJChjb250ZXh0KS5hdHRyKCdkYXRhLWxpamF4JykpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGZpcmUgPSBbJ3N1Ym1pdCddO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgZmlyZSA9ICQoY29udGV4dCkuYXR0cignZGF0YS1saWpheCcpLnNwbGl0KCcgJykgfHwgWydjaGFuZ2UnXTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZpcmUubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmKC9eXFxkKyQvLnRlc3QoZmlyZVtpXSkpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmFyIFRpbWUgPSBmaXJlW2ldO1xuICAgICAgICAgICAgICAgICQoY29udGV4dCkub24oJ2tleXVwJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgaWYoVGltZW91dCkgY2xlYXJUaW1lb3V0KFRpbWVvdXQpO1xuICAgICAgICAgICAgICAgICAgICBUaW1lb3V0ID0gc2V0VGltZW91dChzZW5kLCBUaW1lKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAkKGNvbnRleHQpLm9uKGZpcmVbaV0sIHNlbmQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2VuZCgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBocmVmID0gdXJsLnBhcnNlKGxvY2F0aW9uLmhyZWYpO1xuICAgICAgICAgICAgdmFyIG5hbWUgPSAkKGNvbnRleHQpLmF0dHIoJ25hbWUnKSB8fCAkKGNvbnRleHQpLmF0dHIoJ2RhdGEtbmFtZScpO1xuICAgICAgICAgICAgaWYoaHJlZi5nZXQgJiYgaHJlZi5nZXRbbmFtZV0pXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIGhyZWYuZ2V0W25hbWVdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGdldCA9IHVybC5idWlsZGdldChocmVmLmdldCk7XG4gICAgICAgICAgICBocmVmID0gaHJlZi51cmwucmVwbGFjZSgvXFw/KC4qKSQvLCBnZXQgPyAnPycgKyBnZXQgOiAnJyk7XG4gICAgICAgICAgICB2YXIgYWN0aW9uID0gJChjb250ZXh0KS5hdHRyKCdocmVmJykgfHwgJChjb250ZXh0KS5hdHRyKCdhY3Rpb24nKSB8fCAkKGNvbnRleHQpLmF0dHIoJ2RhdGEtYWN0aW9uJykgfHwgaHJlZjtcbiAgICAgICAgICAgIHZhciBtZXRob2QgPSAkKGNvbnRleHQpLmF0dHIoJ2RhdGEtbWV0aG9kJykgfHwgJChjb250ZXh0KS5hdHRyKCdtZXRob2QnKSB8fCAnR0VUJztcbiAgICAgICAgICAgIHZhciBzdGF0ZSA9ICQoY29udGV4dCkuYXR0cignZGF0YS1zdGF0ZScpO1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgaWYoJChjb250ZXh0KS5pcygnZm9ybScpKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHZhciBEYXRhID0gbmV3IEZvcm1EYXRhKGNvbnRleHQpO1xuICAgICAgICAgICAgICAgIHZhciBkYXRhID0ge307XG5cdFx0XHRcdGlmICgkKGNvbnRleHQpLmF0dHIoJ2VuY3R5cGUnKSA9PSAnbXVsdGlwYXJ0L2Zvcm0tZGF0YScgfHwgJCgnaW5wdXQ6ZmlsZScsIGNvbnRleHQpLmxlbmd0aClcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSBEYXRhO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBEYXRhLmZvckVhY2goZnVuY3Rpb24gKHZhbHVlLCBuYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhW25hbWVdID0gL1xcWy4qXFxdJC8udGVzdChuYW1lKSA/IERhdGEuZ2V0QWxsKG5hbWUpIDogRGF0YS5nZXQobmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdGF0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICQoY29udGV4dCkuYWRkQ2xhc3MoJ2xpamF4LXNlbmRpbmcnKTtcbiAgICAgICAgICAgICAgICAkKCdpbnB1dCwgc2VsZWN0LCB0ZXh0YXJlYSwgYnV0dG9uJywgY29udGV4dCkubm90KCc6ZGlzYWJsZWQnKS5hZGRDbGFzcygnbGlqYXgtZGlzYWJsZScpLmF0dHIoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgICAgICAgJChjb250ZXh0KS5vbignc3RhdGlvOmRvbmUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICQoJy5saWpheC1kaXNhYmxlJywgdGhpcykucmVtb3ZlQ2xhc3MoJ2xpamF4LWRpc2FibGUnKS5yZW1vdmVBdHRyKCdkaXNhYmxlZCcpXG4gICAgICAgICAgICAgICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoJ2xpamF4LXNlbmRpbmcnKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9ICQoY29udGV4dCkudmFsKCkgfHwgJChjb250ZXh0KS5hdHRyKCdkYXRhLXZhbHVlJykgfHwgbnVsbDtcbiAgICAgICAgICAgICAgICBpZigkKGNvbnRleHQpLmlzKCc6Y2hlY2tib3gnKSlcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gJChjb250ZXh0KS5pcygnOmNoZWNrZWQnKSA/IDEgOiAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZihiYWNrX3ZhbHVlID09IHZhbHVlICYmICQoY29udGV4dCkuaXMoJ2lucHV0LCB0ZXh0YXJlYSwgc2VsZWN0JykgJiYgIW9uRmlyZSkgcmV0dXJuO1xuICAgICAgICAgICAgICAgIGJhY2tfdmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgIGRhdGFbbmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgkKGNvbnRleHQpLmF0dHIoJ2RhdGEtcXVlcnknKSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uX3F1ZXJ5ID0gdXJsLnBhcnNlKGFjdGlvbik7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGFfcXVlcnkgPSB1cmwucGFyc2UoJz8nICsgJChjb250ZXh0KS5hdHRyKCdkYXRhLXF1ZXJ5JykpO1xuICAgICAgICAgICAgICAgIGFjdGlvbl9xdWVyeS5nZXQgPSAkLmV4dGVuZChudWxsLCAoYWN0aW9uX3F1ZXJ5LmdldCB8fCB7fSksIGRhdGFfcXVlcnkuZ2V0KTtcbiAgICAgICAgICAgICAgICBhY3Rpb24gPSB1cmwuYnVpbGQoYWN0aW9uX3F1ZXJ5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBoZWFkZXJzID0ge307XG4gICAgICAgICAgICBpZiAoJChjb250ZXh0KS5hdHRyKCdkYXRhLXhockJhc2UnKSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzID0ge1xuICAgICAgICAgICAgICAgICAgICAnRGF0YS14aHItYmFzZSc6ICQoY29udGV4dCkuYXR0cignZGF0YS14aHJCYXNlJylcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbmV3IFN0YXRpbyh7XG4gICAgICAgICAgICAgICAgdHlwZSA6IHN0YXRlID8gJ2JvdGgnIDogJ3JlbmRlcicsXG4gICAgICAgICAgICAgICAgY29udGV4dDogY29udGV4dCxcbiAgICAgICAgICAgICAgICBhamF4IDoge1xuXHRcdFx0XHRcdGNvbnRlbnRUeXBlOiAkKGNvbnRleHQpLmlzKCdmb3JtJykgJiYgKCQoY29udGV4dCkuYXR0cignZW5jdHlwZScpID09ICdtdWx0aXBhcnQvZm9ybS1kYXRhJyB8fCAkKCdpbnB1dDpmaWxlJywgY29udGV4dCkubGVuZ3RoKSA/IGZhbHNlIDogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD1VVEYtOCcsXG5cdFx0XHRcdFx0cHJvY2Vzc0RhdGE6ICgkKGNvbnRleHQpLmlzKCdmb3JtJykgJiYgKCQoY29udGV4dCkuYXR0cignZW5jdHlwZScpID09ICdtdWx0aXBhcnQvZm9ybS1kYXRhJyB8fCAkKCdpbnB1dDpmaWxlJywgY29udGV4dCkubGVuZ3RoKSkgPyBmYWxzZSA6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGNhY2hlICAgICAgIDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZCA6IG1ldGhvZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YSA6IGRhdGEsXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnNcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHVybCA6IGFjdGlvblxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9uRmlyZSlcbiAgICAgICAge1xuICAgICAgICAgICAgc2VuZCgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHdpbmRvdy5MaWpheCA9IGxpamF4O1xufSkoKTsiLCIoZnVuY3Rpb24oKXtcblx0dmFyIF9nbG9iYWxzID0ge1xuXHRcdHRpdGxlIDogZnVuY3Rpb24gKHZhbHVlKXtcblx0XHRcdCQoJ3RpdGxlJykuaHRtbCh2YWx1ZSk7XG5cdFx0fVxuXHR9XG5cblx0dmFyIF9hamF4ID0ge1xuXHRcdHR5cGUgOiAnR0VUJyxcblx0XHRjYWNoZSA6IGZhbHNlXG5cdH1cblxuXHR2YXIgX29wdGlvbnMgPSB7XG5cdFx0b2JqZWN0IDogbnVsbCxcblx0XHR0aXRsZSA6IG51bGwsXG5cdFx0YWpheCA6IF9hamF4LFxuXHQvKipcblx0ICogU2VuZCByZXF1ZXN0IGFuZCBjaGFuZ2UgdXJsIHdpdGggcmVzcG9uc2UgcmVuZGVyaW5nXG5cdCAqIEBkZWZhdWx0IGJvdGhcblx0ICogYm90aDogY2hhbmdlIHVybCBhbmQgcmVuZGVyIHJlc3BvbnNlXG5cdCAqIHVybDogT25seSBzZW5kIHJlcXVlc3QgYW5kIGNoYWdlIHVybCB3aXRob3V0IGNoYW5nZSByZW5kZXJpbmdcblx0ICogcmVuZGVyOiBPbmx5IHNlbmQgcmVxdWVzdCBhbmQgcmVuZGVyIHJlcHNvbnNlIHdpdGhvdXQgY2hhbmdlIHVybFxuXHQgKiBAdHlwZSB7U3RyaW5nfVxuXHQgKi9cblx0IHR5cGUgOiAnYm90aCcsXG5cdC8qKlxuXHQgKiBkb250IHNlbmQgYW55IHJlcXVlc3Rcblx0ICogQHR5cGUge0Jvb2xlYW59XG5cdCAqL1xuXHQgZmFrZSA6IGZhbHNlLFxuXHQvKipcblx0ICogYWpheCByZXNwb25zZSBjb250ZXRudFxuXHQgKiBpZiB7ZmFrZTp0cnVlfSBvciB7cmVzcG9uc2UgOiBub3RudWxsfSByZXNwb25zZSByZW5kZXIgdGhpcyBwcm9wZXJ0eVxuXHQgKiBAdHlwZSB7W3R5cGVdfVxuXHQgKi9cblx0IHJlc3BvbnNlIDogbnVsbCxcblx0LyoqXG5cdCAqIHJlcGxhY2Ugc3RhdGVcblx0ICogQHR5cGUge0Jvb2xlYW59XG5cdCAqL1xuXHQgcmVwbGFjZSA6IGZhbHNlLFxuXHQvKipcblx0ICogZXZlbnQgY29udGV4dFxuXHQgKiBAdHlwZSB7RE9NfSB7alF1ZXJ5fSB7U2VsZWN0b3Igc3RyaW5nfVxuXHQgKi9cblx0IGNvbnRleHQgOiBkb2N1bWVudFxuXHR9XG5cblx0ZnVuY3Rpb24gc3RhdGlvKGN1c3RvbSl7XG5cdFx0aWYodHlwZW9mIGN1c3RvbSAhPSAnb2JqZWN0Jylcblx0XHR7XG5cdFx0XHRjdXN0b20gPSB7fTtcblx0XHR9XG5cblx0XHRjdXN0b20uYWpheCA9ICQuZXh0ZW5kKHt9LCBfYWpheCwgY3VzdG9tLmFqYXgpO1xuXHRcdGN1c3RvbS5hamF4LnVybCA9IGN1c3RvbS51cmw7XG5cdFx0Y3VzdG9tLmdsb2JhbHMgPSAkLmV4dGVuZCh7fSwgX2dsb2JhbHMsIGN1c3RvbS5nbG9iYWxzKTtcblx0XHR2YXIgb3B0aW9ucyA9ICQuZXh0ZW5kKHt9LCBfb3B0aW9ucywgY3VzdG9tKTtcblxuXHRcdHZhciByZXNwb25zZSA9IHtcblx0XHRcdGJvZHkgOiBvcHRpb25zLnJlc3BvbnNlLFxuXHRcdFx0ZGF0YSA6IHt9LFxuXHRcdH07XG5cblx0XHRpZighKG9wdGlvbnMuY29udGV4dCBpbnN0YW5jZW9mIGpRdWVyeSkpXG5cdFx0e1xuXHRcdFx0b3B0aW9ucy5jb250ZXh0ID0gJChvcHRpb25zLmNvbnRleHQpO1xuXHRcdH1cblxuXHRcdCQoZG9jdW1lbnQpLnRyaWdnZXIoJ3N0YXRpbzpnbG9iYWw6aW5pdCcsIFtvcHRpb25zLmNvbnRleHRdKTtcblx0XHRvcHRpb25zLmNvbnRleHQudHJpZ2dlcignc3RhdGlvOmluaXQnKTtcblxuXG5cdFx0dmFyIGFqYXhfZGF0YSA9IG51bGw7XG5cdFx0dmFyIGFqYXhfc2VuZF91cmwgPSBudWxsO1xuXHRcdGlmKCFvcHRpb25zLmZha2UpXG5cdFx0e1xuXHRcdFx0aWYoIW9wdGlvbnMuYWpheC5jb21wbGV0ZSlcblx0XHRcdHtcblx0XHRcdFx0b3B0aW9ucy5hamF4LmNvbXBsZXRlID0gYWp4X2NvbXBsZXRlO1xuXHRcdFx0fVxuXHRcdFx0dmFyIGJlZm9yZVNlbmQgPSBvcHRpb25zLmFqYXguYmVmb3JlU2VuZDtcblx0XHRcdG9wdGlvbnMuYWpheC5iZWZvcmVTZW5kID0gZnVuY3Rpb24oanFYSFIsIHNldHRpbmdzKVxuXHRcdFx0e1xuXHRcdFx0XHRhamF4X2RhdGEgPSB0aGlzO1xuXHRcdFx0XHRhamF4X3NlbmRfdXJsID0gdGhpcy51cmw7XG5cdFx0XHRcdHZhciB1cmx4ID0gdXJsLnBhcnNlKGFqYXhfc2VuZF91cmwpO1xuXHRcdFx0XHRpZih1cmx4LmdldCAmJiB1cmx4LmdldC5fKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0ZGVsZXRlIHVybHguZ2V0Ll87XG5cdFx0XHRcdH1cbiAgICAgICAgICAgIFx0dmFyIGdldCA9IHVybC5idWlsZGdldCh1cmx4LmdldCk7XG4gICAgICAgICAgICBcdGFqYXhfc2VuZF91cmwgPSB1cmx4LnVybC5yZXBsYWNlKC9cXD8oLiopJC8sIGdldCA/ICc/JyArIGdldCA6ICcnKTtcblx0XHRcdFx0YmVmb3JlU2VuZCA/IGJlZm9yZVNlbmQuY2FsbCh0aGlzLCBqcVhIUiwgc2V0dGluZ3MpIDogbnVsbDtcblx0XHRcdH1cblx0XHRcdCQuYWpheChvcHRpb25zLmFqYXgpO1xuXHRcdH1cblx0XHRlbHNlIGlmKG9wdGlvbnMudHlwZSAhPSAndXJsJyAmJiByZXNwb25zZS5ib2R5KVxuXHRcdHtcblx0XHRcdHJlc3BvbnNlX3BhcnNlKCk7XG5cdFx0XHRyZW5kZXIoKTtcblx0XHRcdCQoZG9jdW1lbnQpLnRyaWdnZXIoJ3N0YXRpbzpnbG9iYWw6ZG9uZScsIFtvcHRpb25zLmNvbnRleHRdKTtcblx0XHRcdG9wdGlvbnMuY29udGV4dC50cmlnZ2VyKCdzdGF0aW86ZG9uZScpO1xuXHRcdH1cblx0XHRlbHNlXG5cdFx0e1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0b3B0aW9ucy5yZXBsYWNlXG5cdFx0XHRcdFx0PyBoaXN0b3J5LnJlcGxhY2VTdGF0ZShKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG9wdGlvbnMpKSwgb3B0aW9ucy50aXRsZSwgYWpheF9zZW5kX3VybCB8fCBvcHRpb25zLnVybClcblx0XHRcdFx0XHQ6IGhpc3RvcnkucHVzaFN0YXRlKEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkob3B0aW9ucykpLCBvcHRpb25zLnRpdGxlLCBhamF4X3NlbmRfdXJsIHx8IG9wdGlvbnMudXJsKTtcblx0XHRcdH1cblx0XHRcdGNhdGNoIChlKSB7XG5cdFx0XHRcdGNvbnNvbGUuZXJyb3IoZSk7XG5cdFx0XHR9XG5cdFx0XHQkKGRvY3VtZW50KS50cmlnZ2VyKCdzdGF0aW86Z2xvYmFsOmRvbmUnLCBbb3B0aW9ucy5jb250ZXh0XSk7XG5cdFx0XHRvcHRpb25zLmNvbnRleHQudHJpZ2dlcignc3RhdGlvOmRvbmUnKTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBhanhfY29tcGxldGUoanFYSFIsIHRleHRTdGF0dXMpXG5cdFx0e1xuXHRcdFx0aWYoanFYSFIucmVzcG9uc2VKU09OKVxuXHRcdFx0e1xuXHRcdFx0XHRyZXNwb25zZS5kYXRhID0ganFYSFIucmVzcG9uc2VKU09OO1xuXHRcdFx0XHQkKGRvY3VtZW50KS50cmlnZ2VyKCdzdGF0aW86Z2xvYmFsOmpzb25SZXNwb25zZScsIFtvcHRpb25zLmNvbnRleHQsIGpxWEhSLnJlc3BvbnNlSlNPTiwganFYSFJdKTtcblx0XHRcdFx0b3B0aW9ucy5jb250ZXh0LnRyaWdnZXIoJ3N0YXRpbzpqc29uUmVzcG9uc2UnLCBbanFYSFIucmVzcG9uc2VKU09OLCBqcVhIUl0pO1xuXHRcdFx0XHRuZXcgSlJlc3Aob3B0aW9ucy5jb250ZXh0LCByZXNwb25zZS5kYXRhKTtcblx0XHRcdH1cblx0XHRcdGVsc2Vcblx0XHRcdHtcblx0XHRcdFx0cmVzcG9uc2UuYm9keSA9IGpxWEhSLnJlc3BvbnNlVGV4dDtcblx0XHRcdFx0cmVzcG9uc2VfcGFyc2UoKTtcblx0XHRcdFx0aWYodGV4dFN0YXR1cyA9PSAnc3VjY2VzcycpXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRpZiAob3B0aW9ucy50eXBlICE9ICdyZW5kZXInKSB7XG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRvcHRpb25zLnJlc3BvbnNlID0gcmVzcG9uc2U7XG5cdFx0XHRcdFx0XHRcdG9wdGlvbnMucmVwbGFjZVxuXHRcdFx0XHRcdFx0XHRcdD8gaGlzdG9yeS5yZXBsYWNlU3RhdGUoSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShvcHRpb25zKSksIG9wdGlvbnMudGl0bGUsIGFqYXhfc2VuZF91cmwgfHwgb3B0aW9ucy51cmwpXG5cdFx0XHRcdFx0XHRcdFx0OiBoaXN0b3J5LnB1c2hTdGF0ZShKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG9wdGlvbnMpKSwgb3B0aW9ucy50aXRsZSwgYWpheF9zZW5kX3VybCB8fCBvcHRpb25zLnVybCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRjYXRjaCAoZSkge1xuXHRcdFx0XHRcdFx0XHR0cnl7XG5cdFx0XHRcdFx0XHRcdFx0b3B0aW9ucy5yZXBsYWNlXG5cdFx0XHRcdFx0XHRcdFx0XHQ/IGhpc3RvcnkucmVwbGFjZVN0YXRlKG9wdGlvbnMuZGF0YSwgb3B0aW9ucy50aXRsZSwgYWpheF9zZW5kX3VybCB8fCBvcHRpb25zLnVybClcblx0XHRcdFx0XHRcdFx0XHRcdDogaGlzdG9yeS5wdXNoU3RhdGUob3B0aW9ucy5kYXRhLCBvcHRpb25zLnRpdGxlLCBhamF4X3NlbmRfdXJsIHx8IG9wdGlvbnMudXJsKTtcblxuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdGNhdGNoIChlKXtcblx0XHRcdFx0XHRcdFx0XHRjb25zb2xlLmVycm9yKGUpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdCQoZG9jdW1lbnQpLnRyaWdnZXIoJ3N0YXRpbzpnbG9iYWw6c3VjY2VzcycsIFtvcHRpb25zLmNvbnRleHQsIHJlc3BvbnNlLmRhdGEsIHJlc3BvbnNlLmJvZHksIGpxWEhSXSk7XG5cdFx0XHRcdFx0b3B0aW9ucy5jb250ZXh0LnRyaWdnZXIoJ3N0YXRpbzpzdWNjZXNzJywgW3Jlc3BvbnNlLmRhdGEsIHJlc3BvbnNlLmJvZHksIGpxWEhSXSk7XG5cdFx0XHRcdFx0aWYob3B0aW9ucy50eXBlICE9ICd1cmwnKVxuXHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdHJlbmRlcigpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlXG5cdFx0XHRcdHtcblx0XHRcdFx0XHQkKGRvY3VtZW50KS50cmlnZ2VyKCdzdGF0aW86Z2xvYmFsOmVycm9yUmVzcG9uc2UnLCBbb3B0aW9ucy5jb250ZXh0LCByZXNwb25zZS5kYXRhLCByZXNwb25zZS5ib2R5LCBqcVhIUl0pO1xuXHRcdFx0XHRcdG9wdGlvbnMuY29udGV4dC50cmlnZ2VyKCdzdGF0aW86ZXJyb3JSZXNwb25zZScsIFtyZXNwb25zZS5kYXRhLCByZXNwb25zZS5ib2R5LCBqcVhIUl0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHQkKGRvY3VtZW50KS50cmlnZ2VyKCdzdGF0aW86Z2xvYmFsOmRvbmUnLCBbb3B0aW9ucy5jb250ZXh0LCByZXNwb25zZS5kYXRhLCByZXNwb25zZS5ib2R5LCBqcVhIUl0pO1xuXHRcdFx0b3B0aW9ucy5jb250ZXh0LnRyaWdnZXIoJ3N0YXRpbzpkb25lJywgW3Jlc3BvbnNlLmRhdGEsIHJlc3BvbnNlLmJvZHksIGpxWEhSXSk7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gcmVzcG9uc2VfcGFyc2UoKXtcblx0XHRcdGlmKHR5cGVvZiByZXNwb25zZS5ib2R5ID09ICdzdHJpbmcnKVxuXHRcdFx0e1xuXHRcdFx0XHR0cnlcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHZhciBzcGxpdCAgICAgPSByZXNwb25zZS5ib2R5LnNwbGl0KFwiXFxuXCIpO1xuXHRcdFx0XHRcdHJlc3BvbnNlLmRhdGEgPSBKU09OLnBhcnNlKHNwbGl0WzBdKTtcblx0XHRcdFx0XHRyZXNwb25zZS5ib2R5ID0gc3BsaXQubGVuZ3RoID4gMSA/ICQoJC5wYXJzZUhUTUwoc3BsaXQuc3BsaWNlKDEpLmpvaW4oXCJcIikpKSA6IG51bGw7XG5cdFx0XHRcdH1jYXRjaChlKXtcblx0XHRcdFx0XHRyZXNwb25zZS5ib2R5ICA9ICQoJC5wYXJzZUhUTUwocmVzcG9uc2UuYm9keSkpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRlbHNlIGlmKHR5cGVvZiByZXNwb25zZS5ib2R5ID09ICdvYmplY3QnICYmIHJlc3BvbnNlLmJvZHkgIT0gbnVsbClcblx0XHRcdHtcblx0XHRcdFx0aWYocmVzcG9uc2UuYm9keSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0cmVzcG9uc2UuYm9keSAgPSAkKHJlc3BvbnNlLmJvZHkpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGVsc2UgaWYocmVzcG9uc2UuYm9keSBpbnN0YW5jZW9mIGpRdWVyeSlcblx0XHRcdFx0e1xuXG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxzZVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0cmVzcG9uc2UuZGF0YSA9IHJlc3BvbnNlLmJvZHk7XG5cdFx0XHRcdFx0cmVzcG9uc2UuYm9keSA9IG51bGw7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRmdW5jdGlvbiByZW5kZXIoKXtcblx0XHRcdGZvcihEIGluIHJlc3BvbnNlLmRhdGEpXG5cdFx0XHR7XG5cdFx0XHRcdGlmKG9wdGlvbnMuZ2xvYmFsc1tEXSlcblx0XHRcdFx0e1xuXHRcdFx0XHRcdG9wdGlvbnMuZ2xvYmFsc1tEXShyZXNwb25zZS5kYXRhW0RdKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0aWYocmVzcG9uc2UuYm9keSlcblx0XHRcdHtcblx0XHRcdFx0dmFyIGNoYW5nZWQgPSBbXTtcblx0XHRcdFx0cmVzcG9uc2UuYm9keS5lYWNoKGZ1bmN0aW9uKCl7XG5cdFx0XHRcdFx0dmFyIGJhc2UgPSAkKHRoaXMpLmF0dHIoJ2RhdGEteGhyJyk7XG5cdFx0XHRcdFx0aWYoYmFzZSlcblx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRjaGFuZ2VkLnB1c2goJChcIltkYXRhLXhocj0nXCIrYmFzZStcIiddXCIpKTtcblx0XHRcdFx0XHRcdCQoXCJbZGF0YS14aHI9J1wiK2Jhc2UrXCInXVwiKS5odG1sKCQodGhpcykuaHRtbCgpKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHQkKGRvY3VtZW50KS50cmlnZ2VyKCdzdGF0aW86Z2xvYmFsOnJlbmRlclJlc3BvbnNlJywgWyQoY2hhbmdlZCksIG9wdGlvbnMuY29udGV4dCwgcmVzcG9uc2UuZGF0YSwgcmVzcG9uc2UuYm9keV0pO1xuXHRcdFx0XHRvcHRpb25zLmNvbnRleHQudHJpZ2dlcignc3RhdGlvOnJlbmRlclJlc3BvbnNlJywgWyQoY2hhbmdlZCksIHJlc3BvbnNlLmRhdGEsIHJlc3BvbnNlLmJvZHldKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblx0d2luZG93LlN0YXRpbyA9IHN0YXRpbztcblx0LyoqXG5cdCAqIGZvciBuZXcgY2hyb21lIGJ1Z1xuXHQgKi9cblx0IG5ldyBTdGF0aW8oe1xuXHQgXHR1cmwgOiBsb2NhdGlvbi5ocmVmLFxuXHQgXHRmYWtlIDogdHJ1ZSxcblx0IFx0cmVwbGFjZSA6IHRydWVcblx0IH0pO1xuXG5cdC8qKlxuXHQgKiBwb3BzdGF0ZSBldmVudFxuXHQgKi9cblx0IHdpbmRvdy5vbnBvcHN0YXRlID0gZnVuY3Rpb24oZXZlbnQpe1xuXHQgXHRuZXcgU3RhdGlvKHtcblx0IFx0XHR1cmwgOiBsb2NhdGlvbi5ocmVmLFxuXHQgXHRcdHJlcGxhY2UgOiB0cnVlXG5cdCBcdH0pO1xuXHQgfTtcbn0pKCk7IiwiXG4vLyBDb3B5cmlnaHQgMjAxMy0yMDE0IEtldmluIENveFxuXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcbiogIFRoaXMgc29mdHdhcmUgaXMgcHJvdmlkZWQgJ2FzLWlzJywgd2l0aG91dCBhbnkgZXhwcmVzcyBvciBpbXBsaWVkICAgICAgICAgICAqXG4qICB3YXJyYW50eS4gSW4gbm8gZXZlbnQgd2lsbCB0aGUgYXV0aG9ycyBiZSBoZWxkIGxpYWJsZSBmb3IgYW55IGRhbWFnZXMgICAgICAgKlxuKiAgYXJpc2luZyBmcm9tIHRoZSB1c2Ugb2YgdGhpcyBzb2Z0d2FyZS4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcbiogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXG4qICBQZXJtaXNzaW9uIGlzIGdyYW50ZWQgdG8gYW55b25lIHRvIHVzZSB0aGlzIHNvZnR3YXJlIGZvciBhbnkgcHVycG9zZSwgICAgICAgKlxuKiAgaW5jbHVkaW5nIGNvbW1lcmNpYWwgYXBwbGljYXRpb25zLCBhbmQgdG8gYWx0ZXIgaXQgYW5kIHJlZGlzdHJpYnV0ZSBpdCAgICAgICpcbiogIGZyZWVseSwgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIHJlc3RyaWN0aW9uczogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXG4qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxuKiAgMS4gVGhlIG9yaWdpbiBvZiB0aGlzIHNvZnR3YXJlIG11c3Qgbm90IGJlIG1pc3JlcHJlc2VudGVkOyB5b3UgbXVzdCBub3QgICAgICpcbiogICAgIGNsYWltIHRoYXQgeW91IHdyb3RlIHRoZSBvcmlnaW5hbCBzb2Z0d2FyZS4gSWYgeW91IHVzZSB0aGlzIHNvZnR3YXJlIGluICAqXG4qICAgICBhIHByb2R1Y3QsIGFuIGFja25vd2xlZGdtZW50IGluIHRoZSBwcm9kdWN0IGRvY3VtZW50YXRpb24gd291bGQgYmUgICAgICAgKlxuKiAgICAgYXBwcmVjaWF0ZWQgYnV0IGlzIG5vdCByZXF1aXJlZC4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcbiogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXG4qICAyLiBBbHRlcmVkIHNvdXJjZSB2ZXJzaW9ucyBtdXN0IGJlIHBsYWlubHkgbWFya2VkIGFzIHN1Y2gsIGFuZCBtdXN0IG5vdCBiZSAgKlxuKiAgICAgbWlzcmVwcmVzZW50ZWQgYXMgYmVpbmcgdGhlIG9yaWdpbmFsIHNvZnR3YXJlLiAgICAgICAgICAgICAgICAgICAgICAgICAgICpcbiogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXG4qICAzLiBUaGlzIG5vdGljZSBtYXkgbm90IGJlIHJlbW92ZWQgb3IgYWx0ZXJlZCBmcm9tIGFueSBzb3VyY2UgZGlzdHJpYnV0aW9uLiAgKlxuKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbitmdW5jdGlvbigpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBhcnJheSA9IC9cXFsoW15cXFtdKilcXF0kLztcblxuLy8vIFVSTCBSZWdleC5cbi8qKlxuICogVGhpcyByZWdleCBzcGxpdHMgdGhlIFVSTCBpbnRvIHBhcnRzLiAgVGhlIGNhcHR1cmUgZ3JvdXBzIGNhdGNoIHRoZSBpbXBvcnRhbnRcbiAqIGJpdHMuXG4gKlxuICogRWFjaCBzZWN0aW9uIGlzIG9wdGlvbmFsLCBzbyB0byB3b3JrIG9uIGFueSBwYXJ0IGZpbmQgdGhlIGNvcnJlY3QgdG9wIGxldmVsXG4gKiBgKC4uLik/YCBhbmQgbWVzcyBhcm91bmQgd2l0aCBpdC5cbiAqL1xudmFyIHJlZ2V4ID0gL14oPzooW2Etel0qKTopPyg/OlxcL1xcLyk/KD86KFteOkBdKikoPzo6KFteQF0qKSk/QCk/KFswLTlhLXotLl9dKyk/KD86OihbMC05XSopKT8oXFwvW14/I10qKT8oPzpcXD8oW14jXSopKT8oPzojKC4qKSk/JC9pO1xuLy8gICAgICAgICAgICAgICAxIC0gc2NoZW1lICAgICAgICAgICAgICAyIC0gdXNlciAgICAzID0gcGFzcyAgICA0IC0gaG9zdCAgICAgICAgICAgNSAtIHBvcnQgIDYgLSBwYXRoICAgICAgICA3IC0gcXVlcnkgICAgOCAtIGhhc2hcblxudmFyIG5vc2xhc2ggPSBbXCJtYWlsdG9cIixcImJpdGNvaW5cIl07XG5cbnZhciBzZWxmID0ge1xuXHQvKiogUGFyc2UgYSBxdWVyeSBzdHJpbmcuXG5cdCAqXG5cdCAqIFRoaXMgZnVuY3Rpb24gcGFyc2VzIGEgcXVlcnkgc3RyaW5nIChzb21ldGltZXMgY2FsbGVkIHRoZSBzZWFyY2hcblx0ICogc3RyaW5nKS4gIEl0IHRha2VzIGEgcXVlcnkgc3RyaW5nIGFuZCByZXR1cm5zIGEgbWFwIG9mIHRoZSByZXN1bHRzLlxuXHQgKlxuXHQgKiBLZXlzIGFyZSBjb25zaWRlcmVkIHRvIGJlIGV2ZXJ5dGhpbmcgdXAgdG8gdGhlIGZpcnN0ICc9JyBhbmQgdmFsdWVzIGFyZVxuXHQgKiBldmVyeXRoaW5nIGFmdGVyd29yZHMuICBTaW5jZSBVUkwtZGVjb2RpbmcgaXMgZG9uZSBhZnRlciBwYXJzaW5nLCBrZXlzXG5cdCAqIGFuZCB2YWx1ZXMgY2FuIGhhdmUgYW55IHZhbHVlcywgaG93ZXZlciwgJz0nIGhhdmUgdG8gYmUgZW5jb2RlZCBpbiBrZXlzXG5cdCAqIHdoaWxlICc/JyBhbmQgJyYnIGhhdmUgdG8gYmUgZW5jb2RlZCBhbnl3aGVyZSAoYXMgdGhleSBkZWxpbWl0IHRoZVxuXHQgKiBrdi1wYWlycykuXG5cdCAqXG5cdCAqIEtleXMgYW5kIHZhbHVlcyB3aWxsIGFsd2F5cyBiZSBzdHJpbmdzLCBleGNlcHQgaWYgdGhlcmUgaXMgYSBrZXkgd2l0aCBub1xuXHQgKiAnPScgaW4gd2hpY2ggY2FzZSBpdCB3aWxsIGJlIGNvbnNpZGVyZWQgYSBmbGFnIGFuZCB3aWxsIGJlIHNldCB0byB0cnVlLlxuXHQgKiBMYXRlciB2YWx1ZXMgd2lsbCBvdmVycmlkZSBlYXJsaWVyIHZhbHVlcy5cblx0ICpcblx0ICogQXJyYXkga2V5cyBhcmUgYWxzbyBzdXBwb3J0ZWQuICBCeSBkZWZhdWx0IGtleXMgaW4gdGhlIGZvcm0gb2YgYG5hbWVbaV1gXG5cdCAqIHdpbGwgYmUgcmV0dXJuZWQgbGlrZSB0aGF0IGFzIHN0cmluZ3MuICBIb3dldmVyLCBpZiB5b3Ugc2V0IHRoZSBgYXJyYXlgXG5cdCAqIGZsYWcgaW4gdGhlIG9wdGlvbnMgb2JqZWN0IHRoZXkgd2lsbCBiZSBwYXJzZWQgaW50byBhcnJheXMuICBOb3RlIHRoYXRcblx0ICogYWx0aG91Z2ggdGhlIG9iamVjdCByZXR1cm5lZCBpcyBhbiBgQXJyYXlgIG9iamVjdCBhbGwga2V5cyB3aWxsIGJlXG5cdCAqIHdyaXR0ZW4gdG8gaXQuICBUaGlzIG1lYW5zIHRoYXQgaWYgeW91IGhhdmUgYSBrZXkgc3VjaCBhcyBga1tmb3JFYWNoXWBcblx0ICogaXQgd2lsbCBvdmVyd3JpdGUgdGhlIGBmb3JFYWNoYCBmdW5jdGlvbiBvbiB0aGF0IGFycmF5LiAgQWxzbyBub3RlIHRoYXRcblx0ICogc3RyaW5nIHByb3BlcnRpZXMgYWx3YXlzIHRha2UgcHJlY2VkZW5jZSBvdmVyIGFycmF5IHByb3BlcnRpZXMsXG5cdCAqIGlycmVzcGVjdGl2ZSBvZiB3aGVyZSB0aGV5IGFyZSBpbiB0aGUgcXVlcnkgc3RyaW5nLlxuXHQgKlxuXHQgKiAgIHVybC5nZXQoXCJhcnJheVsxXT10ZXN0JmFycmF5W2Zvb109YmFyXCIse2FycmF5OnRydWV9KS5hcnJheVsxXSAgPT09IFwidGVzdFwiXG5cdCAqICAgdXJsLmdldChcImFycmF5WzFdPXRlc3QmYXJyYXlbZm9vXT1iYXJcIix7YXJyYXk6dHJ1ZX0pLmFycmF5LmZvbyA9PT0gXCJiYXJcIlxuXHQgKiAgIHVybC5nZXQoXCJhcnJheT1ub3RhbmFycmF5JmFycmF5WzBdPTFcIix7YXJyYXk6dHJ1ZX0pLmFycmF5ICAgICAgPT09IFwibm90YW5hcnJheVwiXG5cdCAqXG5cdCAqIElmIGFycmF5IHBhcnNpbmcgaXMgZW5hYmxlZCBrZXlzIGluIHRoZSBmb3JtIG9mIGBuYW1lW11gIHdpbGxcblx0ICogYXV0b21hdGljYWxseSBiZSBnaXZlbiB0aGUgbmV4dCBhdmFpbGFibGUgaW5kZXguICBOb3RlIHRoYXQgdGhpcyBjYW4gYmVcblx0ICogb3ZlcndyaXR0ZW4gd2l0aCBsYXRlciB2YWx1ZXMgaW4gdGhlIHF1ZXJ5IHN0cmluZy4gIEZvciB0aGlzIHJlYXNvbiBpc1xuXHQgKiBpcyBiZXN0IG5vdCB0byBtaXggdGhlIHR3byBmb3JtYXRzLCBhbHRob3VnaCBpdCBpcyBzYWZlIChhbmQgb2Z0ZW5cblx0ICogdXNlZnVsKSB0byBhZGQgYW4gYXV0b21hdGljIGluZGV4IGFyZ3VtZW50IHRvIHRoZSBlbmQgb2YgYSBxdWVyeSBzdHJpbmcuXG5cdCAqXG5cdCAqICAgdXJsLmdldChcImFbXT0wJmFbXT0xJmFbMF09MlwiLCB7YXJyYXk6dHJ1ZX0pICAtPiB7YTpbXCIyXCIsXCIxXCJdfTtcblx0ICogICB1cmwuZ2V0KFwiYVswXT0wJmFbMV09MSZhW109MlwiLCB7YXJyYXk6dHJ1ZX0pIC0+IHthOltcIjBcIixcIjFcIixcIjJcIl19O1xuXHQgKlxuXHQgKiBAcGFyYW17c3RyaW5nfSBxIFRoZSBxdWVyeSBzdHJpbmcgKHRoZSBwYXJ0IGFmdGVyIHRoZSAnPycpLlxuXHQgKiBAcGFyYW17e2Z1bGw6Ym9vbGVhbixhcnJheTpib29sZWFufT19IG9wdCBPcHRpb25zLlxuXHQgKlxuXHQgKiAtIGZ1bGw6IElmIHNldCBgcWAgd2lsbCBiZSB0cmVhdGVkIGFzIGEgZnVsbCB1cmwgYW5kIGBxYCB3aWxsIGJlIGJ1aWx0LlxuXHQgKiAgIGJ5IGNhbGxpbmcgI3BhcnNlIHRvIHJldHJpZXZlIHRoZSBxdWVyeSBwb3J0aW9uLlxuXHQgKiAtIGFycmF5OiBJZiBzZXQga2V5cyBpbiB0aGUgZm9ybSBvZiBga2V5W2ldYCB3aWxsIGJlIHRyZWF0ZWRcblx0ICogICBhcyBhcnJheXMvbWFwcy5cblx0ICpcblx0ICogQHJldHVybnshT2JqZWN0LjxzdHJpbmcsIHN0cmluZ3xBcnJheT59IFRoZSBwYXJzZWQgcmVzdWx0LlxuXHQgKi9cblx0XCJnZXRcIjogZnVuY3Rpb24ocSwgb3B0KXtcblx0XHRxID0gcSB8fCBcIlwiO1xuXHRcdGlmICggdHlwZW9mIG9wdCAgICAgICAgICA9PSBcInVuZGVmaW5lZFwiICkgb3B0ID0ge307XG5cdFx0aWYgKCB0eXBlb2Ygb3B0W1wiZnVsbFwiXSAgPT0gXCJ1bmRlZmluZWRcIiApIG9wdFtcImZ1bGxcIl0gPSBmYWxzZTtcblx0XHRpZiAoIHR5cGVvZiBvcHRbXCJhcnJheVwiXSA9PSBcInVuZGVmaW5lZFwiICkgb3B0W1wiYXJyYXlcIl0gPSBmYWxzZTtcblxuXHRcdGlmICggb3B0W1wiZnVsbFwiXSA9PT0gdHJ1ZSApXG5cdFx0e1xuXHRcdFx0cSA9IHNlbGZbXCJwYXJzZVwiXShxLCB7XCJnZXRcIjpmYWxzZX0pW1wicXVlcnlcIl0gfHwgXCJcIjtcblx0XHR9XG5cblx0XHR2YXIgbyA9IHt9O1xuXG5cdFx0dmFyIGMgPSBxLnNwbGl0KFwiJlwiKTtcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGMubGVuZ3RoOyBpKyspXG5cdFx0e1xuXHRcdFx0aWYgKCFjW2ldLmxlbmd0aCkgY29udGludWU7XG5cblx0XHRcdHZhciBkID0gY1tpXS5pbmRleE9mKFwiPVwiKTtcblx0XHRcdHZhciBrID0gY1tpXSwgdiA9IHRydWU7XG5cdFx0XHRpZiAoIGQgPj0gMCApXG5cdFx0XHR7XG5cdFx0XHRcdGsgPSBjW2ldLnN1YnN0cigwLCBkKTtcblx0XHRcdFx0diA9IGNbaV0uc3Vic3RyKGQrMSk7XG5cblx0XHRcdFx0diA9IGRlY29kZVVSSUNvbXBvbmVudCh2KTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKG9wdFtcImFycmF5XCJdKVxuXHRcdFx0e1xuXHRcdFx0XHR2YXIgaW5kcyA9IFtdO1xuXHRcdFx0XHR2YXIgaW5kO1xuXHRcdFx0XHR2YXIgY3VybyA9IG87XG5cdFx0XHRcdHZhciBjdXJrID0gaztcblx0XHRcdFx0d2hpbGUgKGluZCA9IGN1cmsubWF0Y2goYXJyYXkpKSAvLyBBcnJheSFcblx0XHRcdFx0e1xuXHRcdFx0XHRcdGN1cmsgPSBjdXJrLnN1YnN0cigwLCBpbmQuaW5kZXgpO1xuXHRcdFx0XHRcdGluZHMudW5zaGlmdChkZWNvZGVVUklDb21wb25lbnQoaW5kWzFdKSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0Y3VyayA9IGRlY29kZVVSSUNvbXBvbmVudChjdXJrKTtcblx0XHRcdFx0aWYgKGluZHMuc29tZShmdW5jdGlvbihpKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0aWYgKCB0eXBlb2YgY3Vyb1tjdXJrXSA9PSBcInVuZGVmaW5lZFwiICkgY3Vyb1tjdXJrXSA9IFtdO1xuXHRcdFx0XHRcdGlmICghQXJyYXkuaXNBcnJheShjdXJvW2N1cmtdKSlcblx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHQvL2NvbnNvbGUubG9nKFwidXJsLmdldDogQXJyYXkgcHJvcGVydHkgXCIrY3VyaytcIiBhbHJlYWR5IGV4aXN0cyBhcyBzdHJpbmchXCIpO1xuXHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Y3VybyA9IGN1cm9bY3Vya107XG5cblx0XHRcdFx0XHRpZiAoIGkgPT09IFwiXCIgKSBpID0gY3Vyby5sZW5ndGg7XG5cblx0XHRcdFx0XHRjdXJrID0gaTtcblx0XHRcdFx0fSkpIGNvbnRpbnVlO1xuXHRcdFx0XHRjdXJvW2N1cmtdID0gdjtcblx0XHRcdFx0Y29udGludWU7XG5cdFx0XHR9XG5cblx0XHRcdGsgPSBkZWNvZGVVUklDb21wb25lbnQoayk7XG5cblx0XHRcdC8vdHlwZW9mIG9ba10gPT0gXCJ1bmRlZmluZWRcIiB8fCBjb25zb2xlLmxvZyhcIlByb3BlcnR5IFwiK2srXCIgYWxyZWFkeSBleGlzdHMhXCIpO1xuXHRcdFx0b1trXSA9IHY7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG87XG5cdH0sXG5cblx0LyoqIEJ1aWxkIGEgZ2V0IHF1ZXJ5IGZyb20gYW4gb2JqZWN0LlxuXHQgKlxuXHQgKiBUaGlzIGNvbnN0cnVjdHMgYSBxdWVyeSBzdHJpbmcgZnJvbSB0aGUga3YgcGFpcnMgaW4gYGRhdGFgLiAgQ2FsbGluZ1xuXHQgKiAjZ2V0IG9uIHRoZSBzdHJpbmcgcmV0dXJuZWQgc2hvdWxkIHJldHVybiBhbiBvYmplY3QgaWRlbnRpY2FsIHRvIHRoZSBvbmVcblx0ICogcGFzc2VkIGluIGV4Y2VwdCBhbGwgbm9uLWJvb2xlYW4gc2NhbGFyIHR5cGVzIGJlY29tZSBzdHJpbmdzIGFuZCBhbGxcblx0ICogb2JqZWN0IHR5cGVzIGJlY29tZSBhcnJheXMgKG5vbi1pbnRlZ2VyIGtleXMgYXJlIHN0aWxsIHByZXNlbnQsIHNlZVxuXHQgKiAjZ2V0J3MgZG9jdW1lbnRhdGlvbiBmb3IgbW9yZSBkZXRhaWxzKS5cblx0ICpcblx0ICogVGhpcyBhbHdheXMgdXNlcyBhcnJheSBzeW50YXggZm9yIGRlc2NyaWJpbmcgYXJyYXlzLiAgSWYgeW91IHdhbnQgdG9cblx0ICogc2VyaWFsaXplIHRoZW0gZGlmZmVyZW50bHkgKGxpa2UgaGF2aW5nIHRoZSB2YWx1ZSBiZSBhIEpTT04gYXJyYXkgYW5kXG5cdCAqIGhhdmUgYSBwbGFpbiBrZXkpIHlvdSB3aWxsIG5lZWQgdG8gZG8gdGhhdCBiZWZvcmUgcGFzc2luZyBpdCBpbi5cblx0ICpcblx0ICogQWxsIGtleXMgYW5kIHZhbHVlcyBhcmUgc3VwcG9ydGVkIChiaW5hcnkgZGF0YSBhbnlvbmU/KSBhcyB0aGV5IGFyZVxuXHQgKiBwcm9wZXJseSBVUkwtZW5jb2RlZCBhbmQgI2dldCBwcm9wZXJseSBkZWNvZGVzLlxuXHQgKlxuXHQgKiBAcGFyYW17T2JqZWN0fSBkYXRhIFRoZSBrdiBwYWlycy5cblx0ICogQHBhcmFte3N0cmluZ30gcHJlZml4IFRoZSBwcm9wZXJseSBlbmNvZGVkIGFycmF5IGtleSB0byBwdXQgdGhlXG5cdCAqICAgcHJvcGVydGllcy4gIE1haW5seSBpbnRlbmRlZCBmb3IgaW50ZXJuYWwgdXNlLlxuXHQgKiBAcmV0dXJue3N0cmluZ30gQSBVUkwtc2FmZSBzdHJpbmcuXG5cdCAqL1xuXHRcImJ1aWxkZ2V0XCI6IGZ1bmN0aW9uKGRhdGEsIHByZWZpeCl7XG5cdFx0dmFyIGl0bXMgPSBbXTtcblx0XHRmb3IgKCB2YXIgayBpbiBkYXRhIClcblx0XHR7XG5cdFx0XHR2YXIgZWsgPSBlbmNvZGVVUklDb21wb25lbnQoayk7XG5cdFx0XHRpZiAoIHR5cGVvZiBwcmVmaXggIT0gXCJ1bmRlZmluZWRcIiApXG5cdFx0XHRcdGVrID0gcHJlZml4K1wiW1wiK2VrK1wiXVwiO1xuXG5cdFx0XHR2YXIgdiA9IGRhdGFba107XG5cblx0XHRcdHN3aXRjaCAodHlwZW9mIHYpXG5cdFx0XHR7XG5cdFx0XHRcdGNhc2UgJ2Jvb2xlYW4nOlxuXHRcdFx0XHRcdGlmKHYpIGl0bXMucHVzaChlayk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ251bWJlcic6XG5cdFx0XHRcdFx0diA9IHYudG9TdHJpbmcoKTtcblx0XHRcdFx0Y2FzZSAnc3RyaW5nJzpcblx0XHRcdFx0XHRpdG1zLnB1c2goZWsrXCI9XCIrZW5jb2RlVVJJQ29tcG9uZW50KHYpKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnb2JqZWN0Jzpcblx0XHRcdFx0XHRpdG1zLnB1c2goc2VsZltcImJ1aWxkZ2V0XCJdKHYsIGVrKSk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBpdG1zLmpvaW4oXCImXCIpO1xuXHR9LFxuXG5cdC8qKiBQYXJzZSBhIFVSTFxuXHQgKlxuXHQgKiBUaGlzIGJyZWFrcyB1cCBhIFVSTCBpbnRvIGNvbXBvbmVudHMuICBJdCBhdHRlbXB0cyB0byBiZSB2ZXJ5IGxpYmVyYWxcblx0ICogYW5kIHJldHVybnMgdGhlIGJlc3QgcmVzdWx0IGluIG1vc3QgY2FzZXMuICBUaGlzIG1lYW5zIHRoYXQgeW91IGNhblxuXHQgKiBvZnRlbiBwYXNzIGluIHBhcnQgb2YgYSBVUkwgYW5kIGdldCBjb3JyZWN0IGNhdGVnb3JpZXMgYmFjay4gIE5vdGFibHksXG5cdCAqIHRoaXMgd29ya3MgZm9yIGVtYWlscyBhbmQgSmFiYmVyIElEcywgYXMgd2VsbCBhcyBhZGRpbmcgYSAnPycgdG8gdGhlXG5cdCAqIGJlZ2lubmluZyBvZiBhIHN0cmluZyB3aWxsIHBhcnNlIHRoZSB3aG9sZSB0aGluZyBhcyBhIHF1ZXJ5IHN0cmluZy4gIElmXG5cdCAqIGFuIGl0ZW0gaXMgbm90IGZvdW5kIHRoZSBwcm9wZXJ0eSB3aWxsIGJlIHVuZGVmaW5lZC4gIEluIHNvbWUgY2FzZXMgYW5cblx0ICogZW1wdHkgc3RyaW5nIHdpbGwgYmUgcmV0dXJuZWQgaWYgdGhlIHN1cnJvdW5kaW5nIHN5bnRheCBidXQgdGhlIGFjdHVhbFxuXHQgKiB2YWx1ZSBpcyBlbXB0eSAoZXhhbXBsZTogXCI6Ly9leGFtcGxlLmNvbVwiIHdpbGwgZ2l2ZSBhIGVtcHR5IHN0cmluZyBmb3Jcblx0ICogc2NoZW1lLikgIE5vdGFibHkgdGhlIGhvc3QgbmFtZSB3aWxsIGFsd2F5cyBiZSBzZXQgdG8gc29tZXRoaW5nLlxuXHQgKlxuXHQgKiBSZXR1cm5lZCBwcm9wZXJ0aWVzLlxuXHQgKlxuXHQgKiAtICoqc2NoZW1lOioqIFRoZSB1cmwgc2NoZW1lLiAoZXg6IFwibWFpbHRvXCIgb3IgXCJodHRwc1wiKVxuXHQgKiAtICoqdXNlcjoqKiBUaGUgdXNlcm5hbWUuXG5cdCAqIC0gKipwYXNzOioqIFRoZSBwYXNzd29yZC5cblx0ICogLSAqKmhvc3Q6KiogVGhlIGhvc3RuYW1lLiAoZXg6IFwibG9jYWxob3N0XCIsIFwiMTIzLjQ1Ni43LjhcIiBvciBcImV4YW1wbGUuY29tXCIpXG5cdCAqIC0gKipwb3J0OioqIFRoZSBwb3J0LCBhcyBhIG51bWJlci4gKGV4OiAxMzM3KVxuXHQgKiAtICoqcGF0aDoqKiBUaGUgcGF0aC4gKGV4OiBcIi9cIiBvciBcIi9hYm91dC5odG1sXCIpXG5cdCAqIC0gKipxdWVyeToqKiBcIlRoZSBxdWVyeSBzdHJpbmcuIChleDogXCJmb289YmFyJnY9MTcmZm9ybWF0PWpzb25cIilcblx0ICogLSAqKmdldDoqKiBUaGUgcXVlcnkgc3RyaW5nIHBhcnNlZCB3aXRoIGdldC4gIElmIGBvcHQuZ2V0YCBpcyBgZmFsc2VgIHRoaXNcblx0ICogICB3aWxsIGJlIGFic2VudFxuXHQgKiAtICoqaGFzaDoqKiBUaGUgdmFsdWUgYWZ0ZXIgdGhlIGhhc2guIChleDogXCJteWFuY2hvclwiKVxuXHQgKiAgIGJlIHVuZGVmaW5lZCBldmVuIGlmIGBxdWVyeWAgaXMgc2V0LlxuXHQgKlxuXHQgKiBAcGFyYW17c3RyaW5nfSB1cmwgVGhlIFVSTCB0byBwYXJzZS5cblx0ICogQHBhcmFte3tnZXQ6T2JqZWN0fT19IG9wdCBPcHRpb25zOlxuXHQgKlxuXHQgKiAtIGdldDogQW4gb3B0aW9ucyBhcmd1bWVudCB0byBiZSBwYXNzZWQgdG8gI2dldCBvciBmYWxzZSB0byBub3QgY2FsbCAjZ2V0LlxuXHQgKiAgICAqKkRPIE5PVCoqIHNldCBgZnVsbGAuXG5cdCAqXG5cdCAqIEByZXR1cm57IU9iamVjdH0gQW4gb2JqZWN0IHdpdGggdGhlIHBhcnNlZCB2YWx1ZXMuXG5cdCAqL1xuXHRcInBhcnNlXCI6IGZ1bmN0aW9uKHVybCwgb3B0KSB7XG5cblx0XHRpZiAoIHR5cGVvZiBvcHQgPT0gXCJ1bmRlZmluZWRcIiApIG9wdCA9IHt9O1xuXG5cdFx0dmFyIG1kID0gdXJsLm1hdGNoKHJlZ2V4KSB8fCBbXTtcblxuXHRcdHZhciByID0ge1xuXHRcdFx0XCJ1cmxcIjogICAgdXJsLFxuXG5cdFx0XHRcInNjaGVtZVwiOiBtZFsxXSxcblx0XHRcdFwidXNlclwiOiAgIG1kWzJdLFxuXHRcdFx0XCJwYXNzXCI6ICAgbWRbM10sXG5cdFx0XHRcImhvc3RcIjogICBtZFs0XSxcblx0XHRcdFwicG9ydFwiOiAgIG1kWzVdICYmICttZFs1XSxcblx0XHRcdFwicGF0aFwiOiAgIG1kWzZdLFxuXHRcdFx0XCJxdWVyeVwiOiAgbWRbN10sXG5cdFx0XHRcImhhc2hcIjogICBtZFs4XSxcblx0XHR9O1xuXG5cdFx0aWYgKCBvcHQuZ2V0ICE9PSBmYWxzZSApXG5cdFx0XHRyW1wiZ2V0XCJdID0gcltcInF1ZXJ5XCJdICYmIHNlbGZbXCJnZXRcIl0ocltcInF1ZXJ5XCJdLCBvcHQuZ2V0KTtcblxuXHRcdHJldHVybiByO1xuXHR9LFxuXG5cdC8qKiBCdWlsZCBhIFVSTCBmcm9tIGNvbXBvbmVudHMuXG5cdCAqXG5cdCAqIFRoaXMgcGllY2VzIHRvZ2V0aGVyIGEgdXJsIGZyb20gdGhlIHByb3BlcnRpZXMgb2YgdGhlIHBhc3NlZCBpbiBvYmplY3QuXG5cdCAqIEluIGdlbmVyYWwgcGFzc2luZyB0aGUgcmVzdWx0IG9mIGBwYXJzZSgpYCBzaG91bGQgcmV0dXJuIHRoZSBVUkwuICBUaGVyZVxuXHQgKiBtYXkgZGlmZmVyZW5jZXMgaW4gdGhlIGdldCBzdHJpbmcgYXMgdGhlIGtleXMgYW5kIHZhbHVlcyBtaWdodCBiZSBtb3JlXG5cdCAqIGVuY29kZWQgdGhlbiB0aGV5IHdlcmUgb3JpZ2luYWxseSB3ZXJlLiAgSG93ZXZlciwgY2FsbGluZyBgZ2V0KClgIG9uIHRoZVxuXHQgKiB0d28gdmFsdWVzIHNob3VsZCB5aWVsZCB0aGUgc2FtZSByZXN1bHQuXG5cdCAqXG5cdCAqIEhlcmUgaXMgaG93IHRoZSBwYXJhbWV0ZXJzIGFyZSB1c2VkLlxuXHQgKlxuXHQgKiAgLSB1cmw6IFVzZWQgb25seSBpZiBubyBvdGhlciB2YWx1ZXMgYXJlIHByb3ZpZGVkLiAgSWYgdGhhdCBpcyB0aGUgY2FzZVxuXHQgKiAgICAgYHVybGAgd2lsbCBiZSByZXR1cm5lZCB2ZXJiYXRpbS5cblx0ICogIC0gc2NoZW1lOiBVc2VkIGlmIGRlZmluZWQuXG5cdCAqICAtIHVzZXI6IFVzZWQgaWYgZGVmaW5lZC5cblx0ICogIC0gcGFzczogVXNlZCBpZiBkZWZpbmVkLlxuXHQgKiAgLSBob3N0OiBVc2VkIGlmIGRlZmluZWQuXG5cdCAqICAtIHBhdGg6IFVzZWQgaWYgZGVmaW5lZC5cblx0ICogIC0gcXVlcnk6IFVzZWQgb25seSBpZiBgZ2V0YCBpcyBub3QgcHJvdmlkZWQgYW5kIG5vbi1lbXB0eS5cblx0ICogIC0gZ2V0OiBVc2VkIGlmIG5vbi1lbXB0eS4gIFBhc3NlZCB0byAjYnVpbGRnZXQgYW5kIHRoZSByZXN1bHQgaXMgdXNlZFxuXHQgKiAgICBhcyB0aGUgcXVlcnkgc3RyaW5nLlxuXHQgKiAgLSBoYXNoOiBVc2VkIGlmIGRlZmluZWQuXG5cdCAqXG5cdCAqIFRoZXNlIGFyZSB0aGUgb3B0aW9ucyB0aGF0IGFyZSB2YWxpZCBvbiB0aGUgb3B0aW9ucyBvYmplY3QuXG5cdCAqXG5cdCAqICAtIHVzZWVtcHR5Z2V0OiBJZiB0cnV0aHksIGEgcXVlc3Rpb24gbWFyayB3aWxsIGJlIGFwcGVuZGVkIGZvciBlbXB0eSBnZXRcblx0ICogICAgc3RyaW5ncy4gIFRoaXMgbm90YWJseSBtYWtlcyBgYnVpbGQoKWAgYW5kIGBwYXJzZSgpYCBmdWxseSBzeW1tZXRyaWMuXG5cdCAqXG5cdCAqIEBwYXJhbXtPYmplY3R9IGRhdGEgVGhlIHBpZWNlcyBvZiB0aGUgVVJMLlxuXHQgKiBAcGFyYW17T2JqZWN0fSBvcHQgT3B0aW9ucyBmb3IgYnVpbGRpbmcgdGhlIHVybC5cblx0ICogQHJldHVybntzdHJpbmd9IFRoZSBVUkwuXG5cdCAqL1xuXHRcImJ1aWxkXCI6IGZ1bmN0aW9uKGRhdGEsIG9wdCl7XG5cdFx0b3B0ID0gb3B0IHx8IHt9O1xuXG5cdFx0dmFyIHIgPSBcIlwiO1xuXG5cdFx0aWYgKCB0eXBlb2YgZGF0YVtcInNjaGVtZVwiXSAhPSBcInVuZGVmaW5lZFwiIClcblx0XHR7XG5cdFx0XHRyICs9IGRhdGFbXCJzY2hlbWVcIl07XG5cdFx0XHRyICs9IChub3NsYXNoLmluZGV4T2YoZGF0YVtcInNjaGVtZVwiXSk+PTApP1wiOlwiOlwiOi8vXCI7XG5cdFx0fVxuXHRcdGlmICggdHlwZW9mIGRhdGFbXCJ1c2VyXCJdICE9IFwidW5kZWZpbmVkXCIgKVxuXHRcdHtcblx0XHRcdHIgKz0gZGF0YVtcInVzZXJcIl07XG5cdFx0XHRpZiAoIHR5cGVvZiBkYXRhW1wicGFzc1wiXSA9PSBcInVuZGVmaW5lZFwiIClcblx0XHRcdHtcblx0XHRcdFx0ciArPSBcIkBcIjtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYgKCB0eXBlb2YgZGF0YVtcInBhc3NcIl0gIT0gXCJ1bmRlZmluZWRcIiApIHIgKz0gXCI6XCIgKyBkYXRhW1wicGFzc1wiXSArIFwiQFwiO1xuXHRcdGlmICggdHlwZW9mIGRhdGFbXCJob3N0XCJdICE9IFwidW5kZWZpbmVkXCIgKSByICs9IGRhdGFbXCJob3N0XCJdO1xuXHRcdGlmICggdHlwZW9mIGRhdGFbXCJwb3J0XCJdICE9IFwidW5kZWZpbmVkXCIgKSByICs9IFwiOlwiICsgZGF0YVtcInBvcnRcIl07XG5cdFx0aWYgKCB0eXBlb2YgZGF0YVtcInBhdGhcIl0gIT0gXCJ1bmRlZmluZWRcIiApIHIgKz0gZGF0YVtcInBhdGhcIl07XG5cblx0XHRpZiAob3B0W1widXNlZW1wdHlnZXRcIl0pXG5cdFx0e1xuXHRcdFx0aWYgICAgICAoIHR5cGVvZiBkYXRhW1wiZ2V0XCJdICAgIT0gXCJ1bmRlZmluZWRcIiApIHIgKz0gXCI/XCIgKyBzZWxmW1wiYnVpbGRnZXRcIl0oZGF0YVtcImdldFwiXSk7XG5cdFx0XHRlbHNlIGlmICggdHlwZW9mIGRhdGFbXCJxdWVyeVwiXSAhPSBcInVuZGVmaW5lZFwiICkgciArPSBcIj9cIiArIGRhdGFbXCJxdWVyeVwiXTtcblx0XHR9XG5cdFx0ZWxzZVxuXHRcdHtcblx0XHRcdC8vIElmIC5nZXQgdXNlIGl0LiAgSWYgLmdldCBsZWFkcyB0byBlbXB0eSwgdXNlIC5xdWVyeS5cblx0XHRcdHZhciBxID0gZGF0YVtcImdldFwiXSAmJiBzZWxmW1wiYnVpbGRnZXRcIl0oZGF0YVtcImdldFwiXSkgfHwgZGF0YVtcInF1ZXJ5XCJdO1xuXHRcdFx0aWYgKHEpIHIgKz0gXCI/XCIgKyBxO1xuXHRcdH1cblxuXHRcdGlmICggdHlwZW9mIGRhdGFbXCJoYXNoXCJdICE9IFwidW5kZWZpbmVkXCIgKSByICs9IFwiI1wiICsgZGF0YVtcImhhc2hcIl07XG5cblx0XHRyZXR1cm4gciB8fCBkYXRhW1widXJsXCJdIHx8IFwiXCI7XG5cdH0sXG59O1xuXG5pZiAoIHR5cGVvZiBkZWZpbmUgIT0gXCJ1bmRlZmluZWRcIiAmJiBkZWZpbmVbXCJhbWRcIl0gKSBkZWZpbmUoc2VsZik7XG5lbHNlIGlmICggdHlwZW9mIG1vZHVsZSAhPSBcInVuZGVmaW5lZFwiICkgbW9kdWxlWydleHBvcnRzJ10gPSBzZWxmO1xuZWxzZSB3aW5kb3dbXCJ1cmxcIl0gPSBzZWxmO1xuXG59KCk7IiwiY29uc3QgYXNpZGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYXNpZGUnKTtcbmNvbnN0IGFzaWRlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2FzaWRlLWJ0bicpO1xuZnVuY3Rpb24gaGFuZGxlQXNpZGUoZXZlbnQpIHtcbiAgICBhc2lkZS5jbGFzc0xpc3QuYWRkKCdvcGVuJyk7XG59XG5pZiAoYXNpZGVCdG4pXG57XG4gICAgYXNpZGVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVBc2lkZSk7XG59XG5cbmNvbnN0IHByb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZScpO1xuXG5pZiAocHJvZmlsZSlcbntcbiAgICBjb25zdCBkcm9wZG93biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlLWRyb3Bkb3duJyk7XG5cbiAgICBmdW5jdGlvbiBoYW5kbGVQcm9maWxlQ2xpY2soZXZlbnQpIHtcbiAgICAgICAgZHJvcGRvd24uY2xhc3NMaXN0LmFkZCgnb3BlbicpO1xuICAgIH1cbiAgICBwcm9maWxlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlUHJvZmlsZUNsaWNrKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICBpZiAoIWV2ZW50LnRhcmdldC5jbG9zZXN0KCcucHJvZmlsZS1kaXYnKSkge1xuICAgICAgICAgICAgZHJvcGRvd24uY2xhc3NMaXN0LnJlbW92ZSgnb3BlbicpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJyNhc2lkZScpICYmICFldmVudC50YXJnZXQuY2xvc2VzdCgnI2FzaWRlLWJ0bicpKSB7XG4gICAgICAgICAgICBhc2lkZS5jbGFzc0xpc3QucmVtb3ZlKCdvcGVuJyk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxuXG5hbTRjb3JlLnJlYWR5KGZ1bmN0aW9uICgpIHtcblxuICAgIC8vIFRoZW1lcyBiZWdpblxuICAgIGFtNGNvcmUudXNlVGhlbWUoYW00dGhlbWVzX2FtY2hhcnRzKTtcbiAgICAvLyBUaGVtZXMgZW5kXG5cbiAgICAvLyBDcmVhdGUgY2hhcnQgaW5zdGFuY2VcbiAgICB2YXIgY2hhcnQgPSBhbTRjb3JlLmNyZWF0ZShcImNoYXJ0ZGl2XCIsIGFtNGNoYXJ0cy5YWUNoYXJ0KTtcblxuICAgIGNoYXJ0LnJ0bCA9IHRydWU7XG5cbiAgICAvLyBBZGQgZGF0YVxuICAgIGNoYXJ0LmRhdGEgPSBbe1xuICAgICAgICBcImNvdW50cnlcIjogXCJVU0FcIixcbiAgICAgICAgXCJ2aXNpdHNcIjogMjAyNVxuICAgIH0sIHtcbiAgICAgICAgXCJjb3VudHJ5XCI6IFwiQ2hpbmFcIixcbiAgICAgICAgXCJ2aXNpdHNcIjogMTg4MlxuICAgIH0sIHtcbiAgICAgICAgXCJjb3VudHJ5XCI6IFwiSmFwYW5cIixcbiAgICAgICAgXCJ2aXNpdHNcIjogMTgwOVxuICAgIH0sIHtcbiAgICAgICAgXCJjb3VudHJ5XCI6IFwiR2VybWFueVwiLFxuICAgICAgICBcInZpc2l0c1wiOiAxMzIyXG4gICAgfSwge1xuICAgICAgICBcImNvdW50cnlcIjogXCJVS1wiLFxuICAgICAgICBcInZpc2l0c1wiOiAxMTIyXG4gICAgfSwge1xuICAgICAgICBcImNvdW50cnlcIjogXCJGcmFuY2VcIixcbiAgICAgICAgXCJ2aXNpdHNcIjogMTExNFxuICAgIH0sIHtcbiAgICAgICAgXCJjb3VudHJ5XCI6IFwiSW5kaWFcIixcbiAgICAgICAgXCJ2aXNpdHNcIjogOTg0XG4gICAgfSwge1xuICAgICAgICBcImNvdW50cnlcIjogXCJTcGFpblwiLFxuICAgICAgICBcInZpc2l0c1wiOiA3MTFcbiAgICB9LCB7XG4gICAgICAgIFwiY291bnRyeVwiOiBcIk5ldGhlcmxhbmRzXCIsXG4gICAgICAgIFwidmlzaXRzXCI6IDY2NVxuICAgIH0sIHtcbiAgICAgICAgXCJjb3VudHJ5XCI6IFwiUnVzc2lhXCIsXG4gICAgICAgIFwidmlzaXRzXCI6IDU4MFxuICAgIH0sIHtcbiAgICAgICAgXCJjb3VudHJ5XCI6IFwiU291dGggS29yZWFcIixcbiAgICAgICAgXCJ2aXNpdHNcIjogNDQzXG4gICAgfSwge1xuICAgICAgICBcImNvdW50cnlcIjogXCJDYW5hZGFcIixcbiAgICAgICAgXCJ2aXNpdHNcIjogNDQxXG4gICAgfSwge1xuICAgICAgICBcImNvdW50cnlcIjogXCJCcmF6aWxcIixcbiAgICAgICAgXCJ2aXNpdHNcIjogMzk1XG4gICAgfV07XG5cbiAgICAvLyBDcmVhdGUgYXhlc1xuXG4gICAgdmFyIGNhdGVnb3J5QXhpcyA9IGNoYXJ0LnhBeGVzLnB1c2gobmV3IGFtNGNoYXJ0cy5DYXRlZ29yeUF4aXMoKSk7XG4gICAgY2F0ZWdvcnlBeGlzLmRhdGFGaWVsZHMuY2F0ZWdvcnkgPSBcImNvdW50cnlcIjtcbiAgICBjYXRlZ29yeUF4aXMucmVuZGVyZXIuZ3JpZC50ZW1wbGF0ZS5sb2NhdGlvbiA9IDA7XG4gICAgY2F0ZWdvcnlBeGlzLnJlbmRlcmVyLm1pbkdyaWREaXN0YW5jZSA9IDMwO1xuXG4gICAgY2F0ZWdvcnlBeGlzLnJlbmRlcmVyLmxhYmVscy50ZW1wbGF0ZS5hZGFwdGVyLmFkZChcImR5XCIsIGZ1bmN0aW9uIChkeSwgdGFyZ2V0KSB7XG4gICAgICAgIGlmICh0YXJnZXQuZGF0YUl0ZW0gJiYgdGFyZ2V0LmRhdGFJdGVtLmluZGV4ICYgMiA9PSAyKSB7XG4gICAgICAgICAgICByZXR1cm4gZHkgKyAyNTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZHk7XG4gICAgfSk7XG5cbiAgICB2YXIgdmFsdWVBeGlzID0gY2hhcnQueUF4ZXMucHVzaChuZXcgYW00Y2hhcnRzLlZhbHVlQXhpcygpKTtcblxuICAgIC8vIENyZWF0ZSBzZXJpZXNcbiAgICB2YXIgc2VyaWVzID0gY2hhcnQuc2VyaWVzLnB1c2gobmV3IGFtNGNoYXJ0cy5Db2x1bW5TZXJpZXMoKSk7XG4gICAgc2VyaWVzLmRhdGFGaWVsZHMudmFsdWVZID0gXCJ2aXNpdHNcIjtcbiAgICBzZXJpZXMuZGF0YUZpZWxkcy5jYXRlZ29yeVggPSBcImNvdW50cnlcIjtcbiAgICBzZXJpZXMubmFtZSA9IFwiVmlzaXRzXCI7XG4gICAgc2VyaWVzLmNvbHVtbnMudGVtcGxhdGUudG9vbHRpcFRleHQgPSBcIntjYXRlZ29yeVh9OiBbYm9sZF17dmFsdWVZfVsvXVwiO1xuICAgIHNlcmllcy5jb2x1bW5zLnRlbXBsYXRlLmZpbGxPcGFjaXR5ID0gLjg7XG5cbiAgICB2YXIgY29sdW1uVGVtcGxhdGUgPSBzZXJpZXMuY29sdW1ucy50ZW1wbGF0ZTtcbiAgICBjb2x1bW5UZW1wbGF0ZS5zdHJva2VXaWR0aCA9IDI7XG4gICAgY29sdW1uVGVtcGxhdGUuc3Ryb2tlT3BhY2l0eSA9IDE7XG5cbn0pOyAvLyBlbmQgYW00Y29yZS5yZWFkeSgpXG5cbiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xuICAgICQoJy5zZWxlY3QyJykuc2VsZWN0MigpO1xufSk7XG5cbmZ1bmN0aW9uIHJlYWRVUkwoaW5wdXQpIHtcbiAgICBpZiAoaW5wdXQuZmlsZXMgJiYgaW5wdXQuZmlsZXNbMF0pIHtcbiAgICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG5cbiAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICQoaW5wdXQpLm5leHQoJ2xhYmVsJykuY2hpbGRyZW4oJ2ltZycpLmF0dHIoJ3NyYycsIGUudGFyZ2V0LnJlc3VsdCk7XG4gICAgICAgIH1cblxuICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChpbnB1dC5maWxlc1swXSk7XG4gICAgfVxuICB9XG5cbiQoJy5pbnB1dC1hdmF0YXInKS5jaGFuZ2UoZnVuY3Rpb24oKSB7XG4gICAgcmVhZFVSTCh0aGlzKTtcbn0pOyIsIlxudmFyIGRhdGVwaWNrZXIgPSBmdW5jdGlvbiAoZWxlbWVudElELCBvcHQpIHtcblxuICAgIC8vIGNoZWNrIGFyZ3VtZW50c1xuICAgIGlmICh0eXBlb2YgZWxlbWVudElEICE9PSBcInN0cmluZ1wiIHx8IGVsZW1lbnRJRC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcImRhdGVwaWNrZXIgZXJyb3I6IGlucHV0IElEIGlzIG5vdCBzdHJpbmcgb3IgaXMgZW1wdHlcIik7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIG9wdGlvbnMgPSBvcHQgfHwge307XG5cbiAgICAvLyB2YXJpYWJsZXNcbiAgICB2YXIgaXNDYWxDbGlja2VkID0gZmFsc2U7XG4gICAgdmFyIGlzU3luY2VkID0gZmFsc2U7XG5cbiAgICB2YXIgZGF5T2ZXZWVrO1xuXG4gICAgdmFyIHNlbGVjdGVkWWVhcjtcbiAgICB2YXIgc2VsZWN0ZWRNb250aDtcbiAgICB2YXIgc2VsZWN0ZWREYXk7XG5cbiAgICB2YXIgY3VycmVudFllYXI7XG4gICAgdmFyIGN1cnJlbnRNb250aDtcbiAgICB2YXIgY3VycmVudERheTtcblxuICAgIHZhciB0b2RheXNZZWFyO1xuICAgIHZhciB0b2RheXNNb250aDtcbiAgICB2YXIgdG9kYXlzRGF5O1xuXG4gICAgdmFyIGRheU9mV2Vla0o7XG5cbiAgICB2YXIgbnVtYmVyT2ZEYXlzO1xuXG4gICAgdmFyIHRvZGF5RztcbiAgICB2YXIgdG9kYXlzSjtcblxuICAgIC8vIGNvbnN0c1xuICAgIHZhciBNT05USF9OQU1FUyA9IHtcbiAgICAgICAgXCIxXCI6IFwi2YHYsdmI2LHYr9uM2YZcIlxuICAgICAgICAsIFwiMlwiOiBcItin2LHYr9uM2KjZh9i02KpcIlxuICAgICAgICAsIFwiM1wiOiBcItiu2LHYr9in2K9cIlxuICAgICAgICAsIFwiNFwiOiBcItiq24zYsVwiXG4gICAgICAgICwgXCI1XCI6IFwi2YXYsdiv2KfYr1wiXG4gICAgICAgICwgXCI2XCI6IFwi2LTZh9ix24zZiNixXCJcbiAgICAgICAgLCBcIjdcIjogXCLZhdmH2LFcIlxuICAgICAgICAsIFwiOFwiOiBcItii2KjYp9mGXCJcbiAgICAgICAgLCBcIjlcIjogXCLYotiw2LFcIlxuICAgICAgICAsIFwiMTBcIjogXCLYr9uMXCJcbiAgICAgICAgLCBcIjExXCI6IFwi2KjZh9mF2YZcIlxuICAgICAgICAsIFwiMTJcIjogXCLYp9iz2YHZhtivXCJcbiAgICB9XG4gICAgdmFyIERBWV9OQU1FUyA9IHtcbiAgICAgICAgXCLYtNmG2KjZh1wiOiBcIti0XCJcbiAgICAgICAgLCBcItuM2qnYtNmG2KjZh1wiOiBcItuMXCJcbiAgICAgICAgLCBcItiv2YjYtNmG2KjZh1wiOiBcItivXCJcbiAgICAgICAgLCBcItiz2Ycg2LTZhtio2YdcIjogXCLYs1wiXG4gICAgICAgICwgXCLahtmH2KfYsdi02YbYqNmHXCI6IFwi2oZcIlxuICAgICAgICAsIFwi2b7ZhtisINi02YbYqNmHXCI6IFwi2b5cIlxuICAgICAgICAsIFwi2KzZhdi52YdcIjogXCLYrFwiXG4gICAgfTtcbiAgICB2YXIgRkFfTlVNUyA9IFsn2aAnLCAn2aEnLCAn2aInLCAn2aMnLCAn27QnLCAn27UnLCAn27YnLCAn2acnLCAn2agnLCAn2aknLCAn2aHZoCcsICfZodmhJywgJ9mh2aInLCAn2aHZoycsICfZodu0JywgJ9mh27UnLCAn2aHbticsICfZodmnJywgJ9mh2agnLCAn2aHZqScsICfZotmgJywgJ9mi2aEnLCAn2aLZoicsICfZotmjJywgJ9mi27QnLCAn2aLbtScsICfZotu2JywgJ9mi2acnLCAn2aLZqCcsICfZotmpJywgJ9mj2aAnLCAn2aPZoScsICfZo9miJ107XG5cbiAgICAvLyBzZXQgb3B0aW9uc1xuICAgIG9wdGlvbnMucGxhY2Vob2xkZXIgPSBvcHRpb25zLnBsYWNlaG9sZGVyICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLnBsYWNlaG9sZGVyIDogXCJcIjtcbiAgICBvcHRpb25zLnR3b2RpZ2l0ID0gb3B0aW9ucy50d29kaWdpdCAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy50d29kaWdpdCA6IHRydWU7XG4gICAgb3B0aW9ucy5jbG9zZUFmdGVyU2VsZWN0ID0gb3B0aW9ucy5jbG9zZUFmdGVyU2VsZWN0ICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmNsb3NlQWZ0ZXJTZWxlY3QgOiB0cnVlO1xuICAgIG9wdGlvbnMubmV4dEJ1dHRvbkljb24gPSBvcHRpb25zLm5leHRCdXR0b25JY29uICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLm5leHRCdXR0b25JY29uIDogZmFsc2U7XG4gICAgb3B0aW9ucy5wcmV2aW91c0J1dHRvbkljb24gPSBvcHRpb25zLnByZXZpb3VzQnV0dG9uSWNvbiAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5wcmV2aW91c0J1dHRvbkljb24gOiBmYWxzZTtcbiAgICBvcHRpb25zLmJ1dHRvbnNDb2xvciA9IG9wdGlvbnMuYnV0dG9uc0NvbG9yICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmJ1dHRvbnNDb2xvciA6IGZhbHNlO1xuICAgIG9wdGlvbnMuZm9yY2VGYXJzaURpZ2l0cyA9IG9wdGlvbnMuZm9yY2VGYXJzaURpZ2l0cyAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5mb3JjZUZhcnNpRGlnaXRzIDogZmFsc2U7XG4gICAgb3B0aW9ucy5tYXJrVG9kYXkgPSBvcHRpb25zLm1hcmtUb2RheSAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5tYXJrVG9kYXkgOiBmYWxzZTtcbiAgICBvcHRpb25zLm1hcmtIb2xpZGF5cyA9IG9wdGlvbnMubWFya0hvbGlkYXlzICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLm1hcmtIb2xpZGF5cyA6IGZhbHNlO1xuICAgIG9wdGlvbnMuaGlnaGxpZ2h0U2VsZWN0ZWREYXkgPSBvcHRpb25zLmhpZ2hsaWdodFNlbGVjdGVkRGF5ICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmhpZ2hsaWdodFNlbGVjdGVkRGF5IDogZmFsc2U7XG4gICAgb3B0aW9ucy5zeW5jID0gb3B0aW9ucy5zeW5jICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLnN5bmMgOiBmYWxzZTtcbiAgICBvcHRpb25zLmdvdG9Ub2RheSA9IG9wdGlvbnMuZ290b1RvZGF5ICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmdvdG9Ub2RheSA6IGZhbHNlO1xuXG4gICAgLy8gY3JlYXRlIERPTVxuICAgIHZhciBpbnB1dEVsZW1lbnQgPSAkKFwiI1wiICsgZWxlbWVudElEKTtcblxuICAgIGlmIChpbnB1dEVsZW1lbnQuYXR0cihcInBsYWNlaG9sZGVyXCIpID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgaW5wdXRFbGVtZW50LmF0dHIoXCJwbGFjZWhvbGRlclwiLCBvcHRpb25zLnBsYWNlaG9sZGVyKTtcbiAgICB9XG5cbiAgICAvLyBjcmVhdGUgcGFyZW50IGRpdlxuICAgIGlucHV0RWxlbWVudC53cmFwKFwiPGRpdiBpZD0nYmQtcm9vdC1cIiArIGVsZW1lbnRJRCArIFwiJyBzdHlsZT0ncG9zaXRpb246IHJlbGF0aXZlOyc+PC9kaXY+XCIpO1xuXG4gICAgLy8gY3JlYXRlIG1haW4gZGl2IGZvciBjYWxlbmRhciwgYmVsb3cgaW5wdXQgZWxlbWVudFxuICAgIGlucHV0RWxlbWVudC5hZnRlcihcIjxkaXYgaWQ9J2JkLW1haW4tXCIgKyBlbGVtZW50SUQgKyBcIicgY2xhc3M9J2JkLW1haW4gYmQtaGlkZScgc3R5bGU9J3Bvc2l0aW9uOiBhYnNvbHV0ZTsgZGlyZWN0aW9uOiBydGw7Jz48L2Rpdj5cIik7XG4gICAgdmFyIG1haW5EaXYgPSAkKFwiI2JkLW1haW4tXCIgKyBlbGVtZW50SUQpO1xuXG4gICAgLy8gY3JlYXRlIGNhbGVuZGFyIGRpdiBpbnNpZGUgbWFpbiBkaXZcbiAgICBtYWluRGl2LmFwcGVuZChcIjxkaXYgY2xhc3M9J2JkLWNhbGVuZGFyJz48L2Rpdj5cIik7XG4gICAgdmFyIGNhbGVuZGFyRGl2ID0gbWFpbkRpdi5maW5kKCcuYmQtY2FsZW5kYXInKTtcblxuICAgIC8vIGNyZWF0ZSB0aXRsZSBkaXYgYW5kIHRhYmxlIGluc2lkZSBjYWxlbmRhciBkaXZcbiAgICBjYWxlbmRhckRpdi5hcHBlbmQoXCI8ZGl2IGNsYXNzPSdiZC10aXRsZSc+PC9kaXY+XCIpO1xuICAgIHZhciB0aXRsZURpdiA9IGNhbGVuZGFyRGl2LmZpbmQoJy5iZC10aXRsZScpO1xuICAgIGNhbGVuZGFyRGl2LmFwcGVuZChcIjx0YWJsZSBjbGFzcz0nYmQtdGFibGUnIGRpcj0ncnRsJyBjZWxsc3BhY2luZz0nMCcgY2VsbHBhZGRpbmc9JzAnPjwvdGFibGU+XCIpO1xuXG4gICAgLy8gY3JlYXRlIG1vbnRoIGFuZCB5ZWFyIGRyb3AgZG93bnMgYW5kIG5leHQvcHJldiBtb250aCBidXR0b25zIGluc2lkZSB0aXRsZSBkaXZcbiAgICB0aXRsZURpdi5hcHBlbmQoXCI8YnV0dG9uIGlkPSdiZC1uZXh0LVwiICsgZWxlbWVudElEICsgXCInIGNsYXNzPSdiZC1uZXh0JyB0eXBlPSdidXR0b24nIHRpdGxlPSfZhdin2Ycg2KjYudiv24wnIGRhdGEtdG9nZ2xlPSd0b29sdGlwJz48c3Bhbj7YqNi52K/bjDwvc3Bhbj48L2J1dHRvbj5cIik7XG4gICAgdmFyIG5leHRNb250aCA9ICQoXCIjYmQtbmV4dC1cIiArIGVsZW1lbnRJRCk7XG4gICAgaWYgKG9wdGlvbnMubmV4dEJ1dHRvbkljb24pIHtcbiAgICAgICAgbmV4dE1vbnRoLmZpbmQoXCJzcGFuXCIpLmNzcyhcImRpc3BsYXlcIiwgXCJub25lXCIpO1xuICAgICAgICBpZiAob3B0aW9ucy5uZXh0QnV0dG9uSWNvbi5pbmRleE9mKFwiLlwiKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIC8vIGltYWdlXG4gICAgICAgICAgICBuZXh0TW9udGguY3NzKFwiYmFja2dyb3VuZC1pbWFnZVwiLCBcInVybChcIiArIG9wdGlvbnMubmV4dEJ1dHRvbkljb24gKyBcIilcIik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBjc3MgY2xhc3NcbiAgICAgICAgICAgIG5leHRNb250aC5hZGRDbGFzcyhvcHRpb25zLm5leHRCdXR0b25JY29uKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHRpdGxlRGl2LmFwcGVuZChcIjxkaXYgY2xhc3M9J2JkLWRyb3Bkb3duJz48L2Rpdj48ZGl2IGNsYXNzPSdiZC1kcm9wZG93bic+PC9kaXY+XCIpO1xuXG4gICAgdGl0bGVEaXYuZmluZCgnLmJkLWRyb3Bkb3duOm50aC1jaGlsZCgyKScpLmFwcGVuZChcIjxzZWxlY3QgaWQ9J2JkLW1vbnRoLVwiICsgZWxlbWVudElEICsgXCInIGNsYXNzPSdiZC1tb250aCc+PC9zZWxlY3Q+XCIpO1xuICAgIHZhciBtb250aERyb3Bkb3duID0gJChcIiNiZC1tb250aC1cIiArIGVsZW1lbnRJRCk7XG4gICAgJC5lYWNoKE1PTlRIX05BTUVTLCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xuICAgICAgICBtb250aERyb3Bkb3duLmFwcGVuZCgkKFwiPG9wdGlvbj48L29wdGlvbj5cIikuYXR0cihcInZhbHVlXCIsIGtleSkudGV4dCh2YWx1ZSkpO1xuICAgIH0pO1xuXG4gICAgdGl0bGVEaXYuZmluZCgnLmJkLWRyb3Bkb3duOm50aC1jaGlsZCgzKScpLmFwcGVuZChcIjxzZWxlY3QgaWQ9J2JkLXllYXItXCIgKyBlbGVtZW50SUQgKyBcIicgY2xhc3M9J2JkLXllYXInPjwvc2VsZWN0PlwiKTtcbiAgICB2YXIgeWVhckRyb3Bkb3duID0gJChcIiNiZC15ZWFyLVwiICsgZWxlbWVudElEKTtcblxuICAgIHRpdGxlRGl2LmFwcGVuZChcIjxidXR0b24gaWQ9J2JkLXByZXYtXCIgKyBlbGVtZW50SUQgKyBcIicgY2xhc3M9J2JkLXByZXYnIHR5cGU9J2J1dHRvbicgdGl0bGU9J9mF2KfZhyDZgtio2YTbjCcgZGF0YS10b2dnbGU9J3Rvb2x0aXAnPjxzcGFuPtmC2KjZhNuMPC9zcGFuPjwvYnV0dG9uPlwiKTtcbiAgICB2YXIgcHJldk1vbnRoID0gJChcIiNiZC1wcmV2LVwiICsgZWxlbWVudElEKTtcbiAgICBpZiAob3B0aW9ucy5uZXh0QnV0dG9uSWNvbikge1xuICAgICAgICBwcmV2TW9udGguZmluZChcInNwYW5cIikuY3NzKFwiZGlzcGxheVwiLCBcIm5vbmVcIik7XG4gICAgICAgIGlmIChvcHRpb25zLnByZXZpb3VzQnV0dG9uSWNvbi5pbmRleE9mKFwiLlwiKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIC8vIGltYWdlXG4gICAgICAgICAgICBwcmV2TW9udGguY3NzKFwiYmFja2dyb3VuZC1pbWFnZVwiLCBcInVybChcIiArIG9wdGlvbnMucHJldmlvdXNCdXR0b25JY29uICsgXCIpXCIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gY3NzIGNsYXNzXG4gICAgICAgICAgICBwcmV2TW9udGguYWRkQ2xhc3Mob3B0aW9ucy5wcmV2aW91c0J1dHRvbkljb24pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG9wdGlvbnMuYnV0dG9uc0NvbG9yKSB7XG4gICAgICAgIG5leHRNb250aC5jc3MoXCJjb2xvclwiLCBvcHRpb25zLmJ1dHRvbnNDb2xvcik7XG4gICAgICAgIG5leHRNb250aC5maW5kKFwic3BhblwiKS5jc3MoXCJjb2xvclwiLCBvcHRpb25zLmJ1dHRvbnNDb2xvcik7XG4gICAgICAgIHByZXZNb250aC5jc3MoXCJjb2xvclwiLCBvcHRpb25zLmJ1dHRvbnNDb2xvcik7XG4gICAgICAgIHByZXZNb250aC5maW5kKFwic3BhblwiKS5jc3MoXCJjb2xvclwiLCBvcHRpb25zLmJ1dHRvbnNDb2xvcik7XG4gICAgfVxuXG4gICAgLy8gY3JlYXRlIHRhYmxlIGhlYWRlciBhbmQgYm9keVxuICAgIGNhbGVuZGFyRGl2LmZpbmQoJy5iZC10YWJsZScpLmFwcGVuZChcIjx0aGVhZD48dHI+PC90cj48L3RoZWFkPlwiKTtcbiAgICAkLmVhY2goREFZX05BTUVTLCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xuICAgICAgICBjYWxlbmRhckRpdi5maW5kKCcuYmQtdGFibGUgdGhlYWQgdHInKS5hcHBlbmQoJChcIjx0aD48L3RoPlwiKS50ZXh0KHZhbHVlKSk7XG4gICAgfSk7XG5cbiAgICBjYWxlbmRhckRpdi5maW5kKCcuYmQtdGFibGUnKS5hcHBlbmQoXCI8dGJvZHkgaWQ9J2JkLXRhYmxlLWRheXMtXCIgKyBlbGVtZW50SUQgKyBcIicgY2xhc3M9J2JkLXRhYmxlLWRheXMnPjwvdGJvZHk+XCIpO1xuICAgIHZhciBkYXlzVGFibGUgPSAkKFwiI2JkLXRhYmxlLWRheXMtXCIgKyBlbGVtZW50SUQpO1xuXG4gICAgLy8gY3JlYXRlIGdvIHRvIHRvZGF5cyBidXR0b25cbiAgICBpZiAob3B0aW9ucy5nb3RvVG9kYXkpIHtcbiAgICAgICAgY2FsZW5kYXJEaXYuYXBwZW5kKFwiPGRpdiBjbGFzcz0nYmQtZ290by10b2RheSc+2KjYsdmIINio2Ycg2KfZhdix2YjYsjwvZGl2PlwiKTtcbiAgICAgICAgdmFyIGdvdG9Ub2RheSA9IGNhbGVuZGFyRGl2LmZpbmQoXCIuYmQtZ290by10b2RheVwiKTtcbiAgICB9XG5cbiAgICAvLyBvcGVuaW5nIGFuZCBjbG9zaW5nIGZ1bmN0aW9uYWxpdHlcbiAgICBpbnB1dEVsZW1lbnQub24oXCJmb2N1c1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIG1haW5EaXYucmVtb3ZlQ2xhc3MoXCJiZC1oaWRlXCIpO1xuICAgICAgICBpZiAob3B0aW9ucy5zeW5jICYmIGlzU3luY2VkID09PSBmYWxzZSkge1xuICAgICAgICAgICAgc3luY0NhbGVuZGFyKCk7XG4gICAgICAgICAgICBpc1N5bmNlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgbWFpbkRpdjtcbiAgICB9KS5vbignYmx1cicsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKGlzQ2FsQ2xpY2tlZCA9PSBmYWxzZSkge1xuICAgICAgICAgICAgbWFpbkRpdi5hZGRDbGFzcyhcImJkLWhpZGVcIik7XG4gICAgICAgICAgICBpc1N5bmNlZCA9IGZhbHNlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaXNDYWxDbGlja2VkID0gZmFsc2U7XG4gICAgICAgICAgICBpbnB1dEVsZW1lbnQuZm9jdXMoKTtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIG1haW5EaXYub24oJ21vdXNlZG93bicsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBpc0NhbENsaWNrZWQgPSB0cnVlO1xuICAgIH0pO1xuXG4gICAgLy8gZHJvcGRvd24gZXZlbnRzXG4gICAgbW9udGhEcm9wZG93bi5vbignY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBzZWxlY3RlZE1vbnRoID0gcGFyc2VJbnQodGhpcy52YWx1ZSk7XG4gICAgICAgIG51bWJlck9mRGF5cyA9IG1vbnRoRGF5cyhzZWxlY3RlZFllYXIsIHNlbGVjdGVkTW9udGgpO1xuICAgICAgICBkYXlPZldlZWtKID0gZmluZEZpcnN0RGF5T2ZNb250aChzZWxlY3RlZFllYXIsIHNlbGVjdGVkTW9udGgpO1xuICAgICAgICBkcmF3RGF5cyhudW1iZXJPZkRheXMsIGRheU9mV2Vla0opO1xuICAgIH0pO1xuICAgIHllYXJEcm9wZG93bi5vbignY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBzZWxlY3RlZFllYXIgPSBwYXJzZUludCh0aGlzLnZhbHVlKTtcbiAgICAgICAgbnVtYmVyT2ZEYXlzID0gbW9udGhEYXlzKHNlbGVjdGVkWWVhciwgc2VsZWN0ZWRNb250aCk7XG4gICAgICAgIGRheU9mV2Vla0ogPSBmaW5kRmlyc3REYXlPZk1vbnRoKHNlbGVjdGVkWWVhciwgc2VsZWN0ZWRNb250aCk7XG4gICAgICAgIGRyYXdEYXlzKG51bWJlck9mRGF5cywgZGF5T2ZXZWVrSik7XG4gICAgfSk7XG5cbiAgICAvLyBHZW9yZ2lhbiB0byBKYWxhbGkgY29udmVydGVyIChtaW5pZmllZClcbiAgICAvLyBzb3VyY2UgaXMgdW5rbm93bi4gY29udGFjdCBpZiB5b3Uga25vdyB0aGUgY29kZSBvd25lci5cbiAgICBmdW5jdGlvbiBncmVnb3JpYW5Ub0phbGFsaShhLCByLCBzKSB7IGEgPSBwYXJzZUludChhKSwgciA9IHBhcnNlSW50KHIpLCBzID0gcGFyc2VJbnQocyk7IGZvciAodmFyIG4gPSBhIC0gMTYwMCwgZSA9IHIgLSAxLCB0ID0gcyAtIDEsIHAgPSAzNjUgKiBuICsgcGFyc2VJbnQoKG4gKyAzKSAvIDQpIC0gcGFyc2VJbnQoKG4gKyA5OSkgLyAxMDApICsgcGFyc2VJbnQoKG4gKyAzOTkpIC8gNDAwKSwgSSA9IDA7IGUgPiBJOyArK0kpIHAgKz0gZ19kYXlzW0ldOyBlID4gMSAmJiAobiAlIDQgPT0gMCAmJiBuICUgMTAwICE9IDAgfHwgbiAlIDQwMCA9PSAwKSAmJiArK3AsIHAgKz0gdDsgdmFyIHYgPSBwIC0gNzksIGQgPSBwYXJzZUludCh2IC8gMTIwNTMpOyB2ICU9IDEyMDUzOyB2YXIgbyA9IDk3OSArIDMzICogZCArIDQgKiBwYXJzZUludCh2IC8gMTQ2MSk7IHYgJT0gMTQ2MSwgdiA+PSAzNjYgJiYgKG8gKz0gcGFyc2VJbnQoKHYgLSAxKSAvIDM2NSksIHYgPSAodiAtIDEpICUgMzY1KTsgZm9yICh2YXIgSSA9IDA7IDExID4gSSAmJiB2ID49IGpfZGF5c1tJXTsgKytJKSB2IC09IGpfZGF5c1tJXTsgdmFyIHkgPSBJICsgMSwgXyA9IHYgKyAxOyByZXR1cm4gW28sIHksIF9dIH0gdmFyIGdfZGF5cyA9IFszMSwgMjgsIDMxLCAzMCwgMzEsIDMwLCAzMSwgMzEsIDMwLCAzMSwgMzAsIDMxXSwgal9kYXlzID0gWzMxLCAzMSwgMzEsIDMxLCAzMSwgMzEsIDMwLCAzMCwgMzAsIDMwLCAzMCwgMjldO1xuICAgIC8vIEphbGFsaSB0byBHZW9yZ2lhbiBjb252ZXJ0ZXIgKG1pbmlmaWVkKVxuICAgIC8vIHNvdXJjZSBpcyB1bmtub3duLiBjb250YWN0IGlmIHlvdSBrbm93IHRoZSBjb2RlIG93bmVyLlxuICAgIGZ1bmN0aW9uIHRvSmFsYWFsaShkLCBpLCBhKSB7IHJldHVybiBkMmooZzJkKGQsIGksIGEpKSB9IGZ1bmN0aW9uIHRvR3JlZ29yaWFuKGQsIGksIGEpIHsgcmV0dXJuIGQyZyhqMmQoZCwgaSwgYSkpIH0gZnVuY3Rpb24gaXNWYWxpZEphbGFhbGlEYXRlKGQsIGksIGEpIHsgcmV0dXJuIGQgPj0gLTYxICYmIDMxNzcgPj0gZCAmJiBpID49IDEgJiYgMTIgPj0gaSAmJiBhID49IDEgJiYgYSA8PSBqYWxhYWxpTW9udGhMZW5ndGgoZCwgaSkgfSBmdW5jdGlvbiBpc0xlYXBKYWxhYWxpWWVhcihkKSB7IHJldHVybiAwID09PSBqYWxDYWwoZCkubGVhcCB9IGZ1bmN0aW9uIGphbGFhbGlNb250aExlbmd0aChkLCBpKSB7IHJldHVybiA2ID49IGkgPyAzMSA6IDExID49IGkgPyAzMCA6IGlzTGVhcEphbGFhbGlZZWFyKGQpID8gMzAgOiAyOSB9IGZ1bmN0aW9uIGphbENhbChkKSB7IHZhciBpLCBhLCBuLCByLCB0LCBvLCB2LCBlID0gWy02MSwgOSwgMzgsIDE5OSwgNDI2LCA2ODYsIDc1NiwgODE4LCAxMTExLCAxMTgxLCAxMjEwLCAxNjM1LCAyMDYwLCAyMDk3LCAyMTkyLCAyMjYyLCAyMzI0LCAyMzk0LCAyNDU2LCAzMTc4XSwgbCA9IGUubGVuZ3RoLCB1ID0gZCArIDYyMSwgbSA9IC0xNCwgZyA9IGVbMF07IGlmIChnID4gZCB8fCBkID49IGVbbCAtIDFdKSB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIEphbGFhbGkgeWVhciBcIiArIGQpOyBmb3IgKHYgPSAxOyBsID4gdiAmJiAoaSA9IGVbdl0sIGEgPSBpIC0gZywgIShpID4gZCkpOyB2ICs9IDEpIG0gPSBtICsgOCAqIGRpdihhLCAzMykgKyBkaXYobW9kKGEsIDMzKSwgNCksIGcgPSBpOyByZXR1cm4gbyA9IGQgLSBnLCBtID0gbSArIDggKiBkaXYobywgMzMpICsgZGl2KG1vZChvLCAzMykgKyAzLCA0KSwgNCA9PT0gbW9kKGEsIDMzKSAmJiBhIC0gbyA9PT0gNCAmJiAobSArPSAxKSwgciA9IGRpdih1LCA0KSAtIGRpdigzICogKGRpdih1LCAxMDApICsgMSksIDQpIC0gMTUwLCB0ID0gMjAgKyBtIC0gciwgNiA+IGEgLSBvICYmIChvID0gbyAtIGEgKyAzMyAqIGRpdihhICsgNCwgMzMpKSwgbiA9IG1vZChtb2QobyArIDEsIDMzKSAtIDEsIDQpLCAtMSA9PT0gbiAmJiAobiA9IDQpLCB7IGxlYXA6IG4sIGd5OiB1LCBtYXJjaDogdCB9IH0gZnVuY3Rpb24gajJkKGQsIGksIGEpIHsgdmFyIG4gPSBqYWxDYWwoZCk7IHJldHVybiBnMmQobi5neSwgMywgbi5tYXJjaCkgKyAzMSAqIChpIC0gMSkgLSBkaXYoaSwgNykgKiAoaSAtIDcpICsgYSAtIDEgfSBmdW5jdGlvbiBkMmooZCkgeyB2YXIgaSwgYSwgbiwgciA9IGQyZyhkKS5neSwgdCA9IHIgLSA2MjEsIG8gPSBqYWxDYWwodCksIHYgPSBnMmQociwgMywgby5tYXJjaCk7IGlmIChuID0gZCAtIHYsIG4gPj0gMCkgeyBpZiAoMTg1ID49IG4pIHJldHVybiBhID0gMSArIGRpdihuLCAzMSksIGkgPSBtb2QobiwgMzEpICsgMSwgeyBqeTogdCwgam06IGEsIGpkOiBpIH07IG4gLT0gMTg2IH0gZWxzZSB0IC09IDEsIG4gKz0gMTc5LCAxID09PSBvLmxlYXAgJiYgKG4gKz0gMSk7IHJldHVybiBhID0gNyArIGRpdihuLCAzMCksIGkgPSBtb2QobiwgMzApICsgMSwgeyBqeTogdCwgam06IGEsIGpkOiBpIH0gfSBmdW5jdGlvbiBnMmQoZCwgaSwgYSkgeyB2YXIgbiA9IGRpdigxNDYxICogKGQgKyBkaXYoaSAtIDgsIDYpICsgMTAwMTAwKSwgNCkgKyBkaXYoMTUzICogbW9kKGkgKyA5LCAxMikgKyAyLCA1KSArIGEgLSAzNDg0MDQwODsgcmV0dXJuIG4gPSBuIC0gZGl2KDMgKiBkaXYoZCArIDEwMDEwMCArIGRpdihpIC0gOCwgNiksIDEwMCksIDQpICsgNzUyIH0gZnVuY3Rpb24gZDJnKGQpIHsgdmFyIGksIGEsIG4sIHIsIHQ7IHJldHVybiBpID0gNCAqIGQgKyAxMzkzNjE2MzEsIGkgPSBpICsgNCAqIGRpdigzICogZGl2KDQgKiBkICsgMTgzMTg3NzIwLCAxNDYwOTcpLCA0KSAtIDM5MDgsIGEgPSA1ICogZGl2KG1vZChpLCAxNDYxKSwgNCkgKyAzMDgsIG4gPSBkaXYobW9kKGEsIDE1MyksIDUpICsgMSwgciA9IG1vZChkaXYoYSwgMTUzKSwgMTIpICsgMSwgdCA9IGRpdihpLCAxNDYxKSAtIDEwMDEwMCArIGRpdig4IC0gciwgNiksIHsgZ3k6IHQsIGdtOiByLCBnZDogbiB9IH0gZnVuY3Rpb24gZGl2KGQsIGkpIHsgcmV0dXJuIH5+KGQgLyBpKSB9IGZ1bmN0aW9uIG1vZChkLCBpKSB7IHJldHVybiBkIC0gfn4oZCAvIGkpICogaSB9XG5cbiAgICB2YXIgc3luY0NhbGVuZGFyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaW5wdXRWYWx1ZSA9IGZpeERhdGUoaW5wdXRFbGVtZW50LnZhbCgpKTtcbiAgICAgICAgaWYgKGlucHV0VmFsdWUgPT09IFwiXCIpXG4gICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgaW5wdXRWYWx1ZSA9IGlucHV0VmFsdWUuc3BsaXQoXCIvXCIpO1xuICAgICAgICBtb250aERyb3Bkb3duLnZhbChwYXJzZUludChpbnB1dFZhbHVlWzFdKSk7XG4gICAgICAgIG1vbnRoRHJvcGRvd24udHJpZ2dlcihcImNoYW5nZVwiKTtcbiAgICAgICAgeWVhckRyb3Bkb3duLnZhbChwYXJzZUludChpbnB1dFZhbHVlWzBdKSk7XG4gICAgICAgIHllYXJEcm9wZG93bi50cmlnZ2VyKFwiY2hhbmdlXCIpO1xuXG4gICAgICAgIGlmIChvcHRpb25zLmhpZ2hsaWdodFNlbGVjdGVkRGF5KSB7XG4gICAgICAgICAgICBtYWluRGl2LmZpbmQoXCIuYmQtc2VsZWN0ZWQtZGF5XCIpLnJlbW92ZUNsYXNzKFwiYmQtc2VsZWN0ZWQtZGF5XCIpO1xuICAgICAgICAgICAgbWFpbkRpdi5maW5kKFwiLmRheS1cIiArIHBhcnNlSW50KGlucHV0VmFsdWVbMl0pKS5hZGRDbGFzcyhcImJkLXNlbGVjdGVkLWRheVwiKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHZhciBmaXhEYXRlID0gZnVuY3Rpb24gKGRhdGUpIHtcbiAgICAgICAgaWYgKGRhdGUgPT09IFwiXCIpXG4gICAgICAgICAgICByZXR1cm4gXCJcIjtcblxuICAgICAgICBkYXRlID0gZGF0ZS5zcGxpdChcIi9cIik7XG4gICAgICAgIC8vIGlmIChkYXRlWzBdLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAvLyAgICAgZGF0ZVswXSA9IFwiMTNcIiArIGRhdGVbMF07XG4gICAgICAgIC8vIH1cbiAgICAgICAgaWYgKGRhdGVbMV0ubGVuZ3RoIDwgMikge1xuICAgICAgICAgICAgaWYgKGRhdGVbMV0gPCAxMCkge1xuICAgICAgICAgICAgICAgIGRhdGVbMV0gPSBcIjBcIiArIGRhdGVbMV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRhdGVbMl0ubGVuZ3RoIDwgMikge1xuICAgICAgICAgICAgaWYgKGRhdGVbMl0gPCAxMCkge1xuICAgICAgICAgICAgICAgIGRhdGVbMl0gPSBcIjBcIiArIGRhdGVbMl07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZGF0ZSA9IGRhdGUuam9pbihcIi9cIik7XG4gICAgICAgIHJldHVybiBkYXRlO1xuICAgIH1cblxuICAgIHZhciBjb252ZXJ0VG9KV2VlayA9IGZ1bmN0aW9uIChkYXlPZldlZWtHKSB7XG4gICAgICAgIHZhciBkYXlPZldlZWtKO1xuICAgICAgICBpZiAoZGF5T2ZXZWVrRyA8IDYpIHtcbiAgICAgICAgICAgIGRheU9mV2Vla0ogPSBkYXlPZldlZWtHICsgMTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGRheU9mV2Vla0ogPSAwO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkYXlPZldlZWtKO1xuICAgIH1cblxuICAgIHZhciBtYWtlWWVhckxpc3QgPSBmdW5jdGlvbiAodGhpc1llYXIpIHtcbiAgICAgICAgeWVhckRyb3Bkb3duLmZpbmQoJ29wdGlvbicpLnJlbW92ZSgpO1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgMTAxOyBpKyspIHtcbiAgICAgICAgICAgIHZhciB0ZW1wWWVhciA9ICgodGhpc1llYXIgLSA5NSkgKyBpKSArICcnO1xuICAgICAgICAgICAgaWYgKG9wdGlvbnMuZm9yY2VGYXJzaURpZ2l0cykge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgMTA7IGorKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmd4ID0gbmV3IFJlZ0V4cChqLCAnZycpO1xuICAgICAgICAgICAgICAgICAgICB0ZW1wWWVhciA9IHRlbXBZZWFyLnJlcGxhY2Uocmd4LCBGQV9OVU1TW2pdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB5ZWFyRHJvcGRvd24uYXBwZW5kKCQoJzxvcHRpb24+Jywge1xuICAgICAgICAgICAgICAgIHZhbHVlOiAodGhpc1llYXIgLSA5NSkgKyBpLFxuICAgICAgICAgICAgICAgIHRleHQ6IHRlbXBZZWFyXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBpc2xlYXAgY2FsY3VsYXRvciwgc3VwcG9ydGVkIHllYXI6IDEyNDMgLSAxNDczXG4gICAgdmFyIGlzTGVhcFllYXIgPSBmdW5jdGlvbiAoeWVhcikge1xuICAgICAgICB2YXIgbW9kO1xuICAgICAgICBpZiAoeWVhciA8IDEzNDMgJiYgeWVhciA+IDEyNDMpIHtcbiAgICAgICAgICAgIG1vZCA9IHllYXIgJSAzMztcbiAgICAgICAgICAgIGlmIChtb2QgPT0gMSB8fCBtb2QgPT0gNSB8fCBtb2QgPT0gOSB8fCBtb2QgPT0gMTMgfHwgbW9kID09IDE3IHx8IG1vZCA9PSAyMiB8fCBtb2QgPT0gMjYgfHwgbW9kID09IDMwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh5ZWFyIDwgMTQ3MyAmJiB5ZWFyID4gMTM0Mikge1xuICAgICAgICAgICAgbW9kID0geWVhciAlIDE3O1xuICAgICAgICAgICAgaWYgKG1vZCA9PSAxIHx8IG1vZCA9PSA1IHx8IG1vZCA9PSA5IHx8IG1vZCA9PSAxMyB8fCBtb2QgPT0gMTggfHwgbW9kID09IDIyIHx8IG1vZCA9PSAyNiB8fCBtb2QgPT0gMzApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gXCJ1bmtub3duXCI7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgbW9udGhEYXlzID0gZnVuY3Rpb24gKHllYXIsIG1vbnRoKSB7XG4gICAgICAgIGlmIChtb250aCA8IDcpIHtcbiAgICAgICAgICAgIHJldHVybiAzMTtcbiAgICAgICAgfSBlbHNlIGlmIChtb250aCA8IDEyKSB7XG4gICAgICAgICAgICByZXR1cm4gMzA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoaXNMZWFwWWVhcih5ZWFyKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAzMDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDI5O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gbWFrZSBmaXJzdCBwYWdlIG9mIGNhbGVuZGFyXG4gICAgdG9kYXlHID0gbmV3IERhdGUoKTtcblxuICAgIHRvZGF5c0ogPSBncmVnb3JpYW5Ub0phbGFsaSh0b2RheUcuZ2V0RnVsbFllYXIoKSwgdG9kYXlHLmdldE1vbnRoKCkgKyAxLCB0b2RheUcuZ2V0RGF0ZSgpKTtcbiAgICB2YXIgc2VsZWN0ZWREYXRlSiA9IFtdO1xuICAgIGZvciAoaSA9IDA7IGkgPCAzOyBpKyspIHtcbiAgICAgICAgc2VsZWN0ZWREYXRlSltpXSA9IHRvZGF5c0pbaV07XG4gICAgfVxuXG4gICAgdG9kYXlzWWVhciA9IHRvZGF5c0pbMF07XG4gICAgdG9kYXlzTW9udGggPSB0b2RheXNKWzFdO1xuICAgIHRvZGF5c0RheSA9IHRvZGF5c0pbMl07XG5cbiAgICBzZWxlY3RlZFllYXIgPSBzZWxlY3RlZERhdGVKWzBdO1xuICAgIHNlbGVjdGVkTW9udGggPSBzZWxlY3RlZERhdGVKWzFdO1xuICAgIHNlbGVjdGVkRGF5ID0gc2VsZWN0ZWREYXRlSlsyXTtcblxuICAgIG1vbnRoRHJvcGRvd24udmFsKHNlbGVjdGVkTW9udGgpO1xuICAgIG1ha2VZZWFyTGlzdChzZWxlY3RlZFllYXIpO1xuICAgIHllYXJEcm9wZG93bi52YWwoc2VsZWN0ZWRZZWFyKTtcblxuICAgIG51bWJlck9mRGF5cyA9IG1vbnRoRGF5cyhzZWxlY3RlZFllYXIsIHNlbGVjdGVkTW9udGgpO1xuXG4gICAgLy8gZmluZCBmaXJzdCBkYXkgb2YgbW9udGggaW4gd2Vla1xuICAgIHZhciBmaW5kRmlyc3REYXlPZk1vbnRoID0gZnVuY3Rpb24gKHNlbGVjdGVkWWVhciwgc2VsZWN0ZWRNb250aCkge1xuICAgICAgICB2YXIgZmlyc3REYXlPZk1vbnRoRyA9IHRvR3JlZ29yaWFuKHNlbGVjdGVkWWVhciwgc2VsZWN0ZWRNb250aCwgMSk7XG4gICAgICAgIGZpcnN0RGF5T2ZNb250aEcgPSBuZXcgRGF0ZShmaXJzdERheU9mTW9udGhHLmd5ICsgXCIvXCIgKyBmaXJzdERheU9mTW9udGhHLmdtICsgXCIvXCIgKyBmaXJzdERheU9mTW9udGhHLmdkKTtcbiAgICAgICAgcmV0dXJuIGNvbnZlcnRUb0pXZWVrKGZpcnN0RGF5T2ZNb250aEcuZ2V0RGF5KCkpO1xuICAgIH1cbiAgICBkYXlPZldlZWtKID0gZmluZEZpcnN0RGF5T2ZNb250aChzZWxlY3RlZFllYXIsIHNlbGVjdGVkTW9udGgpO1xuXG4gICAgLy8gZHJhdyBkYXlzIG9uIGNhbGVuZGFyXG4gICAgdmFyIGRyYXdEYXlzID0gZnVuY3Rpb24gKG51bWJlck9mRGF5cywgZGF5T2ZXZWVrSikge1xuICAgICAgICBkYXlzVGFibGUuZW1wdHkoKTtcbiAgICAgICAgdmFyIGRheUluZGV4ID0gMTtcbiAgICAgICAgdmFyIHJvd0luZGV4ID0gMTtcbiAgICAgICAgd2hpbGUgKGRheUluZGV4IDw9IG51bWJlck9mRGF5cykge1xuICAgICAgICAgICAgZGF5c1RhYmxlLmFwcGVuZCgkKCc8dHI+Jywge1xuICAgICAgICAgICAgICAgIGNsYXNzOiBcInRyLVwiICsgcm93SW5kZXhcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCA3OyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoZGF5SW5kZXggPT0gMSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaiA9IDA7XG4gICAgICAgICAgICAgICAgICAgIHdoaWxlIChqIDwgZGF5T2ZXZWVrSikge1xuICAgICAgICAgICAgICAgICAgICAgICAgJChcIiNiZC10YWJsZS1kYXlzLVwiICsgZWxlbWVudElEICsgXCIgLnRyLTFcIikuYXBwZW5kKCQoJzx0ZD4nLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M6IFwiYmQtZW1wdHktY2VsbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGorKztcbiAgICAgICAgICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoaSA8IDcgJiYgZGF5SW5kZXggPD0gbnVtYmVyT2ZEYXlzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wVEQgPSAnPHRkPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJzxidXR0b24gY2xhc3M9XCJkYXkgZGF5LScgKyBkYXlJbmRleCArICdcIiB0eXBlPVwiYnV0dG9uXCI+JyArIChvcHRpb25zLmZvcmNlRmFyc2lEaWdpdHMgPyBGQV9OVU1TW2RheUluZGV4XSA6IGRheUluZGV4KSArICc8L2J1dHRvbj4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICc8L3RkPic7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gbWFyayB0b2RheXMgZGF5IGJ5IGFkZGluZyAuYmQtdG9kYXkgY2xhc3NcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMubWFya1RvZGF5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF5SW5kZXggPT0gdG9kYXlzRGF5ICYmIHRvZGF5c01vbnRoID09IHNlbGVjdGVkTW9udGggJiYgdG9kYXlzWWVhciA9PSBzZWxlY3RlZFllYXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWR4ID0gdGVtcFRELmluZGV4T2YoJ2RheSBkYXktJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcFREID0gdGVtcFRELnNsaWNlKDAsIGlkeCkgKyAnIGJkLXRvZGF5ICcgKyB0ZW1wVEQuc2xpY2UoaWR4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIG1hcmsgaG9saWRheXMgYnkgYWRkaW5nIC5iZC1ob2xpZGF5IGNsYXNzXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLm1hcmtIb2xpZGF5cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPT0gNikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZHggPSB0ZW1wVEQuaW5kZXhPZignZGF5IGRheS0nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wVEQgPSB0ZW1wVEQuc2xpY2UoMCwgaWR4KSArICcgYmQtaG9saWRheSAnICsgdGVtcFRELnNsaWNlKGlkeCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAkKFwiI2JkLXRhYmxlLWRheXMtXCIgKyBlbGVtZW50SUQgKyBcIiAudHItXCIgKyByb3dJbmRleCkuYXBwZW5kKHRlbXBURCk7XG5cbiAgICAgICAgICAgICAgICAgICAgZGF5SW5kZXgrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByb3dJbmRleCsrO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG9wdGlvbnMuaGlnaGxpZ2h0U2VsZWN0ZWREYXkpIHtcbiAgICAgICAgICAgIHZhciBpbnB1dFZhbHVlID0gaW5wdXRFbGVtZW50LnZhbCgpO1xuICAgICAgICAgICAgaW5wdXRWYWx1ZSA9IGlucHV0VmFsdWUuc3BsaXQoXCIvXCIpO1xuICAgICAgICAgICAgaWYgKGlucHV0VmFsdWVbMF0gPT0gc2VsZWN0ZWRZZWFyICYmIGlucHV0VmFsdWVbMV0gPT0gc2VsZWN0ZWRNb250aCkge1xuICAgICAgICAgICAgICAgIG1haW5EaXYuZmluZChcIi5iZC1zZWxlY3RlZC1kYXlcIikucmVtb3ZlQ2xhc3MoXCJiZC1zZWxlY3RlZC1kYXlcIik7XG4gICAgICAgICAgICAgICAgbWFpbkRpdi5maW5kKFwiLmRheS1cIiArIHBhcnNlSW50KGlucHV0VmFsdWVbMl0pKS5hZGRDbGFzcyhcImJkLXNlbGVjdGVkLWRheVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgfVxuXG4gICAgaW5wdXRFbGVtZW50LnBhcmVudCgpLm9uKFwiY2xpY2tcIiwgXCJidXR0b24uZGF5XCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGRhdGVzdHIgPSBzZWxlY3RlZFllYXIgKyBcIi9cIiArIHNlbGVjdGVkTW9udGggKyBcIi9cIiArICQodGhpcykuYXR0cignY2xhc3MnKS5zcGxpdChcIiBcIilbJCh0aGlzKS5hdHRyKCdjbGFzcycpLnNwbGl0KFwiIFwiKS5pbmRleE9mKCdkYXknKSArIDFdLnNwbGl0KFwiLVwiKVsxXTtcbiAgICAgICAgaWYgKG9wdGlvbnMudHdvZGlnaXQpIHtcbiAgICAgICAgICAgIGRhdGVzdHIgPSBmaXhEYXRlKGRhdGVzdHIpO1xuICAgICAgICB9XG4gICAgICAgIGlucHV0RWxlbWVudC52YWwoZGF0ZXN0cik7XG4gICAgICAgIGlucHV0RWxlbWVudC50cmlnZ2VyKFwiY2hhbmdlXCIpO1xuICAgICAgICBpZiAob3B0aW9ucy5jbG9zZUFmdGVyU2VsZWN0KSB7XG4gICAgICAgICAgICBpc0NhbENsaWNrZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGlucHV0RWxlbWVudC50cmlnZ2VyKFwiYmx1clwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChvcHRpb25zLmhpZ2hsaWdodFNlbGVjdGVkRGF5KSB7XG4gICAgICAgICAgICBtYWluRGl2LmZpbmQoXCIuYmQtc2VsZWN0ZWQtZGF5XCIpLnJlbW92ZUNsYXNzKFwiYmQtc2VsZWN0ZWQtZGF5XCIpO1xuICAgICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcyhcImJkLXNlbGVjdGVkLWRheVwiKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgbmV4dE1vbnRoLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAvL2NvbnNvbGUubG9nKFwibW9udGg6IFwiICsgc2VsZWN0ZWRNb250aCArIFwiLCB5ZWFyOiBcIiArIHNlbGVjdGVkWWVhcik7XG4gICAgICAgIGlmIChtb250aERyb3Bkb3duLnZhbCgpIDwgMTIpIHtcbiAgICAgICAgICAgIG1vbnRoRHJvcGRvd24udmFsKHBhcnNlSW50KG1vbnRoRHJvcGRvd24udmFsKCkpICsgMSk7XG4gICAgICAgICAgICBtb250aERyb3Bkb3duLnRyaWdnZXIoXCJjaGFuZ2VcIik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBtb250aERyb3Bkb3duLnZhbCgxKTtcbiAgICAgICAgICAgIG1vbnRoRHJvcGRvd24udHJpZ2dlcihcImNoYW5nZVwiKTtcbiAgICAgICAgICAgIHllYXJEcm9wZG93bi52YWwocGFyc2VJbnQoeWVhckRyb3Bkb3duLnZhbCgpKSArIDEpO1xuICAgICAgICAgICAgeWVhckRyb3Bkb3duLnRyaWdnZXIoXCJjaGFuZ2VcIik7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIHByZXZNb250aC5vbihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKG1vbnRoRHJvcGRvd24udmFsKCkgPiAxKSB7XG4gICAgICAgICAgICBtb250aERyb3Bkb3duLnZhbChwYXJzZUludChtb250aERyb3Bkb3duLnZhbCgpKSAtIDEpO1xuICAgICAgICAgICAgbW9udGhEcm9wZG93bi50cmlnZ2VyKFwiY2hhbmdlXCIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbW9udGhEcm9wZG93bi52YWwoMTIpO1xuICAgICAgICAgICAgbW9udGhEcm9wZG93bi50cmlnZ2VyKFwiY2hhbmdlXCIpO1xuICAgICAgICAgICAgeWVhckRyb3Bkb3duLnZhbChwYXJzZUludCh5ZWFyRHJvcGRvd24udmFsKCkpIC0gMSk7XG4gICAgICAgICAgICB5ZWFyRHJvcGRvd24udHJpZ2dlcihcImNoYW5nZVwiKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgaWYgKG9wdGlvbnMuZ290b1RvZGF5KSB7XG4gICAgICAgIGdvdG9Ub2RheS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIG1vbnRoRHJvcGRvd24udmFsKHRvZGF5c01vbnRoKTtcbiAgICAgICAgICAgIG1vbnRoRHJvcGRvd24udHJpZ2dlcihcImNoYW5nZVwiKTtcbiAgICAgICAgICAgIHllYXJEcm9wZG93bi52YWwodG9kYXlzWWVhcik7XG4gICAgICAgICAgICB5ZWFyRHJvcGRvd24udHJpZ2dlcihcImNoYW5nZVwiKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZHJhd0RheXMobnVtYmVyT2ZEYXlzLCBkYXlPZldlZWtKKTtcblxuICAgIC8vIGVuYWJsZSBib290c3RyYXAgdG9vbHRpcCBpZiBib290c3RyYXAgaXMgbG9hZGVkXG4gICAgaWYgKHR5cGVvZiAkKCkubW9kYWwgPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAkKCdbZGF0YS10b2dnbGU9XCJ0b29sdGlwXCJdJykudG9vbHRpcCgpO1xuICAgIH1cblxufVxuIiwidmFyIG1lZGlhX3htID0gd2luZG93Lm1hdGNoTWVkaWEoXCIobWF4LXdpZHRoOiA1NzUuOThweClcIik7XG52YXIgbWVkaWFfc20gPSB3aW5kb3cubWF0Y2hNZWRpYShcIihtaW4td2lkdGg6IDU3NnB4KSBhbmQgKG1heC13aWR0aDogNzY3Ljk4cHgpXCIpO1xudmFyIG1lZGlhX21kID0gd2luZG93Lm1hdGNoTWVkaWEoXCIobWluLXdpZHRoOiA3NjhweCkgYW5kIChtYXgtd2lkdGg6IDk5MS45OHB4KVwiKTtcbnZhciBtZWRpYV9sZyA9IHdpbmRvdy5tYXRjaE1lZGlhKFwiKG1pbi13aWR0aDogOTkycHgpIGFuZCAobWF4LXdpZHRoOiAxMTk5Ljk4cHgpXCIpO1xudmFyIG1lZGlhX3hsID0gd2luZG93Lm1hdGNoTWVkaWEoXCIobWluLXdpZHRoOiAxMjAwcHgpXCIpO1xuXG5cbmZ1bmN0aW9uIGV2ZW50X21lZGlhX3htKG1lZGlhKXtcblx0aWYobWVkaWEubWF0Y2hlcykgcmV0dXJuICQoZG9jdW1lbnQpLnRyaWdnZXIoJ21lZGlhOnhtJywgW21lZGlhXSk7XG5cdGVsc2UgcmV0dXJuICQoZG9jdW1lbnQpLnRyaWdnZXIoJ21lZGlhOnhtOmV4aXQnLCBbbWVkaWFdKTtcbn1cbmZ1bmN0aW9uIGV2ZW50X21lZGlhX3NtKG1lZGlhKXtcblx0aWYobWVkaWEubWF0Y2hlcykgcmV0dXJuICQoZG9jdW1lbnQpLnRyaWdnZXIoJ21lZGlhOnNtJywgW21lZGlhXSk7XG5cdGVsc2UgcmV0dXJuICQoZG9jdW1lbnQpLnRyaWdnZXIoJ21lZGlhOnNtOmV4aXQnLCBbbWVkaWFdKTtcbn1cbmZ1bmN0aW9uIGV2ZW50X21lZGlhX21kKG1lZGlhKXtcblx0aWYobWVkaWEubWF0Y2hlcykgcmV0dXJuICQoZG9jdW1lbnQpLnRyaWdnZXIoJ21lZGlhOm1kJywgW21lZGlhXSk7XG5cdGVsc2UgcmV0dXJuICQoZG9jdW1lbnQpLnRyaWdnZXIoJ21lZGlhOm1kOmV4aXQnLCBbbWVkaWFdKTtcbn1cbmZ1bmN0aW9uIGV2ZW50X21lZGlhX2xnKG1lZGlhKXtcblx0aWYobWVkaWEubWF0Y2hlcykgcmV0dXJuICQoZG9jdW1lbnQpLnRyaWdnZXIoJ21lZGlhOmxnJywgW21lZGlhXSk7XG5cdGVsc2UgcmV0dXJuICQoZG9jdW1lbnQpLnRyaWdnZXIoJ21lZGlhOmxnOmV4aXQnLCBbbWVkaWFdKTtcbn1cbmZ1bmN0aW9uIGV2ZW50X21lZGlhX3hsKG1lZGlhKXtcblx0aWYobWVkaWEubWF0Y2hlcykgcmV0dXJuICQoZG9jdW1lbnQpLnRyaWdnZXIoJ21lZGlhOnhsJywgW21lZGlhXSk7XG5cdGVsc2UgcmV0dXJuICQoZG9jdW1lbnQpLnRyaWdnZXIoJ21lZGlhOnhsOmV4aXQnLCBbbWVkaWFdKTtcbn1cblxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKXtcblx0ZXZlbnRfbWVkaWFfeG0obWVkaWFfeG0pO1xuXHRtZWRpYV94bS5hZGRMaXN0ZW5lcihldmVudF9tZWRpYV94bSk7XG5cblx0ZXZlbnRfbWVkaWFfc20obWVkaWFfc20pO1xuXHRtZWRpYV9zbS5hZGRMaXN0ZW5lcihldmVudF9tZWRpYV9zbSk7XG5cblx0ZXZlbnRfbWVkaWFfbWQobWVkaWFfbWQpO1xuXHRtZWRpYV9tZC5hZGRMaXN0ZW5lcihldmVudF9tZWRpYV9tZCk7XG5cblx0ZXZlbnRfbWVkaWFfbGcobWVkaWFfbGcpO1xuXHRtZWRpYV9sZy5hZGRMaXN0ZW5lcihldmVudF9tZWRpYV9sZyk7XG5cblx0ZXZlbnRfbWVkaWFfeGwobWVkaWFfeGwpO1xuXHRtZWRpYV94bC5hZGRMaXN0ZW5lcihldmVudF9tZWRpYV94bCk7XG59KVxuIiwiJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuXHQkLmFqYXhTZXR1cChcblx0XHR7XG5cdFx0XHRoZWFkZXJzOlxuXHRcdFx0e1xuXHRcdFx0XHQnWC1DU1JGLVRva2VuJzogJCgnbWV0YVtuYW1lPVwiY3NyZi10b2tlblwiXScpLmF0dHIoJ2NvbnRlbnQnKVxuXHRcdFx0fVxuXHRcdH1cblx0KTtcblx0JChkb2N1bWVudCkudHJpZ2dlcignc3RhdGlvOmdsb2JhbDpyZW5kZXJSZXNwb25zZScsIFskKGRvY3VtZW50KV0pO1xufSk7XG4kKGRvY3VtZW50KS5vbignc3RhdGlvOmdsb2JhbDpyZW5kZXJSZXNwb25zZScsIGZ1bmN0aW9uIChldmVudCwgYmFzZSwgY29udGV4dCkge1xuXHRiYXNlLmVhY2goZnVuY3Rpb24gKCkge1xuXHRcdCQoJ1tkYXRhLUxpamF4XSwgLmxpamF4JywgdGhpcykuZWFjaChmdW5jdGlvbiAoKSB7XG5cdFx0XHRuZXcgTGlqYXgodGhpcyk7XG5cdFx0fSk7XG5cdFx0JChcImFcIiwgdGhpcykubm90KCcuZGlyZWN0LCBbZGF0YS1kaXJlY3RdLCBbdGFyZ2V0PV9ibGFua10sIC5saWpheCwgW2RhdGEtbGlqYXhdJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuXHRcdFx0bmV3IFN0YXRpbyh7XG5cdFx0XHRcdHVybDogJCh0aGlzKS5hdHRyKCdocmVmJyksXG5cdFx0XHRcdHR5cGU6ICQodGhpcykuaXMoJy5hY3Rpb24nKSA/ICdyZW5kZXInIDogJ2JvdGgnLFxuXHRcdFx0XHRjb250ZXh0OiAkKHRoaXMpLFxuXHRcdFx0fSk7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fSk7XG5cblx0XHQkKCdmb3JtW2FjdGlvbl0nLCB0aGlzKS5ub3QoJy5kaXJlY3QsIFtkYXRhLWRpcmVjdF0sIFt0YXJnZXQ9X2JsYW5rXSwgLmxpamF4JykuZWFjaChmdW5jdGlvbiAoKSB7XG5cdFx0XHRuZXcgTGlqYXgodGhpcyk7XG5cdFx0fSkub24oJ2pyZXNwJywgZnVuY3Rpb24gKGUsIGQpIHtcblx0XHRcdCQoJy5pcy1pbnZhbGlkJywgdGhpcykucmVtb3ZlQ2xhc3MoJ2lzLWludmFsaWQnKTtcblx0XHRcdCQoJy5pbnZhbGlkLWZlZWRiYWNrJywgdGhpcykucmVtb3ZlKCk7XG5cdFx0XHRpZiAoZC5lcnJvcnMpIHtcblx0XHRcdFx0Zm9yICh2YXIgaWQgaW4gZC5lcnJvcnMpIHtcblx0XHRcdFx0XHQkKCcjJyArIGlkICsgJywgW2RhdGEtYWxpYXN+PScgKyBpZCArICddJykuYWRkQ2xhc3MoJ2lzLWludmFsaWQnKTtcblx0XHRcdFx0XHQkKCc8ZGl2IGNsYXNzPVwiaW52YWxpZC1mZWVkYmFja1wiPicgKyBkLmVycm9yc1tpZF1bMF0gKyAnPC9kaXY+JykuaW5zZXJ0QWZ0ZXIoJCgnIycgKyBpZCArICcsIFtkYXRhLWFsaWFzfj0nICsgaWQgKyAnXScpKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdCQoXCIuc2VsZWN0Mi1zZWxlY3RcIiwgdGhpcykuZWFjaChmdW5jdGlvbiAoKSB7XG5cdFx0XHR2YXIgb3B0aW9ucyA9IHtcblx0XHRcdFx0d2lkdGg6ICcxMDAlJyxcblx0XHRcdFx0YW1kTGFuZ3VhZ2VCYXNlOiAnZGlzdC92ZW5kb3JzL3NlbGVjdDItNC4wLjEzL2Rpc3QvanMvaTE4bicsXG5cdFx0XHRcdGxhbmd1YWdlOiAnZmEnLFxuXHRcdFx0XHRtaW5pbXVtSW5wdXRMZW5ndGg6IDAsXG5cdFx0XHRcdGFsbG93Q2xlYXI6ICQodGhpcykuaXMoJ1tkYXRhLWFsbG93Q2xlYXJdJykgfHwgJCh0aGlzKS5pcygnLmhhcy1jbGVhcicpLFxuXHRcdFx0XHRkaXI6IFwicnRsXCIsXG5cdFx0XHRcdHRhZ3M6ICQodGhpcykuaXMoJy50YWctdHlwZScpLFxuXHRcdFx0XHRkcm9wZG93blBhcmVudDogJCgnIycgKyAkKHRoaXMpLmF0dHIoJ2RhdGEtZHJvcGRvd25QYXJlbnQnKSkubGVuZ3RoID8gJCgnIycgKyAkKHRoaXMpLmF0dHIoJ2RhdGEtZHJvcGRvd25QYXJlbnQnKSkgOiB1bmRlZmluZWRcblx0XHRcdH07XG5cdFx0XHQkKHRoaXMpLmF0dHIoJ2RhdGEtbXItdmFsdWUnLCAkKCdbbmFtZT0nICsgJCh0aGlzKS5hdHRyKCdkYXRhLW11bHRpLXJvdW5kJykgKyAnXScpLnZhbCgpKTtcblx0XHRcdCQoJ1tuYW1lPScgKyAkKHRoaXMpLmF0dHIoJ2RhdGEtbXVsdGktcm91bmQnKSArICddJykucmVtb3ZlKCk7XG5cdFx0XHRpZiAob3B0aW9ucy5hbGxvd0NsZWFyKSB7XG5cdFx0XHRcdG9wdGlvbnMucGxhY2Vob2xkZXIgPSB7fTtcblx0XHRcdFx0b3B0aW9ucy5wbGFjZWhvbGRlci50ZXh0ID0gJCgnb3B0aW9uJywgdGhpcykuZmlyc3QoKS50ZXh0KCk7XG5cdFx0XHRcdG9wdGlvbnMucGxhY2Vob2xkZXIuaWQgPSAkKCdvcHRpb24nLCB0aGlzKS5maXJzdCgpLmF0dHIoJ3ZhbHVlJyk7XG5cdFx0XHR9XG5cdFx0XHRpZiAoJCh0aGlzKS5pcygnW2RhdGEtdXJsXScpKSB7XG5cdFx0XHRcdHZhciB0aXRsZSA9ICQodGhpcykuYXR0cignZGF0YS10aXRsZScpIHx8ICd0aXRsZSc7XG5cdFx0XHRcdHZhciBfc2VsZiA9IHRoaXM7XG5cdFx0XHRcdG9wdGlvbnMuYWpheCA9IHtcblx0XHRcdFx0XHRkZWxheTogMjUwLFxuXHRcdFx0XHRcdHVybDogJCh0aGlzKS5hdHRyKCdkYXRhLXVybCcpLFxuXHRcdFx0XHRcdGRhdGFUeXBlOiAnanNvbicsXG5cdFx0XHRcdFx0cXVpZXRNaWxsaXM6IDI1MCxcblx0XHRcdFx0XHRkYXRhOiBmdW5jdGlvbiAocGFyYW1zKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdFx0XHRxOiBwYXJhbXMudGVybSB8fCAnJ1xuXHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdHByb2Nlc3NSZXN1bHRzOiBmdW5jdGlvbiAoZGF0YSkge1xuXHRcdFx0XHRcdFx0ZGF0YSA9IGRhdGEuZGF0YSB8fCBkYXRhO1xuXHRcdFx0XHRcdFx0dmFyIGlkX3Byb3BlcnR5ID0gJChfc2VsZikuYXR0cignZGF0YS1pZCcpIHx8ICdpZCc7XG5cdFx0XHRcdFx0XHR2YXIgdGl0bGVfcHJvcGVydHkgPSAkKF9zZWxmKS5hdHRyKCdkYXRhLXRpdGxlJykgfHwgJ3RpdGxlJztcblx0XHRcdFx0XHRcdHZhciByZXN1bHQgPSB7IHJlc3VsdHM6IFtdIH07XG5cdFx0XHRcdFx0XHRpZiAoJChfc2VsZikuaXMoJ1tkYXRhLWFsbG93Q2xlYXJdJykpIHtcblx0XHRcdFx0XHRcdFx0cmVzdWx0LnJlc3VsdHMucHVzaCh7XG5cdFx0XHRcdFx0XHRcdFx0aWQ6ICcnLFxuXHRcdFx0XHRcdFx0XHRcdHRleHQ6ICctJyxcblx0XHRcdFx0XHRcdFx0XHRhbGw6IG51bGxcblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0dmFyIHN1Yl90aXRsZV9wcm9wZXJ0eSA9IHRpdGxlX3Byb3BlcnR5O1xuXHRcdFx0XHRcdFx0XHRpZiAoc3ViX3RpdGxlX3Byb3BlcnR5LmluZGV4T2YoJyAnKSA+PSAwKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIHN1Yl90aXRsZV9wcm9wZXJ0aWVzID0gc3ViX3RpdGxlX3Byb3BlcnR5LnNwbGl0KCcgJyk7XG5cdFx0XHRcdFx0XHRcdFx0Zm9yICh2YXIgaXMgPSAwOyBpcyA8IHN1Yl90aXRsZV9wcm9wZXJ0aWVzLmxlbmd0aDsgaXMrKykge1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKGRhdGFbaV1bc3ViX3RpdGxlX3Byb3BlcnRpZXNbaXNdXSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRzdWJfdGl0bGVfcHJvcGVydHkgPSBzdWJfdGl0bGVfcHJvcGVydGllc1tpc107XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdHJlc3VsdC5yZXN1bHRzLnB1c2goe1xuXHRcdFx0XHRcdFx0XHRcdGlkOiBkYXRhW2ldW2lkX3Byb3BlcnR5XSxcblx0XHRcdFx0XHRcdFx0XHR0ZXh0OiBkYXRhW2ldW3N1Yl90aXRsZV9wcm9wZXJ0eV0sXG5cdFx0XHRcdFx0XHRcdFx0YWxsOiBkYXRhW2ldXG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0cmV0dXJuIHJlc3VsdDtcblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdGNhY2hlOiBmYWxzZVxuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXHRcdFx0JCh0aGlzKS5zZWxlY3QyKG9wdGlvbnMpO1xuXHRcdH0pO1xuXHR9KTtcbn0pOyIsImZ1bmN0aW9uIHJlc3BvbnNpdmVfbWVudSgpIHtcbiAgICAkKCcjbWVudScpLnJlbW92ZUNsYXNzKCdkLW5vbmUnKS5hZGRDbGFzcygnZC1mbGV4Jyk7XG4gICAgLy8gJCgnI2Rlc2t0b3AnKS5yZW1vdmVDbGFzcygnZC1ub25lJyk7XG4gICAgJCgnYm9keScpLmFkZENsYXNzKCdyZXNwb25zaXZlLW1lbnUnKTtcbiAgICAkKCcjYnRuLW1lbnUnKS5maW5kKCQoXCIuZmFzXCIpKS5yZW1vdmVDbGFzcygnZmEtYmFycycpLmFkZENsYXNzKCdmYS1hcnJvdy1yaWdodCcpO1xuICAgICQodGhpcykub2ZmKCdjbGljay5yZXNwb25zaXZlLW1lbnUnKTtcbiAgICAkKHRoaXMpLm9uKCdjbGljay5jbG9zZS1yZXNwb25zaXZlLW1lbnUnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgJCh0aGlzKS5vZmYoJ2NsaWNrLmNsb3NlLXJlc3BvbnNpdmUtbWVudScpO1xuICAgICAgICAkKHRoaXMpLm9uKCdjbGljay5yZXNwb25zaXZlLW1lbnUnLCByZXNwb25zaXZlX21lbnUpO1xuICAgICAgICAkKCcjbWVudScpLmFkZENsYXNzKCdkLW5vbmUnKS5yZW1vdmVDbGFzcygnZC1mbGV4Jyk7XG4gICAgICAgIC8vICQoJyNkZXNrdG9wJykuYWRkQ2xhc3MoJ2Qtbm9uZScpO1xuICAgICAgICAkKCdib2R5JykucmVtb3ZlQ2xhc3MoJ3Jlc3BvbnNpdmUtbWVudScpO1xuICAgICAgICAkKCcjYnRuLW1lbnUnKS5maW5kKCQoXCIuZmFzXCIpKS5yZW1vdmVDbGFzcygnZmEtYXJyb3ctcmlnaHQnKS5hZGRDbGFzcygnZmEtYmFycycpO1xuICAgIH0pO1xufVxuXG4kKGRvY3VtZW50KS5vbignbWVkaWE6eG0gbWVkaWE6c20nLCBmdW5jdGlvbihldmVudCwgbWVkaWEpIHtcbiAgICAkKFwiYm9keTpub3QoLnJlc3BvbnNpdmUtbWVudSkgI2J0bi1tZW51XCIpLm9uKCdjbGljay5yZXNwb25zaXZlLW1lbnUnLCByZXNwb25zaXZlX21lbnUpO1xuXG4gICAgdmFyIG1lbnUgPSAkKCcjbWVudScpO1xuICAgIHZhciBkZXNrdG9wID0gJCgnI2Rlc2t0b3AnKTtcbiAgICB2YXIgYnRuX21lbnUgPSAkKCcjYnRuLW1lbnUnKTtcbiAgICAkKGRvY3VtZW50KS5tb3VzZXVwKGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgKCFtZW51LmlzKGUudGFyZ2V0KSAmJiBtZW51LmhhcyhlLnRhcmdldCkubGVuZ3RoID09PSAwKVxuICAgICAgICAgICAgJiYgKCFkZXNrdG9wLmlzKGUudGFyZ2V0KSAmJiBkZXNrdG9wLmhhcyhlLnRhcmdldCkubGVuZ3RoID09PSAwKVxuICAgICAgICAgICAgJiYgKCFidG5fbWVudS5pcyhlLnRhcmdldCkgJiYgYnRuX21lbnUuaGFzKGUudGFyZ2V0KS5sZW5ndGggPT09IDApXG4gICAgICAgICAgICApXG4gICAgICAgIHtcbiAgICAgICAgICAgICQoXCJib2R5LnJlc3BvbnNpdmUtbWVudSAjYnRuLW1lbnVcIikudHJpZ2dlcignY2xpY2suY2xvc2UtcmVzcG9uc2l2ZS1tZW51Jyk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vICQoXCJib2R5XCIpLnN3aXBlKHtcbiAgICAvLyAgICAgc3dpcGU6IGZ1bmN0aW9uKGV2ZW50LCBkaXJlY3Rpb24sIGRpc3RhbmNlLCBkdXJhdGlvbiwgZmluZ2VyQ291bnQsIGZpbmdlckRhdGEpIHtcbiAgICAvLyAgICAgICAgIGlmIChkaXJlY3Rpb24gPT0gJ2xlZnQnKSB7XG4gICAgLy8gICAgICAgICAgICAgJChcImJvZHk6bm90KC5yZXNwb25zaXZlLW1lbnUpICNidG4tbWVudVwiKS50cmlnZ2VyKCdjbGljay5yZXNwb25zaXZlLW1lbnUnKTtcbiAgICAvLyAgICAgICAgIH1cblxuICAgIC8vICAgICAgICAgaWYgKGRpcmVjdGlvbiA9PSAncmlnaHQnKSB7XG4gICAgLy8gICAgICAgICAgICAgJChcImJvZHkucmVzcG9uc2l2ZS1tZW51ICNidG4tbWVudVwiKS50cmlnZ2VyKCdjbGljay5jbG9zZS1yZXNwb25zaXZlLW1lbnUnKTtcbiAgICAvLyAgICAgICAgIH1cblxuICAgIC8vICAgICAgICAgaWYgKGRpcmVjdGlvbiA9PSAndXAnIHx8IGRpcmVjdGlvbiA9PSAnZG93bicpIHtcbiAgICAvLyAgICAgICAgICAgICBpZiAoIW1lbnUuaXMoZXZlbnQudGFyZ2V0KSAmJiBtZW51LmhhcyhldmVudC50YXJnZXQpLmxlbmd0aCA9PT0gMCkge1xuICAgIC8vICAgICAgICAgICAgICAgICAkKFwiYm9keS5yZXNwb25zaXZlLW1lbnUgI2J0bi1tZW51XCIpLnRyaWdnZXIoJ2NsaWNrLmNsb3NlLXJlc3BvbnNpdmUtbWVudScpO1xuICAgIC8vICAgICAgICAgICAgIH1cbiAgICAvLyAgICAgICAgIH1cbiAgICAvLyAgICAgfVxuICAgIC8vIH0pO1xufSk7XG5cbiQoZG9jdW1lbnQpLm9uKCdtZWRpYTptZCBtZWRpYTpsZyBtZWRpYTp4bCcsIGZ1bmN0aW9uKGV2ZW50LCBtZWRpYSkge1xuICAgICQoXCJib2R5LnJlc3BvbnNpdmUtbWVudSAjYnRuLW1lbnVcIikudHJpZ2dlcignY2xpY2suY2xvc2UtcmVzcG9uc2l2ZS1tZW51Jyk7XG4gICAgJChcIiNidG4tbWVudVwiKS5vZmYoJ2NsaWNrLnJlc3BvbnNpdmUtbWVudScpO1xuICAgIC8vICQoXCIjYnRuLW1lbnVcIikub2ZmKCdjbGljay5jbG9zZS1yZXNwb25zaXZlLW1lbnUnKTtcbiAgICAvLyAkKCcjbWVudScpLmFkZENsYXNzKCdkLW5vbmUnKS5yZW1vdmVDbGFzcygnZC1mbGV4Jyk7XG4gICAgLy8gJCgnI2Rlc2t0b3AnKS5hZGRDbGFzcygnZC1ub25lJyk7XG4gICAgLy8gJCgnYm9keScpLnJlbW92ZUNsYXNzKCdyZXNwb25zaXZlLW1lbnUnKTtcbiAgICAvLyAkKCcjYnRuLW1lbnUnKS5maW5kKCQoXCIuZmFzXCIpKS5yZW1vdmVDbGFzcygnZmEtYXJyb3ctcmlnaHQnKS5hZGRDbGFzcygnZmEtYmFycycpO1xufSk7IiwiKGZ1bmN0aW9uICgpIHtcblx0ZnVuY3Rpb24gVml3RmlsZSgpXG5cdHtcblx0XHQkKCcuY3VzdG9tLWZpbGUtaW5wdXQnLCB0aGlzKS5vbignY2hhbmdlJywgZnVuY3Rpb24oKXtcblx0XHRcdGlmICghd2luZG93LkZpbGUgJiYgIXdpbmRvdy5GaWxlUmVhZGVyICYmICF3aW5kb3cuRmlsZUxpc3QgJiYgIXdpbmRvdy5CbG9iKSB7XG5cdFx0XHRcdGNvbnNvbGUuZXJyb3IoJ0ZpbGVSZWFkZXIgdW5zdXBwb3J0ZWQhJyk7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblx0XHRcdHZhciBmaWxlX2luZGV4ID0gMDtcblx0XHRcdHZhciBmaWxlO1xuXHRcdFx0JCh0aGlzKS5uZXh0KCkuaHRtbCgnJyk7XG5cdFx0XHR2YXIgZmlsZXMgPSBbXTtcblx0XHRcdHdoaWxlIChmaWxlID0gdGhpcy5maWxlcy5pdGVtKGZpbGVfaW5kZXgrKykpXG5cdFx0XHR7XG5cdFx0XHRcdGZpbGVzLnB1c2goZmlsZS5uYW1lKTtcblx0XHRcdH1cblx0XHRcdCQodGhpcykubmV4dCgpLmh0bWwoZmlsZXMuam9pbignIDogJykpO1xuXHRcdH0pO1xuXHR9XG5cdCQoZG9jdW1lbnQpLm9uKCdzdGF0aW86Z2xvYmFsOnJlbmRlclJlc3BvbnNlJywgZnVuY3Rpb24gKGV2ZW50LCBiYXNlLCBjb250ZXgpIHtcblx0XHRiYXNlLmVhY2goZnVuY3Rpb24gKCkge1xuXHRcdFx0Vml3RmlsZS5jYWxsKHRoaXMpO1xuXHRcdH0pO1xuXHR9KTtcblx0Vml3RmlsZS5jYWxsKGRvY3VtZW50KTtcbn0pKCk7Il19